!function(){"use strict";var s,o=Laya.View,d=Laya.Dialog,h=Laya.Scene,p=Laya.ClassUtils.regClass;!function(s){!function(s){class h extends Laya.Scene{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("game/Game")}}s.GameUI=h,p("ui.game.GameUI",h);class S extends o{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("game/GameInfo")}}s.GameInfoUI=S,p("ui.game.GameInfoUI",S);class E extends d{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("game/GameResult")}}s.GameResultUI=E,p("ui.game.GameResultUI",E)}(s.game||(s.game={}))}(s||(s={})),function(s){!function(s){class S extends h{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("model/Home")}}s.HomeUI=S,p("ui.model.HomeUI",S);class E extends o{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("model/Loading")}}s.LoadingUI=E,p("ui.model.LoadingUI",E);class A extends Laya.Dialog{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("model/MessageModal")}}s.MessageModalUI=A,p("ui.model.MessageModalUI",A);class b extends Laya.Dialog{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("model/nativeAdDialog")}}s.nativeAdDialogUI=b,p("ui.model.nativeAdDialogUI",b);class w extends Laya.Dialog{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("model/PopupWindow")}}s.PopupWindowUI=w,p("ui.model.PopupWindowUI",w);class I extends Laya.Scene{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("model/Show")}}s.ShowUI=I,p("ui.model.ShowUI",I);class _ extends o{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("model/Skin")}}s.SkinUI=_,p("ui.model.SkinUI",_);class L extends d{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("model/Treasure")}}s.TreasureUI=L,p("ui.model.TreasureUI",L);class T extends d{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("model/Unlock")}}s.UnlockUI=T,p("ui.model.UnlockUI",T)}(s.model||(s.model={}))}(s||(s={})),function(s){!function(s){!function(s){!function(s){class d extends o{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("sogame/prefab/common/adItem")}}s.adItemUI=d,p("ui.sogame.prefab.common.adItemUI",d);class h extends o{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("sogame/prefab/common/btnSound")}}s.btnSoundUI=h,p("ui.sogame.prefab.common.btnSoundUI",h)}(s.common||(s.common={}))}(s.prefab||(s.prefab={}))}(s.sogame||(s.sogame={}))}(s||(s={})),function(s){!function(s){class o extends Laya.View{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("unit/Money")}}s.MoneyUI=o,p("ui.unit.MoneyUI",o);class d extends Laya.View{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("unit/SkinItem")}}s.SkinItemUI=d,p("ui.unit.SkinItemUI",d);class h extends Laya.View{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("unit/TreasureItem")}}s.TreasureItemUI=h,p("ui.unit.TreasureItemUI",h)}(s.unit||(s.unit={}))}(s||(s={}));class S{constructor(){if(this._instance)throw"singleton class is not use new constructor"}static getInstance(){let s=this._instance;return s||(s=this._instance=new this),s}}const E=class extends S{constructor(){super(),this._eventDispatcher=new Laya.EventDispatcher}on(s,o,d,h){return this._eventDispatcher.on(s,o,d,h)}once(s,o,d,h){return this._eventDispatcher.once(s,o,d,h)}off(s,o,d,h){return this._eventDispatcher.off(s,o,d,h)}event(s,o){return this._eventDispatcher.event(s,o)}}.getInstance();var A,b,w,I;!function(s){s[s.IOS=0]="IOS",s[s.ANDROID=1]="ANDROID",s[s.DEVTOOLS=2]="DEVTOOLS",s[s.NONE=3]="NONE"}(A||(A={})),function(s){s.BtnShareMode="btnShareMode"}(b||(b={})),function(s){s.StartGame="startGame",s.UpdateMoney="updateMoney",s.UpdateProgress="updateProgress",s.GameOver="gameOver",s.CreateBannerBack="createBannerBack",s.Revive="revive",s.PushCamera="pushCamera",s.LoadSceneBack="loadSceneBack",s.CloseLoading="closeLoading",s.ChangeSkinTab="changeSkinTab",s.ChangeCapSkin="changeHatSkin",s.ChangeBallSkin="changeBallSkin",s.BumpIntoBall="bumpIntoBall",s.HitPlane="hitPlane",s.HitBall="hitBall",s.StopMove="stopMove",s.HitOverPlane="hitOverPlane",s.HitFinishRoad="hitFinishRoad"}(w||(w={})),function(s){s.Float="悬浮窗",s.Drawer_pic="抽屉",s.Inter_six="结算界面广告",s.Youlike_normal="猜你喜欢",s.Inter_full="全屏插屏",s.MiniProgram="仿小程序"}(I||(I={}));const _=class extends S{createBezierPoints(s,o){for(var d=[],h=0;h<o;h++){var p=this.multiPointBezier(s,h/o);d.push(p)}return d}multiPointBezier(s,o){let d=s.length,h=new Laya.Vector3(0,0,0);for(let p=0;p<d;p++){let S=s[p];h.x+=S.x*Math.pow(1-o,d-1-p)*Math.pow(o,p)*this.erxiangshi(d-1,p),h.y+=S.y*Math.pow(1-o,d-1-p)*Math.pow(o,p)*this.erxiangshi(d-1,p),h.z+=S.z*Math.pow(1-o,d-1-p)*Math.pow(o,p)*this.erxiangshi(d-1,p)}return h}erxiangshi(s,o){let d=1,h=1;for(;o>0;)d*=s,h*=o,s--,o--;return d/h}}.getInstance();class L extends Laya.Script3D{constructor(){super(),this._hasHit=!1}onEnable(){this._ball=this.owner;let s=this._ball.getComponent(Laya.Rigidbody3D);s.friction=.1,s.rollingFriction=.1,s.restitution=.1}onUpdate(){this._ball.transform.localPositionX=0,this._ball.transform.localRotationEulerY=this._ball.transform.localRotationEulerZ=0}onCollisionEnter(s){let o=s.other.owner;if("role"!=o.name||this._hasHit){if(o.name.indexOf("ball")>=0){let o=s.contacts[0].positionOnB,d=o.z-this._ball.transform.position.z,h=this._ball.parent.getChildByName("role");d<0&&h.transform.localPositionZ<=o.z&&(console.log("撞倒小球"),E.event(w.HitBall))}}else{E.event(w.StopMove),this._hasHit=!0;let d=s.contacts[0].positionOnB.z-this._ball.transform.position.z;if(Math.abs(d)<.8){console.log("碰到小人"),o.getComponent(Laya.Rigidbody3D).enabled=!1,E.event(w.BumpIntoBall,this._ball)}}}}class T extends Laya.Script3D{constructor(){super()}onCollisionEnter(s){"role"==s.other.owner.name&&E.event(w.HitPlane)}}const k=class extends S{isWx(){return!!window.wx}getSystemPlatform(){let s=wx.getSystemInfoSync(),o=A.NONE;return"ios"==s.platform?o=A.IOS:"android"==s.platform?o=A.ANDROID:"devtools"==s.platform&&(o=A.DEVTOOLS),A.NONE}isIphoneX(){if(!this.isWx())return!1;let s=wx.getSystemInfoSync();return!!(s&&-1!=s.model.indexOf("iPhone X")||-1!=s.model.indexOf("iPhone 11"))}initSDK(){this.isWx()&&(this.launchOption=wx.getLaunchOptionsSync(),wx.showShareMenu({withShareTicket:!0,success:()=>{},fail:()=>{},complete:()=>{}}),wx.onShow(s=>{this.launchOption.shareTicket=s.shareTicket,wx.offShow()}))}getLaunchOptionsSync(){return this.isWx()?this.launchOption:null}aldSendEvent(s,o,d,h=!1){if(this.isWx()){o||(o=""),d||(d="")}}aldStage(s,o){this.isWx()&&wx.aldStage&&(1==s?wx.aldStage.onStart({stageId:o+"",stageName:"第"+o+"关"}):2==s?wx.aldStage.onEnd({stageId:o+"",stageName:"第"+o+"关",event:"fail",params:{desc:"闯关失败"}}):wx.aldStage.onEnd({stageId:o+"",stageName:"第"+o+"关",event:"complete",params:{desc:"关卡完成"}}))}}.getInstance();const R=class extends S{constructor(){super(...arguments),this.canOpenRoad=!1,this.endPercent=0,this.gateGold=0,this.hasGameOver=!1,this.state=!1,this.gameDataArr=[],this.hasOpenSignIn=!1,this.testSkinId=1,this.testSkinTimes=0,this.gateId=1,this.rank=0,this.isFirstLogin=!0,this.openId="",this.configId=-1,this.reviveNum=0,this.isMusicOn=!0,this._shareBtnMode=0,this._isFirstShare=!0,this._lastShareState=!1}get shareBtnMode(){return this._shareBtnMode}set shareBtnMode(s){this._shareBtnMode=s%2}get isFirstShare(){return this._isFirstShare}set isFirstShare(s){this._isFirstShare=s}get lastShareState(){return this._lastShareState}set lastShareState(s){this._lastShareState=s}}.getInstance();var x={gameLevelStart(s){if(s)switch(Lq.pfName){case"stapp":Lq.stapp.callJsbMethod("gameLevelStart",{level:s})}},gameLevelEnd(s){if(s)switch(Lq.pfName){case"stapp":Lq.stapp.callJsbMethod("gameLevelEnd",{level:s})}},showPross(s,o,d){let h,p,S,E={bgColor:"#000000",subColor:"#f3b63f",width:.6*Laya.stage.width,height:34,zOrder:999,showNum:!1,numColor:"#ffffff",bottom:Laya.stage.height/3};o=Object.assign(E,o),h=new Laya.Box,h.name="customPross",h=new Laya.Box,h.setStyle,h.bgColor=o.bgColor,h.zOrder=o.zOrder,h.width=o.width,h.height=o.height,h.centerX=0,h.bottom=o.bottom,d||(d=Laya.stage),d.addChild(h),p=new Laya.Box,p.name="subPross",p.width=.01,p.x=0,p.y=0,p.height=h.height,p.bgColor=o.subColor,h.addChild(p),o.showNum&&(S=new Laya.Label,S.centerX=0,S.y=-56,S.fontSize=36,S.color="#ffffff",S.bold=!0,h.addChild(S)),Lq.onLoading(this,d=>{p.width=h.width*d/100,o.showNum&&(S.text=d+" %"),d<100||Laya.Tween.to(this,{alpha:.2},300,null,Laya.Handler.create(this,()=>{h.visible=!1,s&&s(),h.destroy()}))},{float:2,timerName:"prossTime"})},showTips(s,o=2e3){if(!s)return;let d,h,p=Lq.view.tipsNode;p?(p.visible=!0,p.y=Laya.stage.height/2,p.alpha=1,d=p.getChildByName("tipsLabel"),d.text=s,h=p.getChildByName("tipsBg"),p.width=h.width=Math.max(d.width+100,600),p.height=h.height=d.height+20):(p=new Laya.Box,p.zOrder=99999,h=new Laya.Box,h.bgColor="#404040",h.alpha=.8,h.centerY=0,h.name="tipsBg",p.addChild(h),d=new Laya.Label(s),d.name="tipsLabel",d.fontSize=40,d.color="#ffffff",d.stroke=5,d.strokeColor="#000000",d.centerX=0,d.centerY=0,d.wordWrap=!0,d.align=Laya.Stage.ALIGN_CENTER,d.valign=Laya.Stage.ALIGN_MIDDLE,d.width=Laya.stage.width,p.addChild(d),p.width=h.width=Laya.stage.width,p.height=h.height=d.height+20,p.centerX=h.centerX=0,p.y=Laya.stage.height/2,Lq.view.tipsNode=p,Laya.stage.addChild(p)),Laya.Tween.to(p,{y:p.y-100,alpha:.2},1e3,null,Laya.Handler.create(this,()=>{p.visible=!1}),o,!0)},getChildByPath(s,o=""){if(!s||0==s.numChildren)return null;if(!o)return s;let d=o.split("/"),h=s;do{let s=d.shift();if(h=h.getChildByName(s),!h)return null}while(0!=d.length);return h}};var G=new class{constructor(){this.bannerId="9a86c629e3e14ca7b8e20b257c650def",this.banner2Id="97e3bfea7abb41a9a52c40bb4c140b60",this.nativeId="dcc03d2467124950ae286841d52754a4",this.native2Id="7a6c27f54b0b47f4b40ded899d67646f",this.native3Id="8b54cc1b91eb4f9aa6a1315926f55fbe",this.insertId="c10018b99a334c7f83de03ebcb435758",this.videoId="d137857b28544a7784455980ec50c93d",this.appId="100007071",this.bannerAd=null,this.shortCutInstalled=!1,this.innerAudioContext=null,this.zs_version="1.0",this.local_version="1.2",this.zs_native_click_switch=0}createAd(){if(!window.qg)return;if(0==P.isOnline)return;this.bannerAd=window.qg.createBannerAd({posId:this.bannerId});let s=this.bannerAd.show(),o=this;s&&s.then(()=>{Laya.timer.loop(2e4,o,o.refreshBanner),console.log("banner广告展示成功")}).catch(s=>{switch(s.code){case 30003:console.log("新用户1天内不能曝光Banner，请将手机时间调整为1天后，退出游戏重新进入");break;case 30009:console.log("10秒内调用广告次数超过1次，10秒后再调用"),setTimeout(()=>{o.createAd()},11e3);break;case 30002:console.log("加载广告失败，重新加载广告"),setTimeout(()=>{o.createAd()},11e3);break;default:console.log("banner广告展示失败"),console.log(JSON.stringify(s))}})}refreshBanner(){console.log("刷新banner"),this.hideBanner(),this.bannerAd=window.qg.createBannerAd({posId:this.bannerId});let s=this.bannerAd.show(),o=this;s&&s.then(()=>{console.log("banner广告展示成功")}).catch(s=>{switch(Laya.timer.clearAll(o),s.code){case 30003:console.log("新用户1天内不能曝光Banner，请将手机时间调整为1天后，退出游戏重新进入");break;case 30009:console.log("10秒内调用广告次数超过1次，10秒后再调用"),setTimeout(()=>{o.createAd()},11e3);break;case 30002:console.log("加载广告失败，重新加载广告"),setTimeout(()=>{o.createAd()},11e3);break;default:console.log("banner广告展示失败"),console.log(JSON.stringify(s))}})}showBanner(){0!=P.isOnline&&(console.log("-----banner展示---"),window.qg&&this.createAd())}hideBanner(){if(0!=P.isOnline&&window.qg&&this.bannerAd){var s=this.bannerAd.hide();s&&s.then(()=>{console.log("banner广告隐藏成功")}).catch(s=>{console.log("banner广告隐藏失败",s)})}}createNativeAd(){if(0==P.isOnline)return;if(!Laya.Browser.window.qg)return;console.log("创建原生广告1"),this.nativeAd&&(this.nativeAd.offLoad(),this.nativeAd.offError(),this.nativeAd=null,this.nativieAdList=null);let s=this;this.nativeAd=Laya.Browser.window.qg.createNativeAd({posId:s.nativeId}),this.nativeAd.load(),this.nativeAd.onLoad((function(o){if(o&&o.adList){s.nativieAdList=o.adList.pop();let d=s.nativieAdList.imgUrlList[0];Laya.loader.load(d),console.log("原生插屏广告onload",JSON.stringify(s.nativieAdList))}}));let errorFun=function(o){setTimeout(()=>{s.createNativeAd()},1e4),console.log("原生插屏广告error:",JSON.stringify(o)),s.nativeAd.offError(errorFun)};this.nativeAd.onError(errorFun)}createNativeAd2(){if(0==P.isOnline)return;if(!Laya.Browser.window.qg)return;console.log("创建原生广告2"),this.nativeAd2&&(this.nativeAd2.offLoad(),this.nativeAd2.offError(),this.nativeAd2=null,this.nativieAdList2=null);let s=this;this.nativeAd2=Laya.Browser.window.qg.createNativeAd({posId:s.native2Id}),this.nativeAd2.load(),this.nativeAd2.onLoad((function(o){o&&o.adList&&(s.nativieAdList2=o.adList.pop(),console.log("原生插屏广告2onload",JSON.stringify(s.nativieAdList2)))}));let errorFun=function(o){setTimeout(()=>{s.createNativeAd2()},1e4),console.log("原生插屏广告2error:",JSON.stringify(o)),s.nativeAd2.offError(errorFun)};this.nativeAd2.onError(errorFun)}createNativeAd3(){if(0==P.isOnline)return;if(!Laya.Browser.window.qg)return;console.log("创建原生广告3"),this.nativeAd3&&(this.nativeAd3.offLoad(),this.nativeAd3.offError(),this.nativeAd3=null,this.nativieAdList3=null);let s=this;this.nativeAd3=Laya.Browser.window.qg.createNativeAd({posId:s.native3Id}),this.nativeAd3.load(),this.nativeAd3.onLoad((function(o){if(o&&o.adList){s.nativieAdList3=o.adList.pop();let d=s.nativieAdList3.imgUrlList[0];Laya.loader.load(d),console.log("原生插屏广告3onload",JSON.stringify(s.nativieAdList3))}}));let errorFun=function(o){setTimeout(()=>{s.createNativeAd3()},1e4),console.log("原生插屏广告3error:",JSON.stringify(o)),s.nativeAd3.offError(errorFun)};this.nativeAd3.onError(errorFun)}showInsertAd(){if(console.log("展示插屏"),!Laya.Browser.window.qg)return;let s=Laya.Browser.window.qg.createInterstitialAd({posId:this.insertId}).show();s&&s.then(()=>{console.log("插屏广告展示成功")}).catch(s=>{switch(s.code){case 30003:console.log("新用户1天内不能曝光Banner，请将手机时间调整为1天后，退出游戏重新进入");break;case 30009:console.log("10秒内调用广告次数超过1次，10秒后再调用");break;case 30002:console.log("load广告失败，重新加载广告");break;default:console.log("插屏广告展示失败"),console.log(JSON.stringify(s))}})}isShowInsertAd(){if(0==P.isOnline)return;let s=Laya.LocalStorage.getItem("interAdTimes");if(s){let o=parseInt(Laya.LocalStorage.getItem("interAdTime"));if(new Date(o).toDateString()==(new Date).toDateString()){if(parseInt(s)>P.interMax-1&&0!=P.interMax)return console.log("adTimes:",parseInt(s)),!1;{let d=(new Date).getTime()-o;if(d<1e3*P.adCd)return console.log("timeMinus:",d,1e3*P.adCd),!1;{let o=parseInt(s)+1;Laya.LocalStorage.setItem("interAdTimes",""+o);let d=(new Date).getTime();return Laya.LocalStorage.setItem("interAdTime",""+d),!0}}}{console.log("date:",new Date(o).toDateString(),(new Date).toDateString()),Laya.LocalStorage.setItem("interAdTimes","1");let s=(new Date).getTime();return Laya.LocalStorage.setItem("interAdTime",""+s),!0}}{Laya.LocalStorage.setItem("interAdTimes","1");let s=(new Date).getTime();return Laya.LocalStorage.setItem("interAdTime",""+s),!0}}reportMonitor(){if(window.qg){Laya.Browser.window.qg.getSystemInfoSync().platformVersionCode>=1060&&Laya.Browser.window.qg.reportMonitor("game_scene",0)}}showVideo(s,o){if(0==P.isOnline)return o&&o(),void x.showTips("当前没有广告");if(!window.qg)return void(s&&s());G.stopMusic();var d=Laya.Browser.window.qg.createRewardedVideoAd({posId:this.videoId});d.load().then(()=>{console.log("激励视频创建成功")}).catch(()=>{x.showTips("当前没有广告，请稍后再试"),console.log("激励视频创建失败"),G.playMusic(),o&&o()});let loadFun=function(){console.log("激励视频加载成功"),d.show(),d.offLoad(loadFun)};d.onLoad(loadFun);let closeFun=function(h){h.isEnded?(console.log("激励视频广告完成，发放奖励"),s&&s()):(console.log("激励视频广告取消关闭，不发放奖励"),o&&o()),G.playMusic(),d.offClose(closeFun)};d.onClose(closeFun)}showToast(s){window.qg&&Laya.Browser.window.qg.showToast({message:s})}hasShortCutInstalled(){if(window.qg){let s=this;Laya.Browser.window.qg.hasShortcutInstalled({success:function(o){o?(s.shortCutInstalled=!0,console.log("已创建")):console.log("未创建")}})}}playMusic(){R.isMusicOn&&Laya.Browser.window.qg&&(this.innerAudioContext=Laya.Browser.window.qg.createInnerAudioContext(),this.innerAudioContext.src="sound/bgm.mp3",this.innerAudioContext.loop=!0,this.innerAudioContext.volume=1,this.innerAudioContext.play())}stopMusic(){Laya.Browser.window.qg&&this.innerAudioContext.stop()}initZsSdk(){window.qg;let s=window.zs.sdk,o=this;s.loadCfg((function(s){o.zs_version=s.zs_version,o.zs_native_click_switch=s.zs_native_click_switch,console.log("cfgObject:",s.zs_native_click_switch,typeof s.zs_native_click_switch)}),(function(){}))}};const P=class extends S{constructor(){super(...arguments),this._version="1.0.6",this._gameId=252,this._auditState=1,this._btnShareMode=1,this.adErrorRate=.2,this.adErrorMaxCount=2,this.adDelay=.5,this.adCd=0,this.interMax=99999,this.isOnline=1}get auditState(){return this._auditState}get shareImageData(){return this._shareImageData}get btnShareMode(){return this._btnShareMode}sendPostRequest(){var s=`gameid=${this._gameId}&v=${this._version}`;let o=new Laya.HttpRequest;o.send("https://account.api.snsfun.com/XyxApi/shstatus",s,"post","text",["Content-Type","application/x-www-form-urlencoded"]),o.once(Laya.Event.COMPLETE,this,this.onPostComplete),o.once(Laya.Event.ERROR,this,this.onPostError)}onPostComplete(s){0!=+s&&1!=+s||(this._auditState=+s),console.log("shareType",s),this.getShareImage(),this.getShareBtnMode()}onPostError(s){console.log("shstatus post error : ",s)}getShareImage(){var s=`gameid=${this._gameId}&sh=${this._auditState}`;let o=new Laya.HttpRequest;o.send("https://account.api.snsfun.com/XyxApi/share",s,"post","text",["Content-Type","application/x-www-form-urlencoded"]),o.once(Laya.Event.COMPLETE,this,this.onGetImageComplete),o.once(Laya.Event.ERROR,this,this.onGetImageError)}onGetImageComplete(s){console.log("------分享图data",s),s&&s.length>1&&(this._shareImageData=JSON.parse(s),this.setShareApp())}onGetImageError(s){console.log("GetImageError post error : ",s)}getShareBtnMode(){var s="gameid="+this._gameId;let o=new Laya.HttpRequest;o.send("https://account.api.snsfun.com/XyxApi/custom",s,"post","text",["Content-Type","application/x-www-form-urlencoded"]),o.once(Laya.Event.COMPLETE,this,this.getShareBtnModeComplete),o.once(Laya.Event.ERROR,this,this.getShareBtnModeIOError)}getShareBtnModeComplete(s){if(0==this._auditState&&s&&s.length>1){let o=JSON.parse(s);console.log("parseData",o),this._btnShareMode=+o.btnShareMode}}getShareBtnModeIOError(s){console.log("post error : ",s)}setShareApp(){if(!k.isWx())return;let s,o=P.shareImageData;s=o instanceof Array?o[Math.floor(Math.random()*o.length)]:o,wx.onShareAppMessage(o=>({title:s.text,imageUrl:s.url}))}requireAdConfig(){let s=new Laya.HttpRequest,o=this;s.send("http://quduoduodata.top/Nativegame/Get?name=com.bqgs.vivominigame",null,"get","text",["Content-Type","application/x-www-form-urlencoded"]),s.once(Laya.Event.COMPLETE,this,(function(s){let d=JSON.parse(s);o.adErrorRate=Number(d.aderrorrate),o.adErrorMaxCount=parseInt(d.aderrormaxcount),o.adDelay=parseInt(d.addelay),o.adCd=parseInt(d.adcd),o.interMax=parseInt(d.intermax),o.isOnline=parseInt(d.isOnline),console.log("requireAdConfig success:",s)})),s.once(Laya.Event.ERROR,this,(function(){console.log("requireAdConfig error")}))}requireAdId(){let s=new Laya.HttpRequest;s.send("http://quduoduodata.top/Game/getad?type=h5&platform=vivo&packagename=com.bqgs.vivominigame",null,"get","text",["Content-Type","application/x-www-form-urlencoded"]),s.once(Laya.Event.COMPLETE,this,(function(s){let o=JSON.parse(s).adddata;G.bannerId=o.bannerid[0],G.insertId=o.interid[0],G.nativeId=o.nativeid[0],G.native2Id=o.nativeid[1],G.videoId=o.videoid[0],console.log("requireAdConfig success:",s)})),s.once(Laya.Event.ERROR,this,(function(){console.log("requireAdConfig error")}))}}.getInstance();let O=class extends S{constructor(){super(...arguments),this.isCreateError=!1,this.isCreateLoad=!1}init(s=!0){if(k.isWx())return this.destroy(),this.videoAd=wx.createRewardedVideoAd({adUnitId:"adunit-95aec0ca889549a6"}),this.videoAd.onError(s=>{this.isCreateError=!0,console.log("激励视频创建失败"),1001===s.errCode?console.log("参数错误"):1004===s.errCode&&console.log("无合适的广告")}),this.videoAd.load().then(()=>{this.isCreateLoad=!0,console.log("激励视频创建成功"),s?console.log("先预加载视频，需要的时候再show"):this.videoAd.show()}).catch(s=>console.log(s.errMsg,s.errCode)),this.videoAd}showVideo(){this.videoAd&&this.isCreateLoad&&this.videoAd.show()}destroy(){this.isCreateError=!1,this.isCreateLoad=!1,this.videoAd&&(this.videoAd.offError(),this.videoAd.offClose(),this.videoAd.offLoad()),this.videoAd=null}onClose(s,o,d){this.videoAd.offClose(),this.videoAd.onClose(h=>{h&&h.isEnded?s&&s():o&&o(),console.log("关闭激励视频"),d&&d(),this.videoAd.offError(),this.videoAd.offClose(),this.videoAd.offLoad(),this.destroy(),this.init()})}}.getInstance();class B extends S{constructor(){super()}}class N extends B{constructor(){super(),this._jsonMetadatePath="res/config/config.json",this._init_()}_init_(){this._dataSource=Laya.loader.getRes(this._jsonMetadatePath)}getMetadata(){return this._dataSource}getSystemConfig(){return this.getMetadata().systemConfig}getTreasures(){return this.getMetadata().treasures}getSignInRewards(){return this.getMetadata().signInRewards}getTreasureById(s){let o=this.getMetadata().treasures;for(let d=0;d<o.length;d++)if(s==o[d].id)return o[d];return null}getLastRoad(s){let o=this.getMetadata().roads;for(let d=o.length-1;d>=0;d--)if(s>=o[d].gate)return o[d];return null}getNextRoad(s){let o=this.getMetadata().roads;for(let d=0;d<o.length;d++)if(s<o[d].gate)return o[d];return null}getCaps(){return this.getMetadata().caps}getCapById(s){let o=this.getMetadata().caps;for(let d=0;d<o.length;d++)if(s==o[d].id)return o[d];return null}getBalls(){return this.getMetadata().balls}getBallById(s){let o=this.getMetadata().balls;for(let d=0;d<o.length;d++)if(s==o[d].id)return o[d];return null}getGates(){return this.getMetadata().gates}getGateById(s){let o=this.getMetadata().gates;for(let d=0;d<o.length;d++)if(s==o[d].id)return o[d];return null}}var D={"游戏名称":{cn:{value:"蹦球高手",style:null},en:{value:"Ball To Ball",style:null},id:{value:"Lompat Bola",style:null},hi:{value:"बॉल टु बॉल",style:null},vi:{value:"Cao Thủ Nảy Bóng",style:null},"pt-br":{value:"Bola a Bola",style:null},th:{value:"บอลทูบอล",style:null}},"广告加载失败":{cn:{value:"请您稍后再试",style:null},en:{value:"Please try again later",style:null},id:{value:"Coba lagi nanti",style:null},hi:{value:"कृपया बाद में दुबारा प्रयास करें",style:null},vi:{value:"Hãy thử lại sau",style:null},"pt-br":{value:"Tente de novo mais tarde",style:null},th:{value:"กรุณาลองอีกครั้งภายหลัง",style:null}},"广告跳过":{cn:{value:"完整观看广告后您才能获得奖励",style:null},en:{value:"You can get rewards \n after watching the full ad",style:null},id:{value:"Tonton video hingga selesai untuk mendapatkan hadiah!",style:null},hi:{value:"पुरस्कार पाने के लिए पूरा वीडियो देखें!",style:null},vi:{value:"Xem hết video để nhận thưởng!",style:null},"pt-br":{value:"Assista ao vídeo até o fim para receber recompensas.",style:null},th:{value:"ดูวิดีโอให้จบเพื่อรับรางวัล!",style:null}},"谢谢":{cn:{value:"不了，谢谢",style:null},en:{value:"No, thanks",style:null},id:{value:"",style:null},hi:{value:"",style:null},vi:{value:"",style:null},"pt-br":{value:"",style:null},th:{value:"",style:null}},"下一关":{cn:{value:"下一关",style:null},en:{value:"Next level",style:null},id:{value:"Tingkat berikutnya",style:null},hi:{value:"अगला स्तर",style:null},vi:{value:"Mức kế",style:null},"pt-br":{value:"Seguinte nível",style:null},th:{value:"ระดับถัดไป",style:null}},"第几关":{cn:{value:"第$level$关",style:null},en:{value:"Level $level$",style:null},id:{value:"",style:null},hi:{value:"",style:null},vi:{value:"",style:null},"pt-br":{value:"",style:null},th:{value:"",style:null}},"金币不足":{cn:{value:"金币不足",style:null},en:{value:"No enough coins",style:null},id:{value:"Tidak cukup koin",style:null},hi:{value:"पर्याप्त सिक्के नहीं",style:null},vi:{value:"Thiếu xu",style:null},"pt-br":{value:"Moedas insuficientes",style:null},th:{value:"เหรียญไม่พอ",style:null}},"提示":{cn:{value:"提示",style:null},en:{value:"Hint",style:null},id:{value:"Petunjuk",style:null},hi:{value:"संकेत",style:null},vi:{value:"Gợi ý",style:null},"pt-br":{value:"Dica",style:null},th:{value:"คำใบ้",style:null}},"确认":{cn:{value:"确认",style:null},en:{value:"OK",style:null},id:{value:"Oke",style:null},hi:{value:"ठीक",style:null},vi:{value:"Đồng ý",style:null},"pt-br":{value:"Confirmar",style:null},th:{value:"ตกลง",style:null}},"看视频":{cn:{value:"看视频",style:null},en:{value:"Watch video",style:null},id:{value:"Tonton video",style:null},hi:{value:"वीडियो देखें",style:null},vi:{value:"Xem video",style:null},"pt-br":{value:"Assistir a vídeos",style:null},th:{value:"ดูวิดีโอ",style:null}},"加金币":{cn:{value:"金币 +$num$",style:null},en:{value:"Coins +$num$",style:null},id:{value:"Koin +$num$",style:null},hi:{value:"सिक्के +$num$",style:null},vi:{value:"Xu +$num$",style:null},"pt-br":{value:"Moedas +$num$",style:null},th:{value:"เหรียญ +$num$",style:null}},"加钻石":{cn:{value:"钻石 +$num$",style:null},en:{value:"Diamonds +$num$",style:null},id:{value:"Berlian +$num$",style:null},hi:{value:"हीरे +$num$",style:null},vi:{value:"Kim cương +$num$",style:null},"pt-br":{value:"Diamantes +$gnum$",style:null},th:{value:"เพชร +$num$",style:null}},"暂未开放":{cn:{value:"暂未开放",style:null},en:{value:"Not available",style:null},id:{value:"Tidak tersedia",style:null},hi:{value:"उपलब्‍ध नहीं",style:null},vi:{value:"Không có sẵn",style:null},"pt-br":{value:"Não disponível",style:null},th:{value:"ไม่พร้อมใช้งาน",style:null}},"皮肤全解锁":{cn:{value:"本页皮肤已全部解锁",style:null},en:{value:"All skins are unlocked on this page",style:null},id:{value:"Semua skin sudah dibuka di halaman ini",style:null},hi:{value:"इस पेज के सभी स्किन अनलॉक हो चुके हैं",style:null},vi:{value:"Tất cả skin trên trang này đã được mở khóa",style:null},"pt-br":{value:"Todas as skins estão desbloqueadas nesta página",style:null},th:{value:"สกินทั้งหมดจะ\nปลดล็อกในหน้านี้",style:null}},"双倍奖励":{cn:{value:"恭喜获得双倍奖励",style:null},en:{value:"Congrats! You got double rewards",style:null},id:{value:"Selamat! Kamu mendapat hadiah ganda",style:null},hi:{value:"बधाई हो! आपको दुगुना पुरस्कार मिला है",style:null},vi:{value:"Chúc mừng! Bạn đã nhận thưởng gấp đôi",style:null},"pt-br":{value:"Parabéns! Você recebeu recompensas em dobro.",style:null},th:{value:"ยินดีด้วย! คุณได้รางวัลสองเท่า",style:null}},"额外奖励":{cn:{value:"恭喜额外奖励",style:null},en:{value:"You got extra reward",style:null},id:{value:"Kamu mendapat hadiah tambahan",style:null},hi:{value:"आपको अतिरिक्त पुरस्कार मिला है",style:null},vi:{value:"Bạn đã nhận thưởng thêm",style:null},"pt-br":{value:"Você recebeu uma recompensa extra",style:null},th:{value:"คุณได้รางวัลพิเศษ",style:null}},"取消":{cn:{value:"取消",style:null},en:{value:"No",style:null},id:{value:"Tidak",style:null},hi:{value:"नहीं",style:null},vi:{value:"Không",style:null},"pt-br":{value:"Não",style:null},th:{value:"ไม่มี",style:null}},"解锁地形提示":{cn:{value:"再玩 $num$ 关解锁新地形",style:null},en:{value:"Play $num$ more levels to\n unlock new track",style:null},id:{value:"Mainkan $num$ level lagi\n untuk membuka trek baru",style:null},hi:{value:"$num$ लेवल और खेलकर\n नया ट्रैक अनलॉक करें",style:null},vi:{value:"Chơi thêm $num$ màn để \nmở khóa đường mới",style:null},"pt-br":{value:"Jogue mais $num$ níveis \npara desbloquear uma nova pista",style:null},th:{value:"เล่นอีก $num$ \nเลเวลเพื่อปลดล็อกลู่ใหม่",style:null}},"免费宝箱":{cn:{value:"还有免费宝箱未领取，是否放弃领取返回首页？",style:null},en:{value:"You have free chest to be claimed.Still give up and go back to homepage?",style:null},id:{value:"Kamu punya peti gratis yang belum diklaim.  Masih ingin menyerah dan kembali ke beranda?",style:null},hi:{value:"दावा करने के लिए आपके पास मुफ़्त संदूक हैं। फिर भी आप छोड़कर होमपेज पर जाना चाहते हैं?",style:null},vi:{value:"Bạn có rương miễn phí để nhận. Vẫn bỏ và quay lại trang chủ?",style:null},"pt-br":{value:"Você tem um baú grátis para ser reivindicado. Mesmo assim deseja desistir e voltar para a página inicial?",style:null},th:{value:"คุณมีหีบที่ยังไม่ได้รับ ยังอยากจะยอมแพ้แล้วกลับไปที่โฮมเพจไหม?",style:null}},"看视频加抽奖":{cn:{value:"观看视频可额外再抽$num$次",style:null},en:{value:"Watch video to try lucky draw $num$ more times",style:null},id:{value:"Tonton video untuk mencoba undian berhadiah $num$ kali lagi",style:null},hi:{value:"वीडियो देखकर $num$ बार और \nलकी ड्रॉ आजमाएं",style:null},vi:{value:"Xem video để thử rút thăm may mắn thêm $num$ lần",style:null},"pt-br":{value:"Assista ao vídeo para tentar sortear mais $num$ vezes",style:null},th:{value:"ดูวิดีโอเพื่อลองจับสลากเสี่ยงโชคอีก $num$ ครั้ง",style:null}},"加载中":{cn:{value:"加载中",style:null},en:{value:"Loading",style:null},id:{value:"Memuat",style:null},hi:{value:"लोड हो रहा है",style:null},vi:{value:"Đang tải",style:null},"pt-br":{value:"Carregando",style:null},th:{value:"เกำลังโหลด",style:null}},"广告加载中":{cn:{value:"广告加载中",style:null},en:{value:"Advertising loading",style:null},id:{value:"Memuatkan iklan",style:null},hi:{value:"सावधानिक लोड किया जा रहा है",style:null},vi:{value:"Đăng quảng cáo",style:null},"pt-br":{value:"Carregamento publicitário",style:null},th:{value:"โหลดโฆษณา",style:null}},"加载激励成功回调":{cn:{value:"加载激励视频成功\n$num$秒后发起成功回调",style:null},en:{value:"Loaded rewarded success\nCallback was initiated in $num$ seconds",style:null}},"加载插屏成功回调":{cn:{value:"加载插屏视频成功\n$num$秒后发起成功回调",style:null},en:{value:"Loaded insert screen success\nCallback was initiated in $num$ seconds",style:null}}};const M={init:()=>{},getSumByList:s=>{if(!Array.isArray(s)||0==s.length)return 0;let o=0;return s.forEach(s=>{o+=Number(s)}),o},getRandByWeightList:(s,o)=>{if(!Array.isArray(s)||0==s.length)return[];let d=s.length;o=o>d?d:o;let h=[];s.forEach(s=>{h.push(Math.abs(Number(s))+1)});let p=M.getSumByList(h),S=[],E={};for(;o;){let s=Math.floor(Math.random()*p),A=0,b=0;for(;A<d&&(b+=h[A],!(b>=s));A++);E[A]||(E[A]=1,h[A]=0,p=M.getSumByList(h),S.push(A),o--)}return S},getObjVal(s,o,d,h=!1){s=s||{};let p=o.split(".")||[];if(!Array.isArray(p)||0==p.length)return s;let S=s,E=null;return p.forEach((s,o)=>{o+1==p.length?(void 0===S[s]&&(S[s]=d||""),E=S[s]=h?d:S[s]):(S[s]=S[s]||{},S=S[s])}),E}};(()=>{let defineProperty=function(s,o,d){s.prototype.hasOwnProperty(o)||Object.defineProperty(s.prototype,o,{value:d,writable:!0,enumerable:!1,configurable:!0})};defineProperty(Number,"integer",(function(){return Math[this<0?"ceil":"floor"](this)})),defineProperty(String,"trim",(function(){return this.replace(/^\s+|\s+$/g,"")})),defineProperty(Array,"unique",(function(){for(var s,o=[],d={},h=0;null!=(s=this[h]);h++)d[s]||(o.push(s),d[s]=!0);return o})),defineProperty(Array,"shuffle",(function(){let s=this,o=s.length,d=0;for(;o;)d=Math.floor(Math.random()*o--),[s[o],s[d]]=[s[d],s[o]];return s})),defineProperty(Array,"rand",(function(s,o=!0){let d=this.length;if(0==d)return[];let h=[];switch(!0){case s<d/2:let p={};for(;s;){let o=Math.floor(Math.random()*d);p[o]||(p[o]=1,h.push(this[o]),s--)}break;case s<=d:let S=Object.assign([],this);S.shuffle(),h=S.slice(0,s);break;default:if(o){let o=[];for(;s;)0==o.length&&(o=Object.assign([],this),o.shuffle()),h.push(o.shift()),s--;h.shuffle()}else for(;s;){let o=Math.floor(Math.random()*d);h.push(this[o]),s--}}return h})),defineProperty(Array,"repeat",(function(s){let o=Object.assign([],this);if(s<=1)return o;for(;s>1;)o=o.concat(this),s--;return o})),defineProperty(Array,"inArray",(function(s){return this.indexOf(s)>-1})),defineProperty(String,"repeat",(function(s){if(null==this)throw new TypeError("can't convert "+this+" to object");var o=""+this;if((s=+s)!=s&&(s=0),s<0)throw new RangeError("repeat count must be non-negative");if(s==1/0)throw new RangeError("repeat count must be less than infinity");if(s=Math.floor(s),0==o.length||0==s)return"";if(o.length*s>=1<<28)throw new RangeError("repeat count must not overflow maximum string size");for(var d="";1==(1&s)&&(d+=o),0!=(s>>>=1);)o+=o;return d})),defineProperty(String,"padStart",(function(s,o){return s>>=0,o=String(void 0!==o?o:" "),this.length>s||""===o?String(this):((s-=this.length)>o.length&&(o+=o.repeat(s/o.length)),o.slice(0,s)+String(this))})),defineProperty(String,"padEnd",(function(s,o){return s>>=0,o=String(void 0!==o?o:" "),this.length>s||""===o?String(this):((s-=this.length)>o.length&&(o+=o.repeat(s/o.length)),String(this)+o.slice(0,s))})),defineProperty(String,"interpolate",(function(s){const o=Object.keys(s),d=Object.values(s);return new Function(...o,`return \`${this}\`;`)(...d)}))})();var U={common:{adItem:{x:0,type:"View",selectedBox:2,selecteID:20,searchKey:"View,adItem",props:{width:200,sceneColor:"#000000",name:"adItem",height:226},nodeParent:-1,maxID:21,label:"adItem",isOpen:!0,isDirectory:!0,isAniNode:!0,hasChild:!0,compId:2,child:[{x:15,type:"Image",searchKey:"Image,bg",props:{width:200,skin:"sogame/ad_item_bg.png",sizeGrid:"20,20,20,20",name:"bg",height:226,centerY:0,centerX:0},nodeParent:2,label:"bg",isDirectory:!1,isAniNode:!0,hasChild:!1,compId:3,child:[]},{x:15,type:"Image",searchKey:"Image,game_icon,icon",props:{y:7,width:186,var:"icon",skin:"",name:"game_icon",height:186,centerX:0},nodeParent:2,label:"game_icon",isDirectory:!1,isAniNode:!0,hasChild:!1,compId:16,child:[]},{x:15,type:"Label",searchKey:"Label,game_title,title",props:{y:196,width:120,var:"title",valign:"middle",text:"游戏游戏游戏游戏游戏游戏",overflow:"hidden",name:"game_title",left:7,height:26,fontSize:20,font:"SimSun",bold:!0,align:"left"},nodeParent:2,label:"game_title",isOpen:!0,isDirectory:!1,isAniNode:!0,hasChild:!1,compId:17,child:[]},{x:15,type:"Box",searchKey:"Box,btn_play,btnPlay",props:{y:196,width:56,var:"btnPlay",right:7,name:"btn_play",height:20,bottom:6,bgColor:"#ffad0c"},nodeParent:2,label:"btn_play",isOpen:!1,isDirectory:!0,isAniNode:!0,hasChild:!0,compId:18,child:[{type:"Label",searchKey:"Label,btn_play_label",props:{width:56,valign:"middle",text:"PLAY",name:"btn_play_label",height:20,fontSize:16,color:"#ffffff",centerY:1,centerX:0,align:"center"},nodeParent:18,label:"btn_play_label",isDirectory:!1,isAniNode:!0,hasChild:!1,compId:19,child:[]}]},{x:15,type:"Image",searchKey:"Image,btn_close,btnClose",props:{y:-13,x:176,width:40,var:"btnClose",skin:"sogame/btn_close.png",name:"btn_close",height:40},nodeParent:2,label:"btn_close",isDirectory:!1,isAniNode:!0,hasChild:!1,compId:20,child:[]}],animations:[{nodes:[],name:"ani1",id:1,frameRate:24,action:0}]},btnSound:{x:0,type:"View",selectedBox:2,selecteID:6,searchKey:"View",props:{width:50,sceneColor:"#000000",height:54},nodeParent:-1,maxID:7,label:"View",isOpen:!0,isDirectory:!0,isAniNode:!0,hasChild:!0,compId:2,child:[{x:15,type:"Image",searchKey:"Image,bg",props:{skin:"sogame/btn_sound_bg.png",name:"bg",label:"label"},nodeParent:2,label:"bg",isDirectory:!1,isAniNode:!0,hasChild:!1,compId:4,child:[]},{x:15,type:"Image",searchKey:"Image,soundOn",props:{width:37,var:"soundOn",skin:"sogame/icon_sound_on_2.png",height:34,centerY:0,centerX:0},nodeParent:2,label:"soundOn",isDirectory:!1,isAniNode:!0,hasChild:!1,compId:6,child:[],$HIDDEN:!1},{x:15,type:"Image",searchKey:"Image,soundOff",props:{width:37,visible:!1,var:"soundOff",skin:"sogame/icon_sound_off_2.png",height:34,centerY:0,centerX:0},nodeParent:2,label:"soundOff",isDirectory:!1,isAniNode:!0,hasChild:!1,compId:5,child:[],$HIDDEN:!0}],animations:[{nodes:[],name:"ani1",id:1,frameRate:24,action:0}]}}};let V=Laya.SoundManager;var H=new class{constructor(){this._bgId=null,this._audioStatus=!0,this._muted=!1,this._shakeStatus=!0,this._soundExt=null,this._lastBgUrl=null,this._bgStatus="",V.useAudioMusic=!0,V.autoReleaseSound=!1}get audioStatus(){return this._audioStatus}set audioStatus(s){this._audioStatus=s,this.muted=!s}get muted(){return this._muted}set muted(s){if(s||this._audioStatus)switch(this._muted=s,Lq.pfName){case"cy":V.muted=s;break;default:let o=s?0:1;V.setMusicVolume(o),V.setSoundVolume(o)}}get shakeStatus(){return this._shakeStatus}set shakeStatus(s){this._shakeStatus=s}get soundExt(){if(null!==this._soundExt)return this._soundExt;let s=".mp3";return window.conch&&(s=".wav"),this._soundExt=s,s}init(s){}playMusic(s="play",o,d=0,h){switch(h=h||function(){},s){case"play":if(!this._audioStatus||this._muted||!o)return;if(o=this.formatUrl(o),this._lastBgUrl===o&&this._bgId)switch(this._bgStatus){case"play":return this._bgId;case"pause":return this._bgId.resume(),this._bgStatus="play",this._bgId}return this._lastBgUrl=o,o+=this.soundExt,this._bgId=V.playMusic(o,d,new Laya.Handler(this,h)),this._bgStatus="play",this._bgId;case"pause":if(!this._bgId||this._bgId.isStopped)return;setTimeout(()=>{this._bgId.pause(),this._bgStatus="pause"},10);break;case"resume":if(!this._audioStatus||!this._bgId)return;setTimeout(()=>{this._bgId.resume(),this._bgStatus="play"},10);break;case"stop":if(!this._bgId)return;setTimeout(()=>{this._bgId.stop(),this._lastBgUrl=null,this._bgStatus="stop"},10)}}playSound(s,o=1,d){this._audioStatus&&!this._muted&&s&&(s=this.formatUrl(s),s+=this.soundExt,d=d||function(){},V.playSound(s,o,new Laya.Handler(this,d)))}shake(){}formatUrl(s){return s.lastIndexOf(".")>-1&&(s=s.substring(0,s.lastIndexOf("."))),s}};let K,F={};!function(s){var o,d,h=h||function(s){function t(){}var o={},d=o.lib={},h=d.Base={extend:function(s){t.prototype=this;var o=new t;return s&&o.mixIn(s),o.hasOwnProperty("init")||(o.init=function(){o.$super.init.apply(this,arguments)}),(o.init.prototype=o).$super=this,o},create:function(){var s=this.extend();return s.init.apply(s,arguments),s},init:function(){},mixIn:function(s){for(var o in s)s.hasOwnProperty(o)&&(this[o]=s[o]);s.hasOwnProperty("toString")&&(this.toString=s.toString)},clone:function(){return this.init.prototype.extend(this)}},p=d.WordArray=h.extend({init:function(s,o){s=this.words=s||[],this.sigBytes=null!=o?o:4*s.length},toString:function(s){return(s||E).stringify(this)},concat:function(s){var o=this.words,d=s.words,h=this.sigBytes;if(s=s.sigBytes,this.clamp(),h%4)for(var p=0;p<s;p++)o[h+p>>>2]|=(d[p>>>2]>>>24-p%4*8&255)<<24-(h+p)%4*8;else if(65535<d.length)for(p=0;p<s;p+=4)o[h+p>>>2]=d[p>>>2];else o.push.apply(o,d);return this.sigBytes+=s,this},clamp:function(){var o=this.words,d=this.sigBytes;o[d>>>2]&=4294967295<<32-d%4*8,o.length=s.ceil(d/4)},clone:function(){var s=h.clone.call(this);return s.words=this.words.slice(0),s},random:function(o){for(var d=[],h=0;h<o;h+=4)d.push(4294967296*s.random()|0);return new p.init(d,o)}}),S=o.enc={},E=S.Hex={stringify:function(s){var o=s.words;s=s.sigBytes;for(var d=[],h=0;h<s;h++){var p=o[h>>>2]>>>24-h%4*8&255;d.push((p>>>4).toString(16)),d.push((15&p).toString(16))}return d.join("")},parse:function(s){for(var o=s.length,d=[],h=0;h<o;h+=2)d[h>>>3]|=parseInt(s.substr(h,2),16)<<24-h%8*4;return new p.init(d,o/2)}},A=S.Latin1={stringify:function(s){var o=s.words;s=s.sigBytes;for(var d=[],h=0;h<s;h++)d.push(String.fromCharCode(o[h>>>2]>>>24-h%4*8&255));return d.join("")},parse:function(s){for(var o=s.length,d=[],h=0;h<o;h++)d[h>>>2]|=(255&s.charCodeAt(h))<<24-h%4*8;return new p.init(d,o)}},b=S.Utf8={stringify:function(s){try{return decodeURIComponent(escape(A.stringify(s)))}catch(s){throw Error("Malformed UTF-8 data")}},parse:function(s){return A.parse(unescape(encodeURIComponent(s)))}},w=d.BufferedBlockAlgorithm=h.extend({reset:function(){this._data=new p.init,this._nDataBytes=0},_append:function(s){"string"==typeof s&&(s=b.parse(s)),this._data.concat(s),this._nDataBytes+=s.sigBytes},_process:function(o){var d=this._data,h=d.words,S=d.sigBytes,E=this.blockSize,A=S/(4*E);if(o=(A=o?s.ceil(A):s.max((0|A)-this._minBufferSize,0))*E,S=s.min(4*o,S),o){for(var b=0;b<o;b+=E)this._doProcessBlock(h,b);b=h.splice(0,o),d.sigBytes-=S}return new p.init(b,S)},clone:function(){var s=h.clone.call(this);return s._data=this._data.clone(),s},_minBufferSize:0});d.Hasher=w.extend({cfg:h.extend(),init:function(s){this.cfg=this.cfg.extend(s),this.reset()},reset:function(){w.reset.call(this),this._doReset()},update:function(s){return this._append(s),this._process(),this},finalize:function(s){return s&&this._append(s),this._doFinalize()},blockSize:16,_createHelper:function(s){return function(o,d){return new s.init(d).finalize(o)}},_createHmacHelper:function(s){return function(o,d){return new I.HMAC.init(s,d).finalize(o)}}});var I=o.algo={};return o}(Math);!function(s){function e(s){return 4294967296*(s-(0|s))|0}for(var o=h,d=(S=o.lib).WordArray,p=S.Hasher,S=o.algo,E=[],A=[],b=2,w=0;w<64;){var I;e:{I=b;for(var _=s.sqrt(I),L=2;L<=_;L++)if(!(I%L)){I=!1;break e}I=!0}I&&(w<8&&(E[w]=e(s.pow(b,.5))),A[w]=e(s.pow(b,1/3)),w++),b++}var T=[];S=S.SHA256=p.extend({_doReset:function(){this._hash=new d.init(E.slice(0))},_doProcessBlock:function(s,o){for(var d=this._hash.words,h=d[0],p=d[1],S=d[2],E=d[3],b=d[4],w=d[5],I=d[6],_=d[7],L=0;L<64;L++){if(L<16)T[L]=0|s[o+L];else{var k=T[L-15],R=T[L-2];T[L]=((k<<25|k>>>7)^(k<<14|k>>>18)^k>>>3)+T[L-7]+((R<<15|R>>>17)^(R<<13|R>>>19)^R>>>10)+T[L-16]}k=_+((b<<26|b>>>6)^(b<<21|b>>>11)^(b<<7|b>>>25))+(b&w^~b&I)+A[L]+T[L],R=((h<<30|h>>>2)^(h<<19|h>>>13)^(h<<10|h>>>22))+(h&p^h&S^p&S),_=I,I=w,w=b,b=E+k|0,E=S,S=p,p=h,h=k+R|0}d[0]=d[0]+h|0,d[1]=d[1]+p|0,d[2]=d[2]+S|0,d[3]=d[3]+E|0,d[4]=d[4]+b|0,d[5]=d[5]+w|0,d[6]=d[6]+I|0,d[7]=d[7]+_|0},_doFinalize:function(){var o=this._data,d=o.words,h=8*this._nDataBytes,p=8*o.sigBytes;return d[p>>>5]|=128<<24-p%32,d[14+(64+p>>>9<<4)]=s.floor(h/4294967296),d[15+(64+p>>>9<<4)]=h,o.sigBytes=4*d.length,this._process(),this._hash},clone:function(){var s=p.clone.call(this);return s._hash=this._hash.clone(),s}}),o.SHA256=p._createHelper(S),o.HmacSHA256=p._createHmacHelper(S)}(Math),d=h.enc.Utf8,h.algo.HMAC=h.lib.Base.extend({init:function(s,o){s=this._hasher=new s.init,"string"==typeof o&&(o=d.parse(o));var h=s.blockSize,p=4*h;o.sigBytes>p&&(o=s.finalize(o)),o.clamp();for(var S=this._oKey=o.clone(),E=this._iKey=o.clone(),A=S.words,b=E.words,w=0;w<h;w++)A[w]^=1549556828,b[w]^=909522486;S.sigBytes=E.sigBytes=p,this.reset()},reset:function(){var s=this._hasher;s.reset(),s.update(this._iKey)},update:function(s){return this._hasher.update(s),this},finalize:function(s){var o=this._hasher;return s=o.finalize(s),o.reset(),o.finalize(this._oKey.clone().concat(s))}}),o=h.lib.WordArray,h.enc.Base64={stringify:function(s){var o=s.words,d=s.sigBytes,h=this._map;s.clamp(),s=[];for(var p=0;p<d;p+=3)for(var S=(o[p>>>2]>>>24-p%4*8&255)<<16|(o[p+1>>>2]>>>24-(p+1)%4*8&255)<<8|o[p+2>>>2]>>>24-(p+2)%4*8&255,E=0;E<4&&p+.75*E<d;E++)s.push(h.charAt(S>>>6*(3-E)&63));if(o=h.charAt(64))for(;s.length%4;)s.push(o);return s.join("")},parse:function(s){var d=s.length,h=this._map;!(p=h.charAt(64))||-1!=(p=s.indexOf(p))&&(d=p);for(var p=[],S=0,E=0;E<d;E++)if(E%4){var A=h.indexOf(s.charAt(E-1))<<E%4*2,b=h.indexOf(s.charAt(E))>>>6-E%4*2;p[S>>>2]|=(A|b)<<24-S%4*8,S++}return o.create(p,S)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},function(s){var o,d,h,p,S,E,A,b,w,I,_,L,T;(o=s.EGAErrorSeverity||(s.EGAErrorSeverity={}))[o.Undefined=0]="Undefined",o[o.Debug=1]="Debug",o[o.Info=2]="Info",o[o.Warning=3]="Warning",o[o.Error=4]="Error",o[o.Critical=5]="Critical",(d=s.EGAProgressionStatus||(s.EGAProgressionStatus={}))[d.Undefined=0]="Undefined",d[d.Start=1]="Start",d[d.Complete=2]="Complete",d[d.Fail=3]="Fail",(h=s.EGAResourceFlowType||(s.EGAResourceFlowType={}))[h.Undefined=0]="Undefined",h[h.Source=1]="Source",h[h.Sink=2]="Sink",(p=s.EGAAdAction||(s.EGAAdAction={}))[p.Undefined=0]="Undefined",p[p.Clicked=1]="Clicked",p[p.Show=2]="Show",p[p.FailedShow=3]="FailedShow",p[p.RewardReceived=4]="RewardReceived",(S=s.EGAAdError||(s.EGAAdError={}))[S.Undefined=0]="Undefined",S[S.Unknown=1]="Unknown",S[S.Offline=2]="Offline",S[S.NoFill=3]="NoFill",S[S.InternalError=4]="InternalError",S[S.InvalidRequest=5]="InvalidRequest",S[S.UnableToPrecache=6]="UnableToPrecache",(E=s.EGAAdType||(s.EGAAdType={}))[E.Undefined=0]="Undefined",E[E.Video=1]="Video",E[E.RewardedVideo=2]="RewardedVideo",E[E.Playable=3]="Playable",E[E.Interstitial=4]="Interstitial",E[E.OfferWall=5]="OfferWall",E[E.Banner=6]="Banner",(b=(A=s.http||(s.http={})).EGAHTTPApiResponse||(A.EGAHTTPApiResponse={}))[b.NoResponse=0]="NoResponse",b[b.BadResponse=1]="BadResponse",b[b.RequestTimeout=2]="RequestTimeout",b[b.JsonEncodeFailed=3]="JsonEncodeFailed",b[b.JsonDecodeFailed=4]="JsonDecodeFailed",b[b.InternalServerError=5]="InternalServerError",b[b.BadRequest=6]="BadRequest",b[b.Unauthorized=7]="Unauthorized",b[b.UnknownResponseCode=8]="UnknownResponseCode",b[b.Ok=9]="Ok",b[b.Created=10]="Created",(I=(w=s.events||(s.events={})).EGASdkErrorCategory||(w.EGASdkErrorCategory={}))[I.Undefined=0]="Undefined",I[I.EventValidation=1]="EventValidation",I[I.Database=2]="Database",I[I.Init=3]="Init",I[I.Http=4]="Http",I[I.Json=5]="Json",(_=w.EGASdkErrorArea||(w.EGASdkErrorArea={}))[_.Undefined=0]="Undefined",_[_.BusinessEvent=1]="BusinessEvent",_[_.ResourceEvent=2]="ResourceEvent",_[_.ProgressionEvent=3]="ProgressionEvent",_[_.DesignEvent=4]="DesignEvent",_[_.ErrorEvent=5]="ErrorEvent",_[_.InitHttp=9]="InitHttp",_[_.EventsHttp=10]="EventsHttp",_[_.ProcessEvents=11]="ProcessEvents",_[_.AddEventsToStore=12]="AddEventsToStore",_[_.AdEvent=20]="AdEvent",(L=w.EGASdkErrorAction||(w.EGASdkErrorAction={}))[L.Undefined=0]="Undefined",L[L.InvalidCurrency=1]="InvalidCurrency",L[L.InvalidShortString=2]="InvalidShortString",L[L.InvalidEventPartLength=3]="InvalidEventPartLength",L[L.InvalidEventPartCharacters=4]="InvalidEventPartCharacters",L[L.InvalidStore=5]="InvalidStore",L[L.InvalidFlowType=6]="InvalidFlowType",L[L.StringEmptyOrNull=7]="StringEmptyOrNull",L[L.NotFoundInAvailableCurrencies=8]="NotFoundInAvailableCurrencies",L[L.InvalidAmount=9]="InvalidAmount",L[L.NotFoundInAvailableItemTypes=10]="NotFoundInAvailableItemTypes",L[L.WrongProgressionOrder=11]="WrongProgressionOrder",L[L.InvalidEventIdLength=12]="InvalidEventIdLength",L[L.InvalidEventIdCharacters=13]="InvalidEventIdCharacters",L[L.InvalidProgressionStatus=15]="InvalidProgressionStatus",L[L.InvalidSeverity=16]="InvalidSeverity",L[L.InvalidLongString=17]="InvalidLongString",L[L.DatabaseTooLarge=18]="DatabaseTooLarge",L[L.DatabaseOpenOrCreate=19]="DatabaseOpenOrCreate",L[L.JsonError=25]="JsonError",L[L.FailHttpJsonDecode=29]="FailHttpJsonDecode",L[L.FailHttpJsonEncode=30]="FailHttpJsonEncode",L[L.InvalidAdAction=31]="InvalidAdAction",L[L.InvalidAdType=32]="InvalidAdType",L[L.InvalidString=33]="InvalidString",(T=w.EGASdkErrorParameter||(w.EGASdkErrorParameter={}))[T.Undefined=0]="Undefined",T[T.Currency=1]="Currency",T[T.CartType=2]="CartType",T[T.ItemType=3]="ItemType",T[T.ItemId=4]="ItemId",T[T.Store=5]="Store",T[T.FlowType=6]="FlowType",T[T.Amount=7]="Amount",T[T.Progression01=8]="Progression01",T[T.Progression02=9]="Progression02",T[T.Progression03=10]="Progression03",T[T.EventId=11]="EventId",T[T.ProgressionStatus=12]="ProgressionStatus",T[T.Severity=13]="Severity",T[T.Message=14]="Message",T[T.AdAction=15]="AdAction",T[T.AdType=16]="AdType",T[T.AdSdkName=17]="AdSdkName",T[T.AdPlacement=18]="AdPlacement"}(p=p||{});var p,S,E,A;p.EGAErrorSeverity,p.EGAProgressionStatus,p.EGAResourceFlowType;(function(s){var o,d;(d=o=o||{})[d.Error=0]="Error",d[d.Warning=1]="Warning",d[d.Info=2]="Info",d[d.Debug=3]="Debug";var h=(r.setInfoLog=function(s){r.instance.infoLogEnabled=s},r.setVerboseLog=function(s){r.instance.infoLogVerboseEnabled=s},r.i=function(s){if(r.instance.infoLogEnabled){var d="Info/"+r.Tag+": "+s;r.instance.sendNotificationMessage(d,o.Info)}},r.w=function(s){var d="Warning/"+r.Tag+": "+s;r.instance.sendNotificationMessage(d,o.Warning)},r.e=function(s){var d="Error/"+r.Tag+": "+s;r.instance.sendNotificationMessage(d,o.Error)},r.ii=function(s){if(r.instance.infoLogVerboseEnabled){var d="Verbose/"+r.Tag+": "+s;r.instance.sendNotificationMessage(d,o.Info)}},r.d=function(s){if(r.debugEnabled){var d="Debug/"+r.Tag+": "+s;r.instance.sendNotificationMessage(d,o.Debug)}},r.prototype.sendNotificationMessage=function(s,d){switch(d){case o.Error:console.error(s);break;case o.Warning:console.warn(s);break;case o.Debug:"function"==typeof console.debug?console.debug(s):console.log(s);break;case o.Info:console.log(s)}},r.instance=new r,r.Tag="GameAnalytics",r);function r(){r.debugEnabled=!1}s.GALogger=h})((A=p=p||{}).logging||(A.logging={})),function(s){var o,d,p;function c(){}o=s.utilities||(s.utilities={}),d=s.logging.GALogger,c.getHmac=function(s,o){var d=h.HmacSHA256(o,s);return h.enc.Base64.stringify(d)},c.stringMatch=function(s,o){return!(!s||!o)&&o.test(s)},c.joinStringArray=function(s,o){for(var d="",h=0,p=s.length;h<p;h++)0<h&&(d+=o),d+=s[h];return d},c.stringArrayContainsString=function(s,o){if(0===s.length)return!1;for(var d in s)if(s[d]===o)return!0;return!1},c.encode64=function(s){s=encodeURI(s);for(var o,d,h,p,S,E="",A=0,b=0,w=0;h=(o=s.charCodeAt(w++))>>2,p=(3&o)<<4|(d=s.charCodeAt(w++))>>4,S=(15&d)<<2|(A=s.charCodeAt(w++))>>6,b=63&A,isNaN(d)?S=b=64:isNaN(A)&&(b=64),E=E+c.keyStr.charAt(h)+c.keyStr.charAt(p)+c.keyStr.charAt(S)+c.keyStr.charAt(b),o=d=A=0,h=p=S=b=0,w<s.length;);return E},c.decode64=function(s){var o,h,p,S,E="",A=0,b=0,w=0;for(/[^A-Za-z0-9\+\/\=]/g.exec(s)&&d.w("There were invalid base64 characters in the input text. Valid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='. Expect errors in decoding."),s=s.replace(/[^A-Za-z0-9\+\/\=]/g,"");o=c.keyStr.indexOf(s.charAt(w++))<<2|(p=c.keyStr.indexOf(s.charAt(w++)))>>4,h=(15&p)<<4|(S=c.keyStr.indexOf(s.charAt(w++)))>>2,A=(3&S)<<6|(b=c.keyStr.indexOf(s.charAt(w++))),E+=String.fromCharCode(o),64!=S&&(E+=String.fromCharCode(h)),64!=b&&(E+=String.fromCharCode(A)),o=h=A=0,p=S=b=0,w<s.length;);return decodeURI(E)},c.timeIntervalSince1970=function(){var s=new Date;return Math.round(s.getTime()/1e3)},c.createGuid=function(){return(c.s4()+c.s4()+"-"+c.s4()+"-4"+c.s4().substr(0,3)+"-"+c.s4()+"-"+c.s4()+c.s4()+c.s4()).toLowerCase()},c.s4=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},c.keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",p=c,o.GAUtilities=p}(p=p||{}),function(s){var o=E.logging.GALogger,d=E.utilities.GAUtilities,h=E.events.EGASdkErrorCategory,p=E.events.EGASdkErrorArea,S=E.events.EGASdkErrorAction,A=E.events.EGASdkErrorParameter,g=function(s,o,d,h,p){this.category=s,this.area=o,this.action=d,this.parameter=h,this.reason=p};s.ValidationResult=g;var b=(f.validateBusinessEvent=function(s,d,E,b,w){return f.validateCurrency(s)?d<0?(o.w("Validation fail - business event - amount. Cannot be less than 0. Failed amount: "+d),new g(h.EventValidation,p.BusinessEvent,S.InvalidAmount,A.Amount,d+"")):f.validateShortString(E,!0)?f.validateEventPartLength(b,!1)?f.validateEventPartCharacters(b)?f.validateEventPartLength(w,!1)?f.validateEventPartCharacters(w)?null:(o.w("Validation fail - business event - itemId: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+w),new g(h.EventValidation,p.BusinessEvent,S.InvalidEventPartCharacters,A.ItemId,w)):(o.w("Validation fail - business event - itemId. Cannot be (null), empty or above 64 characters. String: "+w),new g(h.EventValidation,p.BusinessEvent,S.InvalidEventPartLength,A.ItemId,w)):(o.w("Validation fail - business event - itemType: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+b),new g(h.EventValidation,p.BusinessEvent,S.InvalidEventPartCharacters,A.ItemType,b)):(o.w("Validation fail - business event - itemType: Cannot be (null), empty or above 64 characters. String: "+b),new g(h.EventValidation,p.BusinessEvent,S.InvalidEventPartLength,A.ItemType,b)):(o.w("Validation fail - business event - cartType. Cannot be above 32 length. String: "+E),new g(h.EventValidation,p.BusinessEvent,S.InvalidShortString,A.CartType,E)):(o.w("Validation fail - business event - currency: Cannot be (null) and need to be A-Z, 3 characters and in the standard at openexchangerates.org. Failed currency: "+s),new g(h.EventValidation,p.BusinessEvent,S.InvalidCurrency,A.Currency,s))},f.validateResourceEvent=function(s,b,w,I,_,L,T){return s==E.EGAResourceFlowType.Undefined?(o.w("Validation fail - resource event - flowType: Invalid flow type."),new g(h.EventValidation,p.ResourceEvent,S.InvalidFlowType,A.FlowType,"")):b?d.stringArrayContainsString(L,b)?0<w?I?f.validateEventPartLength(I,!1)?f.validateEventPartCharacters(I)?d.stringArrayContainsString(T,I)?f.validateEventPartLength(_,!1)?f.validateEventPartCharacters(_)?null:(o.w("Validation fail - resource event - itemId: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+_),new g(h.EventValidation,p.ResourceEvent,S.InvalidEventPartCharacters,A.ItemId,_)):(o.w("Validation fail - resource event - itemId: Cannot be (null), empty or above 64 characters. String: "+_),new g(h.EventValidation,p.ResourceEvent,S.InvalidEventPartLength,A.ItemId,_)):(o.w("Validation fail - resource event - itemType: Not found in list of pre-defined available resource itemTypes. String: "+I),new g(h.EventValidation,p.ResourceEvent,S.NotFoundInAvailableItemTypes,A.ItemType,I)):(o.w("Validation fail - resource event - itemType: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+I),new g(h.EventValidation,p.ResourceEvent,S.InvalidEventPartCharacters,A.ItemType,I)):(o.w("Validation fail - resource event - itemType: Cannot be (null), empty or above 64 characters. String: "+I),new g(h.EventValidation,p.ResourceEvent,S.InvalidEventPartLength,A.ItemType,I)):(o.w("Validation fail - resource event - itemType: Cannot be (null)"),new g(h.EventValidation,p.ResourceEvent,S.StringEmptyOrNull,A.ItemType,"")):(o.w("Validation fail - resource event - amount: Float amount cannot be 0 or negative. Value: "+w),new g(h.EventValidation,p.ResourceEvent,S.InvalidAmount,A.Amount,w+"")):(o.w("Validation fail - resource event - currency: Not found in list of pre-defined available resource currencies. String: "+b),new g(h.EventValidation,p.ResourceEvent,S.NotFoundInAvailableCurrencies,A.Currency,b)):(o.w("Validation fail - resource event - currency: Cannot be (null)"),new g(h.EventValidation,p.ResourceEvent,S.StringEmptyOrNull,A.Currency,""))},f.validateProgressionEvent=function(s,d,b,w){if(s==E.EGAProgressionStatus.Undefined)return o.w("Validation fail - progression event: Invalid progression status."),new g(h.EventValidation,p.ProgressionEvent,S.InvalidProgressionStatus,A.ProgressionStatus,"");if(w&&!b&&d)return o.w("Validation fail - progression event: 03 found but 01+02 are invalid. Progression must be set as either 01, 01+02 or 01+02+03."),new g(h.EventValidation,p.ProgressionEvent,S.WrongProgressionOrder,A.Undefined,d+":"+b+":"+w);if(b&&!d)return o.w("Validation fail - progression event: 02 found but not 01. Progression must be set as either 01, 01+02 or 01+02+03"),new g(h.EventValidation,p.ProgressionEvent,S.WrongProgressionOrder,A.Undefined,d+":"+b+":"+w);if(!d)return o.w("Validation fail - progression event: progression01 not valid. Progressions must be set as either 01, 01+02 or 01+02+03"),new g(h.EventValidation,p.ProgressionEvent,S.WrongProgressionOrder,A.Undefined,(d||"")+":"+(b||"")+":"+(w||""));if(!f.validateEventPartLength(d,!1))return o.w("Validation fail - progression event - progression01: Cannot be (null), empty or above 64 characters. String: "+d),new g(h.EventValidation,p.ProgressionEvent,S.InvalidEventPartLength,A.Progression01,d);if(!f.validateEventPartCharacters(d))return o.w("Validation fail - progression event - progression01: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+d),new g(h.EventValidation,p.ProgressionEvent,S.InvalidEventPartCharacters,A.Progression01,d);if(b){if(!f.validateEventPartLength(b,!0))return o.w("Validation fail - progression event - progression02: Cannot be empty or above 64 characters. String: "+b),new g(h.EventValidation,p.ProgressionEvent,S.InvalidEventPartLength,A.Progression02,b);if(!f.validateEventPartCharacters(b))return o.w("Validation fail - progression event - progression02: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+b),new g(h.EventValidation,p.ProgressionEvent,S.InvalidEventPartCharacters,A.Progression02,b)}if(w){if(!f.validateEventPartLength(w,!0))return o.w("Validation fail - progression event - progression03: Cannot be empty or above 64 characters. String: "+w),new g(h.EventValidation,p.ProgressionEvent,S.InvalidEventPartLength,A.Progression03,w);if(!f.validateEventPartCharacters(w))return o.w("Validation fail - progression event - progression03: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+w),new g(h.EventValidation,p.ProgressionEvent,S.InvalidEventPartCharacters,A.Progression03,w)}return null},f.validateDesignEvent=function(s){return f.validateEventIdLength(s)?f.validateEventIdCharacters(s)?null:(o.w("Validation fail - design event - eventId: Non valid characters. Only allowed A-z, 0-9, -_., ()!?. String: "+s),new g(h.EventValidation,p.DesignEvent,S.InvalidEventIdCharacters,A.EventId,s)):(o.w("Validation fail - design event - eventId: Cannot be (null) or empty. Only 5 event parts allowed seperated by :. Each part need to be 32 characters or less. String: "+s),new g(h.EventValidation,p.DesignEvent,S.InvalidEventIdLength,A.EventId,s))},f.validateErrorEvent=function(s,d){return s==E.EGAErrorSeverity.Undefined?(o.w("Validation fail - error event - severity: Severity was unsupported value."),new g(h.EventValidation,p.ErrorEvent,S.InvalidSeverity,A.Severity,"")):f.validateLongString(d,!0)?null:(o.w("Validation fail - error event - message: Message cannot be above 8192 characters."),new g(h.EventValidation,p.ErrorEvent,S.InvalidLongString,A.Message,d))},f.validateAdEvent=function(s,d,b,w){return s==E.EGAAdAction.Undefined?(o.w("Validation fail - error event - severity: Severity was unsupported value."),new g(h.EventValidation,p.AdEvent,S.InvalidAdAction,A.AdAction,"")):d==E.EGAAdType.Undefined?(o.w("Validation fail - ad event - adType: Ad type was unsupported value."),new g(h.EventValidation,p.AdEvent,S.InvalidAdType,A.AdType,"")):f.validateShortString(b,!1)?f.validateString(w,!1)?null:(o.w("Validation fail - ad event - message: Ad placement cannot be above 64 characters."),new g(h.EventValidation,p.AdEvent,S.InvalidString,A.AdPlacement,w)):(o.w("Validation fail - ad event - message: Ad SDK name cannot be above 32 characters."),new g(h.EventValidation,p.AdEvent,S.InvalidShortString,A.AdSdkName,b))},f.validateSdkErrorEvent=function(s,d,E,A,b){return!(!f.validateKeys(s,d)||(E===h.Undefined?(o.w("Validation fail - sdk error event - type: Category was unsupported value."),1):A===p.Undefined?(o.w("Validation fail - sdk error event - type: Area was unsupported value."),1):b===S.Undefined&&(o.w("Validation fail - sdk error event - type: Action was unsupported value."),1)))},f.validateKeys=function(s,o){return!(!d.stringMatch(s,/^[A-z0-9]{32}$/)||!d.stringMatch(o,/^[A-z0-9]{40}$/))},f.validateCurrency=function(s){return!!s&&!!d.stringMatch(s,/^[A-Z]{3}$/)},f.validateEventPartLength=function(s,o){return!(!o||s)||!!s&&!(64<s.length)},f.validateEventPartCharacters=function(s){return!!d.stringMatch(s,/^[A-Za-z0-9\s\-_\.\(\)\!\?]{1,64}$/)},f.validateEventIdLength=function(s){return!!s&&!!d.stringMatch(s,/^[^:]{1,64}(?::[^:]{1,64}){0,4}$/)},f.validateEventIdCharacters=function(s){return!!s&&!!d.stringMatch(s,/^[A-Za-z0-9\s\-_\.\(\)\!\?]{1,64}(:[A-Za-z0-9\s\-_\.\(\)\!\?]{1,64}){0,4}$/)},f.validateAndCleanInitRequestResponse=function(s,d){if(null==s)return o.w("validateInitRequestResponse failed - no response dictionary."),null;var h={};try{var p=s.server_ts;if(!(0<p))return o.w("validateInitRequestResponse failed - invalid value in 'server_ts' field."),null;h.server_ts=p}catch(d){return o.w("validateInitRequestResponse failed - invalid type in 'server_ts' field. type="+typeof s.server_ts+", value="+s.server_ts+", "+d),null}if(d){try{var S=s.configs;h.configs=S}catch(d){return o.w("validateInitRequestResponse failed - invalid type in 'configs' field. type="+typeof s.configs+", value="+s.configs+", "+d),null}try{var E=s.configs_hash;h.configs_hash=E}catch(d){return o.w("validateInitRequestResponse failed - invalid type in 'configs_hash' field. type="+typeof s.configs_hash+", value="+s.configs_hash+", "+d),null}try{var A=s.ab_id;h.ab_id=A}catch(d){return o.w("validateInitRequestResponse failed - invalid type in 'ab_id' field. type="+typeof s.ab_id+", value="+s.ab_id+", "+d),null}try{var b=s.ab_variant_id;h.ab_variant_id=b}catch(d){return o.w("validateInitRequestResponse failed - invalid type in 'ab_variant_id' field. type="+typeof s.ab_variant_id+", value="+s.ab_variant_id+", "+d),null}}return h},f.validateBuild=function(s){return!!f.validateShortString(s,!1)},f.validateSdkWrapperVersion=function(s){return!!d.stringMatch(s,/^(unity|unreal|gamemaker|cocos2d|construct|defold) [0-9]{0,5}(\.[0-9]{0,5}){0,2}$/)},f.validateEngineVersion=function(s){return!(!s||!d.stringMatch(s,/^(unity|unreal|gamemaker|cocos2d|construct|defold) [0-9]{0,5}(\.[0-9]{0,5}){0,2}$/))},f.validateUserId=function(s){return!!f.validateString(s,!1)||(o.w("Validation fail - user id: id cannot be (null), empty or above 64 characters."),!1)},f.validateShortString=function(s,o){return!(!o||s)||!(!s||32<s.length)},f.validateString=function(s,o){return!(!o||s)||!(!s||64<s.length)},f.validateLongString=function(s,o){return!(!o||s)||!(!s||8192<s.length)},f.validateConnectionType=function(s){return d.stringMatch(s,/^(wwan|wifi|lan|offline)$/)},f.validateCustomDimensions=function(s){return f.validateArrayOfStrings(20,32,!1,"custom dimensions",s)},f.validateResourceCurrencies=function(s){if(!f.validateArrayOfStrings(20,64,!1,"resource currencies",s))return!1;for(var h=0;h<s.length;++h)if(!d.stringMatch(s[h],/^[A-Za-z]+$/))return o.w("resource currencies validation failed: a resource currency can only be A-Z, a-z. String was: "+s[h]),!1;return!0},f.validateResourceItemTypes=function(s){if(!f.validateArrayOfStrings(20,32,!1,"resource item types",s))return!1;for(var d=0;d<s.length;++d)if(!f.validateEventPartCharacters(s[d]))return o.w("resource item types validation failed: a resource item type cannot contain other characters than A-z, 0-9, -_., ()!?. String was: "+s[d]),!1;return!0},f.validateDimension01=function(s,o){return!s||!!d.stringArrayContainsString(o,s)},f.validateDimension02=function(s,o){return!s||!!d.stringArrayContainsString(o,s)},f.validateDimension03=function(s,o){return!s||!!d.stringArrayContainsString(o,s)},f.validateArrayOfStrings=function(s,d,h,p,S){var E=p;if(E=E||"Array",!S)return o.w(E+" validation failed: array cannot be null. "),!1;if(0==h&&0==S.length)return o.w(E+" validation failed: array cannot be empty. "),!1;if(0<s&&S.length>s)return o.w(E+" validation failed: array cannot exceed "+s+" values. It has "+S.length+" values."),!1;for(var A=0;A<S.length;++A){var b=S[A]?S[A].length:0;if(0===b)return o.w(E+" validation failed: contained an empty string. Array="+JSON.stringify(S)),!1;if(0<d&&d<b)return o.w(E+" validation failed: a string exceeded max allowed length (which is: "+d+"). String was: "+S[A]),!1}return!0},f.validateClientTs=function(s){return!(s<-4294967294||4294967294<s)},f);function f(){}s.GAValidator=b}((E=p=p||{}).validators||(E.validators={})),function(s){!function(s){var n=function(s,o,d){this.name=s,this.value=o,this.version=d};s.NameValueVersion=n;var c=function(s,o){this.name=s,this.version=o};s.NameVersion=c;var o=(r.touch=function(){},r.getRelevantSdkVersion=function(){return r.sdkGameEngineVersion?r.sdkGameEngineVersion:r.sdkWrapperVersion},r.getConnectionType=function(){return r.connectionType},r.updateConnectionType=function(){navigator.onLine?r.connectionType="ios"===r.buildPlatform||"android"===r.buildPlatform?"wwan":"lan":r.connectionType="offline"},r.getOSVersionString=function(){return r.buildPlatform+" "+r.osVersionPair.version},r.runtimePlatformToString=function(){return r.osVersionPair.name},r.getBrowserVersionString=function(){var s,o=navigator.userAgent,d=o.match(/(opera|chrome|safari|firefox|ubrowser|msie|trident|fbav(?=\/))\/?\s*(\d+)/i)||[];if(0==d.length&&"ios"===r.buildPlatform)return"webkit_"+r.osVersion;if(/trident/i.test(d[1]))return"IE "+((s=/\brv[ :]+(\d+)/g.exec(o)||[])[1]||"");if("Chrome"===d[1]&&null!=(s=o.match(/\b(OPR|Edge|UBrowser)\/(\d+)/)))return s.slice(1).join(" ").replace("OPR","Opera").replace("UBrowser","UC").toLowerCase();if(d[1]&&"fbav"===d[1].toLowerCase()&&(d[1]="facebook",d[2]))return"facebook "+d[2];var h=d[2]?[d[1],d[2]]:[navigator.appName,navigator.appVersion,"-?"];return null!=(s=o.match(/version\/(\d+)/i))&&h.splice(1,1,s[1]),h.join(" ").toLowerCase()},r.getDeviceModel=function(){return"unknown"},r.getDeviceManufacturer=function(){return"unknown"},r.matchItem=function(s,o){var d,h,p,S,E=new c("unknown","0.0.0"),A=0,b=0;for(A=0;A<o.length;A+=1)if(new RegExp(o[A].value,"i").test(s)){if(d=new RegExp(o[A].version+"[- /:;]([\\d._]+)","i"),S="",(h=s.match(d))&&h[1]&&(p=h[1]),p){var w=p.split(/[._]+/);for(b=0;b<Math.min(w.length,3);b+=1)S+=w[b]+(b<Math.min(w.length,3)-1?".":"")}else S="0.0.0";return E.name=o[A].name,E.version=S,E}return E},r.sdkWrapperVersion="javascript 4.1.2",r.osVersionPair=r.matchItem([navigator.platform,navigator.userAgent,navigator.appVersion,navigator.vendor].join(" "),[new n("windows_phone","Windows Phone","OS"),new n("windows","Win","NT"),new n("ios","iPhone","OS"),new n("ios","iPad","OS"),new n("ios","iPod","OS"),new n("android","Android","Android"),new n("blackBerry","BlackBerry","/"),new n("mac_osx","Mac","OS X"),new n("tizen","Tizen","Tizen"),new n("linux","Linux","rv"),new n("kai_os","KAIOS","KAIOS")]),r.buildPlatform=r.runtimePlatformToString(),r.deviceModel=r.getDeviceModel(),r.deviceManufacturer=r.getDeviceManufacturer(),r.osVersion=r.getOSVersionString(),r.browserVersion=r.getBrowserVersionString(),r);function r(){}s.GADevice=o}(s.device||(s.device={}))}(p=p||{}),function(s){var o,d;function i(s){this.deadline=s,this.ignore=!1,this.async=!1,this.running=!1,this.id=++i.idCounter}o=s.threading||(s.threading={}),i.idCounter=0,d=i,o.TimedBlock=d}(p=p||{}),function(s){var o,d;function i(s){this.comparer=s,this._subQueues={},this._sortedKeys=[]}o=s.threading||(s.threading={}),i.prototype.enqueue=function(s,o){-1===this._sortedKeys.indexOf(s)&&this.addQueueOfPriority(s),this._subQueues[s].push(o)},i.prototype.addQueueOfPriority=function(s){var o=this;this._sortedKeys.push(s),this._sortedKeys.sort((function(s,d){return o.comparer.compare(s,d)})),this._subQueues[s]=[]},i.prototype.peek=function(){if(this.hasItems())return this._subQueues[this._sortedKeys[0]][0];throw new Error("The queue is empty")},i.prototype.hasItems=function(){return 0<this._sortedKeys.length},i.prototype.dequeue=function(){if(this.hasItems())return this.dequeueFromHighPriorityQueue();throw new Error("The queue is empty")},i.prototype.dequeueFromHighPriorityQueue=function(){var s=this._sortedKeys[0],o=this._subQueues[s].shift();return 0===this._subQueues[s].length&&(this._sortedKeys.shift(),delete this._subQueues[s]),o},d=i,o.PriorityQueue=d}(p=p||{}),function(s){var o,d,h,p,E=S.logging.GALogger;(d=o=s.EGAStoreArgsOperator||(s.EGAStoreArgsOperator={}))[d.Equal=0]="Equal",d[d.LessOrEqual=1]="LessOrEqual",d[d.NotEqual=2]="NotEqual",(p=h=s.EGAStore||(s.EGAStore={}))[p.Events=0]="Events",p[p.Sessions=1]="Sessions",p[p.Progression=2]="Progression";var A=(v.isStorageAvailable=function(){return v.storageAvailable},v.isStoreTooLargeForEvents=function(){return v.instance.eventsStore.length+v.instance.sessionsStore.length>v.MaxNumberOfEntries},v.select=function(s,d,h,p){void 0===d&&(d=[]),void 0===h&&(h=!1),void 0===p&&(p=0);var S=v.getStore(s);if(!S)return null;for(var E=[],A=0;A<S.length;++A){for(var b=S[A],w=!0,I=0;I<d.length;++I){var _=d[I];if(b[_[0]])switch(_[1]){case o.Equal:w=b[_[0]]==_[2];break;case o.LessOrEqual:w=b[_[0]]<=_[2];break;case o.NotEqual:w=b[_[0]]!=_[2];break;default:w=!1}else w=!1;if(!w)break}w&&E.push(b)}return h&&E.sort((function(s,o){return s.client_ts-o.client_ts})),0<p&&E.length>p&&(E=E.slice(0,p+1)),E},v.update=function(s,d,h){void 0===h&&(h=[]);var p=v.getStore(s);if(!p)return!1;for(var S=0;S<p.length;++S){for(var E=p[S],A=!0,b=0;b<h.length;++b){var w=h[b];if(E[w[0]])switch(w[1]){case o.Equal:A=E[w[0]]==w[2];break;case o.LessOrEqual:A=E[w[0]]<=w[2];break;case o.NotEqual:A=E[w[0]]!=w[2];break;default:A=!1}else A=!1;if(!A)break}if(A)for(b=0;b<d.length;++b){var I=d[b];E[I[0]]=I[1]}}return!0},v.delete=function(s,d){var h=v.getStore(s);if(h)for(var p=0;p<h.length;++p){for(var S=h[p],E=!0,A=0;A<d.length;++A){var b=d[A];if(S[b[0]])switch(b[1]){case o.Equal:E=S[b[0]]==b[2];break;case o.LessOrEqual:E=S[b[0]]<=b[2];break;case o.NotEqual:E=S[b[0]]!=b[2];break;default:E=!1}else E=!1;if(!E)break}E&&(h.splice(p,1),--p)}},v.insert=function(s,o,d,h){void 0===d&&(d=!1),void 0===h&&(h=null);var p=v.getStore(s);if(p)if(d){if(!h)return;for(var S=!1,E=0;E<p.length;++E){var A=p[E];if(A[h]==o[h]){for(var b in o)A[b]=o[b];S=!0;break}}S||p.push(o)}else p.push(o)},v.save=function(s){v.isStorageAvailable()?(localStorage.setItem(v.StringFormat(v.KeyFormat,s,v.EventsStoreKey),JSON.stringify(v.instance.eventsStore)),localStorage.setItem(v.StringFormat(v.KeyFormat,s,v.SessionsStoreKey),JSON.stringify(v.instance.sessionsStore)),localStorage.setItem(v.StringFormat(v.KeyFormat,s,v.ProgressionStoreKey),JSON.stringify(v.instance.progressionStore)),localStorage.setItem(v.StringFormat(v.KeyFormat,s,v.ItemsStoreKey),JSON.stringify(v.instance.storeItems))):E.w("Storage is not available, cannot save.")},v.load=function(s){if(v.isStorageAvailable()){try{v.instance.eventsStore=JSON.parse(localStorage.getItem(v.StringFormat(v.KeyFormat,s,v.EventsStoreKey))),v.instance.eventsStore||(v.instance.eventsStore=[])}catch(s){E.w("Load failed for 'events' store. Using empty store."),v.instance.eventsStore=[]}try{v.instance.sessionsStore=JSON.parse(localStorage.getItem(v.StringFormat(v.KeyFormat,s,v.SessionsStoreKey))),v.instance.sessionsStore||(v.instance.sessionsStore=[])}catch(s){E.w("Load failed for 'sessions' store. Using empty store."),v.instance.sessionsStore=[]}try{v.instance.progressionStore=JSON.parse(localStorage.getItem(v.StringFormat(v.KeyFormat,s,v.ProgressionStoreKey))),v.instance.progressionStore||(v.instance.progressionStore=[])}catch(s){E.w("Load failed for 'progression' store. Using empty store."),v.instance.progressionStore=[]}try{v.instance.storeItems=JSON.parse(localStorage.getItem(v.StringFormat(v.KeyFormat,s,v.ItemsStoreKey))),v.instance.storeItems||(v.instance.storeItems={})}catch(s){E.w("Load failed for 'items' store. Using empty store."),v.instance.progressionStore=[]}}else E.w("Storage is not available, cannot load.")},v.setItem=function(s,o,d){var h=v.StringFormat(v.KeyFormat,s,o);d?v.instance.storeItems[h]=d:h in v.instance.storeItems&&delete v.instance.storeItems[h]},v.getItem=function(s,o){var d=v.StringFormat(v.KeyFormat,s,o);return d in v.instance.storeItems?v.instance.storeItems[d]:null},v.getStore=function(s){switch(s){case h.Events:return v.instance.eventsStore;case h.Sessions:return v.instance.sessionsStore;case h.Progression:return v.instance.progressionStore;default:return E.w("GAStore.getStore(): Cannot find store: "+s),null}},v.instance=new v,v.MaxNumberOfEntries=2e3,v.StringFormat=function(s){for(var o=[],d=1;d<arguments.length;d++)o[d-1]=arguments[d];return s.replace(/{(\d+)}/g,(function(s,d){return o[d]||""}))},v.KeyFormat="GA::{0}::{1}",v.EventsStoreKey="ga_event",v.SessionsStoreKey="ga_session",v.ProgressionStoreKey="ga_progression",v.ItemsStoreKey="ga_items",v);function v(){this.eventsStore=[],this.sessionsStore=[],this.progressionStore=[],this.storeItems={};try{"object"==typeof localStorage?(localStorage.setItem("testingLocalStorage","yes"),localStorage.removeItem("testingLocalStorage"),v.storageAvailable=!0):v.storageAvailable=!1}catch(s){}}s.GAStore=A}((S=p=p||{}).store||(S.store={})),function(s){var o,d,h,p,S,E,A,b,w;function l(){this.availableCustomDimensions01=[],this.availableCustomDimensions02=[],this.availableCustomDimensions03=[],this.availableResourceCurrencies=[],this.availableResourceItemTypes=[],this.configurations={},this.remoteConfigsListeners=[],this.sdkConfigDefault={},this.sdkConfig={},this.progressionTries={},this._isEventSubmissionEnabled=!0}o=s.state||(s.state={}),d=s.validators.GAValidator,h=s.utilities.GAUtilities,p=s.logging.GALogger,S=s.store.GAStore,E=s.device.GADevice,A=s.store.EGAStore,b=s.store.EGAStoreArgsOperator,l.setUserId=function(s){l.instance.userId=s,l.cacheIdentifier()},l.getIdentifier=function(){return l.instance.identifier},l.isInitialized=function(){return l.instance.initialized},l.setInitialized=function(s){l.instance.initialized=s},l.getSessionStart=function(){return l.instance.sessionStart},l.getSessionNum=function(){return l.instance.sessionNum},l.getTransactionNum=function(){return l.instance.transactionNum},l.getSessionId=function(){return l.instance.sessionId},l.getCurrentCustomDimension01=function(){return l.instance.currentCustomDimension01},l.getCurrentCustomDimension02=function(){return l.instance.currentCustomDimension02},l.getCurrentCustomDimension03=function(){return l.instance.currentCustomDimension03},l.getGameKey=function(){return l.instance.gameKey},l.getGameSecret=function(){return l.instance.gameSecret},l.getAvailableCustomDimensions01=function(){return l.instance.availableCustomDimensions01},l.setAvailableCustomDimensions01=function(s){d.validateCustomDimensions(s)&&(l.instance.availableCustomDimensions01=s,l.validateAndFixCurrentDimensions(),p.i("Set available custom01 dimension values: ("+h.joinStringArray(s,", ")+")"))},l.getAvailableCustomDimensions02=function(){return l.instance.availableCustomDimensions02},l.setAvailableCustomDimensions02=function(s){d.validateCustomDimensions(s)&&(l.instance.availableCustomDimensions02=s,l.validateAndFixCurrentDimensions(),p.i("Set available custom02 dimension values: ("+h.joinStringArray(s,", ")+")"))},l.getAvailableCustomDimensions03=function(){return l.instance.availableCustomDimensions03},l.setAvailableCustomDimensions03=function(s){d.validateCustomDimensions(s)&&(l.instance.availableCustomDimensions03=s,l.validateAndFixCurrentDimensions(),p.i("Set available custom03 dimension values: ("+h.joinStringArray(s,", ")+")"))},l.getAvailableResourceCurrencies=function(){return l.instance.availableResourceCurrencies},l.setAvailableResourceCurrencies=function(s){d.validateResourceCurrencies(s)&&(l.instance.availableResourceCurrencies=s,p.i("Set available resource currencies: ("+h.joinStringArray(s,", ")+")"))},l.getAvailableResourceItemTypes=function(){return l.instance.availableResourceItemTypes},l.setAvailableResourceItemTypes=function(s){d.validateResourceItemTypes(s)&&(l.instance.availableResourceItemTypes=s,p.i("Set available resource item types: ("+h.joinStringArray(s,", ")+")"))},l.getBuild=function(){return l.instance.build},l.setBuild=function(s){l.instance.build=s,p.i("Set build version: "+s)},l.getUseManualSessionHandling=function(){return l.instance.useManualSessionHandling},l.isEventSubmissionEnabled=function(){return l.instance._isEventSubmissionEnabled},l.getABTestingId=function(){return l.instance.abId},l.getABTestingVariantId=function(){return l.instance.abVariantId},l.prototype.setDefaultId=function(s){this.defaultUserId=s||"",l.cacheIdentifier()},l.getDefaultId=function(){return l.instance.defaultUserId},l.getSdkConfig=function(){var s,o=0;for(var d in l.instance.sdkConfig)0===o&&(s=d),++o;if(s&&0<o)return l.instance.sdkConfig;for(var d in o=0,l.instance.sdkConfigCached)0===o&&(s=d),++o;return s&&0<o?l.instance.sdkConfigCached:l.instance.sdkConfigDefault},l.isEnabled=function(){return!!l.instance.initAuthorized},l.setCustomDimension01=function(s){l.instance.currentCustomDimension01=s,S.setItem(l.getGameKey(),l.Dimension01Key,s),p.i("Set custom01 dimension value: "+s)},l.setCustomDimension02=function(s){l.instance.currentCustomDimension02=s,S.setItem(l.getGameKey(),l.Dimension02Key,s),p.i("Set custom02 dimension value: "+s)},l.setCustomDimension03=function(s){l.instance.currentCustomDimension03=s,S.setItem(l.getGameKey(),l.Dimension03Key,s),p.i("Set custom03 dimension value: "+s)},l.incrementSessionNum=function(){var s=l.getSessionNum()+1;l.instance.sessionNum=s},l.incrementTransactionNum=function(){var s=l.getTransactionNum()+1;l.instance.transactionNum=s},l.incrementProgressionTries=function(s){var o=l.getProgressionTries(s)+1;l.instance.progressionTries[s]=o;var d={};d.progression=s,d.tries=o,S.insert(A.Progression,d,!0,"progression")},l.getProgressionTries=function(s){return s in l.instance.progressionTries?l.instance.progressionTries[s]:0},l.clearProgressionTries=function(s){s in l.instance.progressionTries&&delete l.instance.progressionTries[s];var o=[];o.push(["progression",b.Equal,s]),S.delete(A.Progression,o)},l.setKeys=function(s,o){l.instance.gameKey=s,l.instance.gameSecret=o},l.setManualSessionHandling=function(s){l.instance.useManualSessionHandling=s,p.i("Use manual session handling: "+s)},l.setEnabledEventSubmission=function(s){l.instance._isEventSubmissionEnabled=s},l.getEventAnnotations=function(){var s={v:2};s.user_id=l.instance.identifier,s.client_ts=l.getClientTsAdjusted(),s.sdk_version=E.getRelevantSdkVersion(),s.os_version=E.osVersion,s.manufacturer=E.deviceManufacturer,s.device=E.deviceModel,s.browser_version=E.browserVersion,s.platform=E.buildPlatform,s.session_id=l.instance.sessionId,s[l.SessionNumKey]=l.instance.sessionNum;var o=E.getConnectionType();if(d.validateConnectionType(o)&&(s.connection_type=o),E.gameEngineVersion&&(s.engine_version=E.gameEngineVersion),l.instance.configurations){var h=0;for(var p in l.instance.configurations){h++;break}0<h&&(s.configurations=l.instance.configurations)}return l.instance.abId&&(s.ab_id=l.instance.abId),l.instance.abVariantId&&(s.ab_variant_id=l.instance.abVariantId),l.instance.build&&(s.build=l.instance.build),s},l.getSdkErrorEventAnnotations=function(){var s={v:2};s.category=l.CategorySdkError,s.sdk_version=E.getRelevantSdkVersion(),s.os_version=E.osVersion,s.manufacturer=E.deviceManufacturer,s.device=E.deviceModel,s.platform=E.buildPlatform;var o=E.getConnectionType();return d.validateConnectionType(o)&&(s.connection_type=o),E.gameEngineVersion&&(s.engine_version=E.gameEngineVersion),s},l.getInitAnnotations=function(){var s={};return l.getIdentifier()||l.cacheIdentifier(),s.user_id=l.getIdentifier(),s.sdk_version=E.getRelevantSdkVersion(),s.os_version=E.osVersion,s.platform=E.buildPlatform,l.getBuild()?s.build=l.getBuild():s.build=null,s.session_num=l.getSessionNum(),s.random_salt=l.getSessionNum(),s},l.getClientTsAdjusted=function(){var s=h.timeIntervalSince1970(),o=s+l.instance.clientServerTimeOffset;return d.validateClientTs(o)?o:s},l.sessionIsStarted=function(){return 0!=l.instance.sessionStart},l.cacheIdentifier=function(){l.instance.userId?l.instance.identifier=l.instance.userId:l.instance.defaultUserId&&(l.instance.identifier=l.instance.defaultUserId)},l.ensurePersistedStates=function(){S.isStorageAvailable()&&S.load(l.getGameKey());var s=l.instance;s.setDefaultId(null!=S.getItem(l.getGameKey(),l.DefaultUserIdKey)?S.getItem(l.getGameKey(),l.DefaultUserIdKey):h.createGuid()),s.sessionNum=null!=S.getItem(l.getGameKey(),l.SessionNumKey)?Number(S.getItem(l.getGameKey(),l.SessionNumKey)):0,s.transactionNum=null!=S.getItem(l.getGameKey(),l.TransactionNumKey)?Number(S.getItem(l.getGameKey(),l.TransactionNumKey)):0,s.currentCustomDimension01?S.setItem(l.getGameKey(),l.Dimension01Key,s.currentCustomDimension01):(s.currentCustomDimension01=null!=S.getItem(l.getGameKey(),l.Dimension01Key)?S.getItem(l.getGameKey(),l.Dimension01Key):"",s.currentCustomDimension01),s.currentCustomDimension02?S.setItem(l.getGameKey(),l.Dimension02Key,s.currentCustomDimension02):(s.currentCustomDimension02=null!=S.getItem(l.getGameKey(),l.Dimension02Key)?S.getItem(l.getGameKey(),l.Dimension02Key):"",s.currentCustomDimension02),s.currentCustomDimension03?S.setItem(l.getGameKey(),l.Dimension03Key,s.currentCustomDimension03):(s.currentCustomDimension03=null!=S.getItem(l.getGameKey(),l.Dimension03Key)?S.getItem(l.getGameKey(),l.Dimension03Key):"",s.currentCustomDimension03);var o=null!=S.getItem(l.getGameKey(),l.SdkConfigCachedKey)?S.getItem(l.getGameKey(),l.SdkConfigCachedKey):"";if(o){var d=JSON.parse(h.decode64(o));d&&(s.sdkConfigCached=d)}var p=l.getSdkConfig();s.configsHash=p.configs_hash?p.configs_hash:"",s.abId=p.ab_id?p.ab_id:"",s.abVariantId=p.ab_variant_id?p.ab_variant_id:"";var E=S.select(A.Progression);if(E)for(var b=0;b<E.length;++b){var w=E[b];w&&(s.progressionTries[w.progression]=w.tries)}},l.calculateServerTimeOffset=function(s){return s-h.timeIntervalSince1970()},l.validateAndCleanCustomFields=function(s){var o={};if(s){var d=0;for(var S in s){var E=s[S];if(S&&E)if(d<l.MAX_CUSTOM_FIELDS_COUNT){var A=new RegExp("^[a-zA-Z0-9_]{1,"+l.MAX_CUSTOM_FIELDS_KEY_LENGTH+"}$");if(h.stringMatch(S,A)){var b=typeof E;if("string"==b||E instanceof String)E.length<=l.MAX_CUSTOM_FIELDS_VALUE_STRING_LENGTH&&0<E.length?(o[S]=E,++d):p.w("validateAndCleanCustomFields: entry with key="+S+", value="+E+" has been omitted because its value is an empty string or exceeds the max number of characters ("+l.MAX_CUSTOM_FIELDS_VALUE_STRING_LENGTH+")");else if("number"==b||E instanceof Number){var w=E;o[S]=w,++d}else p.w("validateAndCleanCustomFields: entry with key="+S+", value="+E+" has been omitted because its value is not a string or number")}else p.w("validateAndCleanCustomFields: entry with key="+S+", value="+E+" has been omitted because its key contains illegal character, is empty or exceeds the max number of characters ("+l.MAX_CUSTOM_FIELDS_KEY_LENGTH+")")}else p.w("validateAndCleanCustomFields: entry with key="+S+", value="+E+" has been omitted because it exceeds the max number of custom fields ("+l.MAX_CUSTOM_FIELDS_COUNT+")");else p.w("validateAndCleanCustomFields: entry with key="+S+", value="+E+" has been omitted because its key or value is null")}}return o},l.validateAndFixCurrentDimensions=function(){d.validateDimension01(l.getCurrentCustomDimension01(),l.getAvailableCustomDimensions01())||l.setCustomDimension01(""),d.validateDimension02(l.getCurrentCustomDimension02(),l.getAvailableCustomDimensions02())||l.setCustomDimension02(""),d.validateDimension03(l.getCurrentCustomDimension03(),l.getAvailableCustomDimensions03())||l.setCustomDimension03("")},l.getConfigurationStringValue=function(s,o){return l.instance.configurations[s]?l.instance.configurations[s].toString():o},l.isRemoteConfigsReady=function(){return l.instance.remoteConfigsIsReady},l.addRemoteConfigsListener=function(s){l.instance.remoteConfigsListeners.indexOf(s)<0&&l.instance.remoteConfigsListeners.push(s)},l.removeRemoteConfigsListener=function(s){var o=l.instance.remoteConfigsListeners.indexOf(s);-1<o&&l.instance.remoteConfigsListeners.splice(o,1)},l.getRemoteConfigsContentAsString=function(){return JSON.stringify(l.instance.configurations)},l.populateConfigurations=function(s){var o=s.configs;if(o){l.instance.configurations={};for(var d=0;d<o.length;++d){var h=o[d];if(h){var p=h.key,S=h.value,E=h.start_ts?h.start_ts:Number.MIN_VALUE,A=h.end_ts?h.end_ts:Number.MAX_VALUE,b=l.getClientTsAdjusted();p&&S&&E<b&&b<A&&(l.instance.configurations[p]=S)}}}l.instance.remoteConfigsIsReady=!0;var w=l.instance.remoteConfigsListeners;for(d=0;d<w.length;++d)w[d]&&w[d].onRemoteConfigsUpdated()},l.CategorySdkError="sdk_error",l.MAX_CUSTOM_FIELDS_COUNT=50,l.MAX_CUSTOM_FIELDS_KEY_LENGTH=64,l.MAX_CUSTOM_FIELDS_VALUE_STRING_LENGTH=256,l.instance=new l,l.DefaultUserIdKey="default_user_id",l.SessionNumKey="session_num",l.TransactionNumKey="transaction_num",l.Dimension01Key="dimension01",l.Dimension02Key="dimension02",l.Dimension03Key="dimension03",l.SdkConfigCachedKey="sdk_config_cached",w=l,o.GAState=w}(p=p||{}),function(s){var o,d,h,p;function u(){}o=s.tasks||(s.tasks={}),d=s.utilities.GAUtilities,h=s.logging.GALogger,u.execute=function(s,o,p,S){var E=new Date;if(u.timestampMap[o]||(u.timestampMap[o]=E),u.countMap[o]||(u.countMap[o]=0),3600<=(E.getTime()-u.timestampMap[o].getTime())/1e3&&(u.timestampMap[o]=E,u.countMap[o]=0),!(u.countMap[o]>=u.MaxCount)){var A=d.getHmac(S,p),b=new XMLHttpRequest;b.onreadystatechange=function(){if(4===b.readyState){if(!b.responseText)return;if(200!=b.status)return void h.w("sdk error failed. response code not 200. status code: "+b.status+", description: "+b.statusText+", body: "+b.responseText);u.countMap[o]=u.countMap[o]+1}},b.open("POST",s,!0),b.setRequestHeader("Content-Type","application/json"),b.setRequestHeader("Authorization",A);try{b.send(p)}catch(s){console.error(s)}}},u.MaxCount=10,u.countMap={},u.timestampMap={},p=u,o.SdkErrorTask=p}(p=p||{}),function(s){var o,d,h,p,S,E,A,b,w,I,_;function y(){this.protocol="https",this.hostName="api.gameanalytics.com",this.version="v2",this.remoteConfigsVersion="v1",this.baseUrl=this.protocol+"://"+this.hostName+"/"+this.version,this.remoteConfigsBaseUrl=this.protocol+"://"+this.hostName+"/remote_configs/"+this.remoteConfigsVersion,this.initializeUrlPath="init",this.eventsUrlPath="events",this.useGzip=!1}o=s.http||(s.http={}),d=s.state.GAState,h=s.logging.GALogger,p=s.utilities.GAUtilities,S=s.validators.GAValidator,E=s.tasks.SdkErrorTask,A=s.events.EGASdkErrorCategory,b=s.events.EGASdkErrorArea,w=s.events.EGASdkErrorAction,I=s.events.EGASdkErrorParameter,y.prototype.requestInit=function(s,h){var p=d.getGameKey(),S=this.remoteConfigsBaseUrl+"/"+this.initializeUrlPath+"?game_key="+p+"&interval_seconds=0&configs_hash="+s,E=d.getInitAnnotations(),A=JSON.stringify(E);if(A){var b=this.createPayloadData(A,this.useGzip),w=[];w.push(A),y.sendRequest(S,b,w,this.useGzip,y.initRequestCallback,h)}else h(o.EGAHTTPApiResponse.JsonEncodeFailed,null)},y.prototype.sendEventsInArray=function(s,h,p){if(0!=s.length){var S=d.getGameKey(),E=this.baseUrl+"/"+S+"/"+this.eventsUrlPath,A=JSON.stringify(s);if(A){var b=this.createPayloadData(A,this.useGzip),w=[];w.push(A),w.push(h),w.push(s.length.toString()),y.sendRequest(E,b,w,this.useGzip,y.sendEventInArrayRequestCallback,p)}else p(o.EGAHTTPApiResponse.JsonEncodeFailed,null,h,s.length)}},y.prototype.sendSdkErrorEvent=function(s,o,p,A,b,w,I){if(d.isEventSubmissionEnabled()&&S.validateSdkErrorEvent(w,I,s,o,p)){var _,L=this.baseUrl+"/"+w+"/"+this.eventsUrlPath,T="",k=d.getSdkErrorEventAnnotations(),R=y.sdkErrorCategoryString(s);T+=k.error_category=R;var x=y.sdkErrorAreaString(o);T+=":"+(k.error_area=x);var G=y.sdkErrorActionString(p);k.error_action=G;var P=y.sdkErrorParameterString(A);if(0<P.length&&(k.error_parameter=P),0<b.length){var O=b;b.length>y.MAX_ERROR_MESSAGE_LENGTH&&(O=b.substring(0,y.MAX_ERROR_MESSAGE_LENGTH)),k.reason=O}var B=[];B.push(k),(_=JSON.stringify(B))?E.execute(L,T,_,I):h.w("sendSdkErrorEvent: JSON encoding failed.")}},y.sendEventInArrayRequestCallback=function(s,h,p,S){void 0===S&&(S=null),S[0],S[1];var E,_,L=S[2],T=parseInt(S[3]);E=s.responseText,_=s.status;var k=y.instance.processRequestResponse(_,s.statusText,E,"Events");if(k==o.EGAHTTPApiResponse.Ok||k==o.EGAHTTPApiResponse.Created||k==o.EGAHTTPApiResponse.BadRequest){var R=E?JSON.parse(E):{};if(null==R)return p(o.EGAHTTPApiResponse.JsonDecodeFailed,null,L,T),void y.instance.sendSdkErrorEvent(A.Http,b.EventsHttp,w.FailHttpJsonDecode,I.Undefined,E,d.getGameKey(),d.getGameSecret());o.EGAHTTPApiResponse.BadRequest,p(k,R,L,T)}else p(k,null,L,T)},y.sendRequest=function(s,o,h,S,E,A){var b=new XMLHttpRequest,w=d.getGameSecret(),I=p.getHmac(w,o),_=[];for(var L in _.push(I),h)_.push(h[L]);if(b.onreadystatechange=function(){4===b.readyState&&E(b,s,A,_)},b.open("POST",s,!0),b.setRequestHeader("Content-Type","application/json"),b.setRequestHeader("Authorization",I),S)throw new Error("gzip not supported");try{b.send(o)}catch(s){console.error(s.stack)}},y.initRequestCallback=function(s,h,p,E){var _,L;void 0===E&&(E=null),E[0],E[1],_=s.responseText,L=s.status;var T=_?JSON.parse(_):{},k=y.instance.processRequestResponse(L,s.statusText,_,"Init");if(k==o.EGAHTTPApiResponse.Ok||k==o.EGAHTTPApiResponse.Created||k==o.EGAHTTPApiResponse.BadRequest){if(null==T)return p(o.EGAHTTPApiResponse.JsonDecodeFailed,null,"",0),void y.instance.sendSdkErrorEvent(A.Http,b.InitHttp,w.FailHttpJsonDecode,I.Undefined,_,d.getGameKey(),d.getGameSecret());if(k!==o.EGAHTTPApiResponse.BadRequest){var R=S.validateAndCleanInitRequestResponse(T,k===o.EGAHTTPApiResponse.Created);R?p(k,R,"",0):p(o.EGAHTTPApiResponse.BadResponse,null,"",0)}else p(k,null,"",0)}else p(k,null,"",0)},y.prototype.createPayloadData=function(s,o){if(o)throw new Error("gzip not supported");return s},y.prototype.processRequestResponse=function(s,d,h,p){return h?200===s?o.EGAHTTPApiResponse.Ok:201===s?o.EGAHTTPApiResponse.Created:0===s||401===s?o.EGAHTTPApiResponse.Unauthorized:400===s?o.EGAHTTPApiResponse.BadRequest:500===s?o.EGAHTTPApiResponse.InternalServerError:o.EGAHTTPApiResponse.UnknownResponseCode:o.EGAHTTPApiResponse.NoResponse},y.sdkErrorCategoryString=function(s){switch(s){case A.EventValidation:return"event_validation";case A.Database:return"db";case A.Init:return"init";case A.Http:return"http";case A.Json:return"json"}return""},y.sdkErrorAreaString=function(s){switch(s){case b.BusinessEvent:return"business";case b.ResourceEvent:return"resource";case b.ProgressionEvent:return"progression";case b.DesignEvent:return"design";case b.ErrorEvent:return"error";case b.InitHttp:return"init_http";case b.EventsHttp:return"events_http";case b.ProcessEvents:return"process_events";case b.AddEventsToStore:return"add_events_to_store"}return""},y.sdkErrorActionString=function(s){switch(s){case w.InvalidCurrency:return"invalid_currency";case w.InvalidShortString:return"invalid_short_string";case w.InvalidEventPartLength:return"invalid_event_part_length";case w.InvalidEventPartCharacters:return"invalid_event_part_characters";case w.InvalidStore:return"invalid_store";case w.InvalidFlowType:return"invalid_flow_type";case w.StringEmptyOrNull:return"string_empty_or_null";case w.NotFoundInAvailableCurrencies:return"not_found_in_available_currencies";case w.InvalidAmount:return"invalid_amount";case w.NotFoundInAvailableItemTypes:return"not_found_in_available_item_types";case w.WrongProgressionOrder:return"wrong_progression_order";case w.InvalidEventIdLength:return"invalid_event_id_length";case w.InvalidEventIdCharacters:return"invalid_event_id_characters";case w.InvalidProgressionStatus:return"invalid_progression_status";case w.InvalidSeverity:return"invalid_severity";case w.InvalidLongString:return"invalid_long_string";case w.DatabaseTooLarge:return"db_too_large";case w.DatabaseOpenOrCreate:return"db_open_or_create";case w.JsonError:return"json_error";case w.FailHttpJsonDecode:return"fail_http_json_decode";case w.FailHttpJsonEncode:return"fail_http_json_encode"}return""},y.sdkErrorParameterString=function(s){switch(s){case I.Currency:return"currency";case I.CartType:return"cart_type";case I.ItemType:return"item_type";case I.ItemId:return"item_id";case I.Store:return"store";case I.FlowType:return"flow_type";case I.Amount:return"amount";case I.Progression01:return"progression01";case I.Progression02:return"progression02";case I.Progression03:return"progression03";case I.EventId:return"event_id";case I.ProgressionStatus:return"progression_status";case I.Severity:return"severity";case I.Message:return"message"}return""},y.instance=new y,y.MAX_ERROR_MESSAGE_LENGTH=256,_=y,o.GAHTTPApi=_}(p=p||{}),function(s){var o,d,h,p,S,E,A,b,w,I,_;function C(){}o=s.events||(s.events={}),d=s.store.GAStore,h=s.store.EGAStore,p=s.store.EGAStoreArgsOperator,S=s.state.GAState,E=s.logging.GALogger,A=s.utilities.GAUtilities,b=s.http.EGAHTTPApiResponse,w=s.http.GAHTTPApi,I=s.validators.GAValidator,C.addSessionStartEvent=function(){if(S.isEventSubmissionEnabled()){var s={};s.category=C.CategorySessionStart,S.incrementSessionNum(),d.setItem(S.getGameKey(),S.SessionNumKey,S.getSessionNum().toString()),C.addDimensionsToEvent(s),C.addEventToStore(s),E.i("Add SESSION START event"),C.processEvents(C.CategorySessionStart,!1)}},C.addSessionEndEvent=function(){if(S.isEventSubmissionEnabled()){var s=S.getSessionStart(),o=S.getClientTsAdjusted()-s;o<0&&(E.w("Session length was calculated to be less then 0. Should not be possible. Resetting to 0."),o=0);var d={};d.category=C.CategorySessionEnd,d.length=o,C.addDimensionsToEvent(d),C.addEventToStore(d),E.i("Add SESSION END event."),C.processEvents("",!1)}},C.addBusinessEvent=function(s,o,h,p,A,b){if(void 0===A&&(A=null),S.isEventSubmissionEnabled()){var _=I.validateBusinessEvent(s,o,A,h,p);if(null==_){var L={};S.incrementTransactionNum(),d.setItem(S.getGameKey(),S.TransactionNumKey,S.getTransactionNum().toString()),L.event_id=h+":"+p,L.category=C.CategoryBusiness,L.currency=s,L.amount=o,L[S.TransactionNumKey]=S.getTransactionNum(),A&&(L.cart_type=A),C.addDimensionsToEvent(L),C.addFieldsToEvent(L,S.validateAndCleanCustomFields(b)),E.i("Add BUSINESS event: {currency:"+s+", amount:"+o+", itemType:"+h+", itemId:"+p+", cartType:"+A+"}"),C.addEventToStore(L)}else w.instance.sendSdkErrorEvent(_.category,_.area,_.action,_.parameter,_.reason,S.getGameKey(),S.getGameSecret())}},C.addResourceEvent=function(o,d,h,p,A,b){if(S.isEventSubmissionEnabled()){var _=I.validateResourceEvent(o,d,h,p,A,S.getAvailableResourceCurrencies(),S.getAvailableResourceItemTypes());if(null==_){o===s.EGAResourceFlowType.Sink&&(h*=-1);var L={},T=C.resourceFlowTypeToString(o);L.event_id=T+":"+d+":"+p+":"+A,L.category=C.CategoryResource,L.amount=h,C.addDimensionsToEvent(L),C.addFieldsToEvent(L,S.validateAndCleanCustomFields(b)),E.i("Add RESOURCE event: {currency:"+d+", amount:"+h+", itemType:"+p+", itemId:"+A+"}"),C.addEventToStore(L)}else w.instance.sendSdkErrorEvent(_.category,_.area,_.action,_.parameter,_.reason,S.getGameKey(),S.getGameSecret())}},C.addProgressionEvent=function(o,d,h,p,A,b,_){if(S.isEventSubmissionEnabled()){var L=C.progressionStatusToString(o),T=I.validateProgressionEvent(o,d,h,p);if(null==T){var k,R={};k=h?p?d+":"+h+":"+p:d+":"+h:d,R.category=C.CategoryProgression,R.event_id=L+":"+k;var x=0;b&&o!=s.EGAProgressionStatus.Start&&(R.score=A),o===s.EGAProgressionStatus.Fail&&S.incrementProgressionTries(k),o===s.EGAProgressionStatus.Complete&&(S.incrementProgressionTries(k),x=S.getProgressionTries(k),R.attempt_num=x,S.clearProgressionTries(k)),C.addDimensionsToEvent(R),C.addFieldsToEvent(R,S.validateAndCleanCustomFields(_)),E.i("Add PROGRESSION event: {status:"+L+", progression01:"+d+", progression02:"+h+", progression03:"+p+", score:"+A+", attempt:"+x+"}"),C.addEventToStore(R)}else w.instance.sendSdkErrorEvent(T.category,T.area,T.action,T.parameter,T.reason,S.getGameKey(),S.getGameSecret())}},C.addDesignEvent=function(s,o,d,h){if(S.isEventSubmissionEnabled()){var p=I.validateDesignEvent(s);if(null==p){var A={};A.category=C.CategoryDesign,A.event_id=s,d&&(A.value=o),C.addDimensionsToEvent(A),C.addFieldsToEvent(A,S.validateAndCleanCustomFields(h)),E.i("Add DESIGN event: {eventId:"+s+", value:"+o+"}"),C.addEventToStore(A)}else w.instance.sendSdkErrorEvent(p.category,p.area,p.action,p.parameter,p.reason,S.getGameKey(),S.getGameSecret())}},C.addErrorEvent=function(s,o,d){if(S.isEventSubmissionEnabled()){var h=C.errorSeverityToString(s),p=I.validateErrorEvent(s,o);if(null==p){var A={};A.category=C.CategoryError,A.severity=h,A.message=o,C.addDimensionsToEvent(A),C.addFieldsToEvent(A,S.validateAndCleanCustomFields(d)),E.i("Add ERROR event: {severity:"+h+", message:"+o+"}"),C.addEventToStore(A)}else w.instance.sendSdkErrorEvent(p.category,p.area,p.action,p.parameter,p.reason,S.getGameKey(),S.getGameSecret())}},C.addAdEvent=function(o,d,h,p,A,b,_,L){if(S.isEventSubmissionEnabled()){var T=C.adActionToString(o),k=C.adTypeToString(d),R=C.adErrorToString(A),x=I.validateAdEvent(o,d,h,p);if(null==x){var G={};G.category=C.CategoryAds,G.ad_sdk_name=h,G.ad_placement=p,G.ad_type=k,G.ad_action=T,o==s.EGAAdAction.FailedShow&&0<R.length&&(G.ad_fail_show_reason=R),!_||d!=s.EGAAdType.RewardedVideo&&d!=s.EGAAdType.Video||(G.ad_duration=b),C.addDimensionsToEvent(G),C.addFieldsToEvent(G,S.validateAndCleanCustomFields(L)),E.i("Add AD event: {ad_sdk_name:"+h+", ad_placement:"+p+", ad_type:"+k+", ad_action:"+T+(o==s.EGAAdAction.FailedShow&&0<R.length?", ad_fail_show_reason:"+R:"")+(!_||d!=s.EGAAdType.RewardedVideo&&d!=s.EGAAdType.Video?"":", ad_duration:"+b)+"}"),C.addEventToStore(G)}else w.instance.sendSdkErrorEvent(x.category,x.area,x.action,x.parameter,x.reason,S.getGameKey(),S.getGameSecret())}},C.processEvents=function(s,b){if(S.isEventSubmissionEnabled())try{var I=A.createGuid();b&&(C.cleanupEvents(),C.fixMissingSessionEndEvents());var _=[];_.push(["status",p.Equal,"new"]);var L=[];L.push(["status",p.Equal,"new"]),s&&(_.push(["category",p.Equal,s]),L.push(["category",p.Equal,s]));var T=[];T.push(["status",I]);var k=d.select(h.Events,_);if(!k||0==k.length)return E.i("Event queue: No events to send"),void C.updateSessionStore();if(k.length>C.MaxEventCount){if(!(k=d.select(h.Events,_,!0,C.MaxEventCount)))return;var R=k[k.length-1].client_ts;if(_.push(["client_ts",p.LessOrEqual,R]),!(k=d.select(h.Events,_)))return;L.push(["client_ts",p.LessOrEqual,R])}if(E.i("Event queue: Sending "+k.length+" events."),!d.update(h.Events,T,L))return;for(var x=[],G=0;G<k.length;++G){var P=k[G],O=JSON.parse(A.decode64(P.event));0!=O.length&&x.push(O)}w.instance.sendEventsInArray(x,I,C.processEventsCallback)}catch(s){E.e("Error during ProcessEvents(): "+s.stack),w.instance.sendSdkErrorEvent(o.EGASdkErrorCategory.Json,o.EGASdkErrorArea.ProcessEvents,o.EGASdkErrorAction.JsonError,o.EGASdkErrorParameter.Undefined,s.stack,S.getGameKey(),S.getGameSecret())}},C.processEventsCallback=function(s,o,S,A){var w=[];if(w.push(["status",p.Equal,S]),s===b.Ok)d.delete(h.Events,w),E.i("Event queue: "+A+" events sent.");else if(s===b.NoResponse){var I=[];I.push(["status","new"]),E.w("Event queue: Failed to send events to collector - Retrying next time"),d.update(h.Events,I,w)}else{if(o){var _,L=0;for(var T in o)0==L&&(_=o[T]),++L;s===b.BadRequest&&_.constructor===Array?E.w("Event queue: "+A+" events sent. "+L+" events failed GA server validation."):E.w("Event queue: Failed to send events.")}else E.w("Event queue: Failed to send events.");d.delete(h.Events,w)}},C.cleanupEvents=function(){d.update(h.Events,[["status","new"]])},C.fixMissingSessionEndEvents=function(){if(S.isEventSubmissionEnabled()){var s=[];s.push(["session_id",p.NotEqual,S.getSessionId()]);var o=d.select(h.Sessions,s);if(o&&0!=o.length){E.i(o.length+" session(s) located with missing session_end event.");for(var b=0;b<o.length;++b){var w=JSON.parse(A.decode64(o[b].event)),I=w.client_ts-o[b].timestamp;I=Math.max(0,I),w.category=C.CategorySessionEnd,w.length=I,C.addEventToStore(w)}}}},C.addEventToStore=function(s){if(S.isEventSubmissionEnabled())if(S.isInitialized())try{if(d.isStoreTooLargeForEvents()&&!A.stringMatch(s.category,/^(user|session_end|business)$/))return E.w("Database too large. Event has been blocked."),void w.instance.sendSdkErrorEvent(o.EGASdkErrorCategory.Database,o.EGASdkErrorArea.AddEventsToStore,o.EGASdkErrorAction.DatabaseTooLarge,o.EGASdkErrorParameter.Undefined,"",S.getGameKey(),S.getGameSecret());var b=S.getEventAnnotations(),I=A.encode64(JSON.stringify(b));for(var _ in s)b[_]=s[_];var L=JSON.stringify(b);E.ii("Event added to queue: "+L);var T={status:"new"};T.category=b.category,T.session_id=b.session_id,T.client_ts=b.client_ts,T.event=A.encode64(JSON.stringify(b)),d.insert(h.Events,T),s.category==C.CategorySessionEnd?d.delete(h.Sessions,[["session_id",p.Equal,b.session_id]]):((T={}).session_id=b.session_id,T.timestamp=S.getSessionStart(),T.event=I,d.insert(h.Sessions,T,!0,"session_id")),d.isStorageAvailable()&&d.save(S.getGameKey())}catch(_){E.e("addEventToStore: error"),E.e(_.stack),w.instance.sendSdkErrorEvent(o.EGASdkErrorCategory.Database,o.EGASdkErrorArea.AddEventsToStore,o.EGASdkErrorAction.DatabaseTooLarge,o.EGASdkErrorParameter.Undefined,_.stack,S.getGameKey(),S.getGameSecret())}else E.w("Could not add event: SDK is not initialized")},C.updateSessionStore=function(){if(S.sessionIsStarted()){var s={};s.session_id=S.instance.sessionId,s.timestamp=S.getSessionStart(),s.event=A.encode64(JSON.stringify(S.getEventAnnotations())),d.insert(h.Sessions,s,!0,"session_id"),d.isStorageAvailable()&&d.save(S.getGameKey())}},C.addDimensionsToEvent=function(s){s&&(S.getCurrentCustomDimension01()&&(s.custom_01=S.getCurrentCustomDimension01()),S.getCurrentCustomDimension02()&&(s.custom_02=S.getCurrentCustomDimension02()),S.getCurrentCustomDimension03()&&(s.custom_03=S.getCurrentCustomDimension03()))},C.addFieldsToEvent=function(s,o){s&&o&&0<Object.keys(o).length&&(s.custom_fields=o)},C.resourceFlowTypeToString=function(o){return o==s.EGAResourceFlowType.Source||o==s.EGAResourceFlowType[s.EGAResourceFlowType.Source]?"Source":o==s.EGAResourceFlowType.Sink||o==s.EGAResourceFlowType[s.EGAResourceFlowType.Sink]?"Sink":""},C.progressionStatusToString=function(o){return o==s.EGAProgressionStatus.Start||o==s.EGAProgressionStatus[s.EGAProgressionStatus.Start]?"Start":o==s.EGAProgressionStatus.Complete||o==s.EGAProgressionStatus[s.EGAProgressionStatus.Complete]?"Complete":o==s.EGAProgressionStatus.Fail||o==s.EGAProgressionStatus[s.EGAProgressionStatus.Fail]?"Fail":""},C.errorSeverityToString=function(o){return o==s.EGAErrorSeverity.Debug||o==s.EGAErrorSeverity[s.EGAErrorSeverity.Debug]?"debug":o==s.EGAErrorSeverity.Info||o==s.EGAErrorSeverity[s.EGAErrorSeverity.Info]?"info":o==s.EGAErrorSeverity.Warning||o==s.EGAErrorSeverity[s.EGAErrorSeverity.Warning]?"warning":o==s.EGAErrorSeverity.Error||o==s.EGAErrorSeverity[s.EGAErrorSeverity.Error]?"error":o==s.EGAErrorSeverity.Critical||o==s.EGAErrorSeverity[s.EGAErrorSeverity.Critical]?"critical":""},C.adActionToString=function(o){return o==s.EGAAdAction.Clicked||o==s.EGAAdAction[s.EGAAdAction.Clicked]?"clicked":o==s.EGAAdAction.Show||o==s.EGAAdAction[s.EGAAdAction.Show]?"show":o==s.EGAAdAction.FailedShow||o==s.EGAAdAction[s.EGAAdAction.FailedShow]?"failed_show":o==s.EGAAdAction.RewardReceived||o==s.EGAAdAction[s.EGAAdAction.RewardReceived]?"reward_recevied":""},C.adErrorToString=function(o){return o==s.EGAAdError.Unknown||o==s.EGAAdError[s.EGAAdError.Unknown]?"unknown":o==s.EGAAdError.Offline||o==s.EGAAdError[s.EGAAdError.Offline]?"offline":o==s.EGAAdError.NoFill||o==s.EGAAdError[s.EGAAdError.NoFill]?"no_fill":o==s.EGAAdError.InternalError||o==s.EGAAdError[s.EGAAdError.InternalError]?"internal_error":o==s.EGAAdError.InvalidRequest||o==s.EGAAdError[s.EGAAdError.InvalidRequest]?"invalid_request":o==s.EGAAdError.UnableToPrecache||o==s.EGAAdError[s.EGAAdError.UnableToPrecache]?"unable_to_precache":""},C.adTypeToString=function(o){return o==s.EGAAdType.Video||o==s.EGAAdType[s.EGAAdType.Video]?"video":o==s.EGAAdType.RewardedVideo||o==s.EGAAdError[s.EGAAdType.RewardedVideo]?"rewarded_video":o==s.EGAAdType.Playable||o==s.EGAAdError[s.EGAAdType.Playable]?"playable":o==s.EGAAdType.Interstitial||o==s.EGAAdError[s.EGAAdType.Interstitial]?"interstitial":o==s.EGAAdType.OfferWall||o==s.EGAAdError[s.EGAAdType.OfferWall]?"offer_wall":o==s.EGAAdType.Banner||o==s.EGAAdError[s.EGAAdType.Banner]?"banner":""},C.CategorySessionStart="user",C.CategorySessionEnd="session_end",C.CategoryDesign="design",C.CategoryBusiness="business",C.CategoryProgression="progression",C.CategoryResource="resource",C.CategoryError="error",C.CategoryAds="ads",C.MaxEventCount=500,_=C,o.GAEvents=_}(p=p||{}),function(s){var o,d,h,p,S;function a(){this.blocks=new o.PriorityQueue({compare:function(s,o){return s-o}}),this.id2TimedBlockMap={},a.startThread()}o=s.threading||(s.threading={}),d=s.logging.GALogger,h=s.state.GAState,p=s.events.GAEvents,a.createTimedBlock=function(s){void 0===s&&(s=0);var d=new Date;return d.setSeconds(d.getSeconds()+s),new o.TimedBlock(d)},a.performTaskOnGAThread=function(s,d){void 0===d&&(d=0);var h=new Date;h.setSeconds(h.getSeconds()+d);var p=new o.TimedBlock(h);p.block=s,a.instance.id2TimedBlockMap[p.id]=p,a.instance.addTimedBlock(p)},a.performTimedBlockOnGAThread=function(s){a.instance.id2TimedBlockMap[s.id]=s,a.instance.addTimedBlock(s)},a.scheduleTimer=function(s,d){var h=new Date;h.setSeconds(h.getSeconds()+s);var p=new o.TimedBlock(h);return p.block=d,a.instance.id2TimedBlockMap[p.id]=p,a.instance.addTimedBlock(p),p.id},a.getTimedBlockById=function(s){return s in a.instance.id2TimedBlockMap?a.instance.id2TimedBlockMap[s]:null},a.ensureEventQueueIsRunning=function(){a.instance.keepRunning=!0,a.instance.isRunning||(a.instance.isRunning=!0,a.scheduleTimer(a.ProcessEventsIntervalInSeconds,a.processEventQueue))},a.endSessionAndStopQueue=function(){h.isInitialized()&&(d.i("Ending session."),a.stopEventQueue(),h.isEnabled()&&h.sessionIsStarted()&&(p.addSessionEndEvent(),h.instance.sessionStart=0))},a.stopEventQueue=function(){a.instance.keepRunning=!1},a.ignoreTimer=function(s){s in a.instance.id2TimedBlockMap&&(a.instance.id2TimedBlockMap[s].ignore=!0)},a.setEventProcessInterval=function(s){0<s&&(a.ProcessEventsIntervalInSeconds=s)},a.prototype.addTimedBlock=function(s){this.blocks.enqueue(s.deadline.getTime(),s)},a.run=function(){clearTimeout(a.runTimeoutId);try{for(var s;s=a.getNextBlock();)if(!s.ignore)if(s.async){if(!s.running){s.running=!0,s.block();break}}else s.block();return void(a.runTimeoutId=setTimeout(a.run,a.ThreadWaitTimeInMs))}catch(s){d.e("Error on GA thread"),d.e(s.stack)}},a.startThread=function(){a.runTimeoutId=setTimeout(a.run,0)},a.getNextBlock=function(){var s=new Date;return a.instance.blocks.hasItems()&&a.instance.blocks.peek().deadline.getTime()<=s.getTime()?a.instance.blocks.peek().async&&a.instance.blocks.peek().running?a.instance.blocks.peek():a.instance.blocks.dequeue():null},a.processEventQueue=function(){p.processEvents("",!0),a.instance.keepRunning?a.scheduleTimer(a.ProcessEventsIntervalInSeconds,a.processEventQueue):a.instance.isRunning=!1},a.instance=new a,a.ThreadWaitTimeInMs=1e3,a.ProcessEventsIntervalInSeconds=8,S=a,o.GAThreading=S}(p=p||{}),function(s){var o=s.threading.GAThreading,d=s.logging.GALogger,h=s.store.GAStore,p=s.state.GAState,S=s.http.GAHTTPApi,E=s.device.GADevice,A=s.validators.GAValidator,b=s.http.EGAHTTPApiResponse,w=s.utilities.GAUtilities,I=s.events.GAEvents,_=(m.init=function(){if(E.touch(),m.methodMap.configureAvailableCustomDimensions01=m.configureAvailableCustomDimensions01,m.methodMap.configureAvailableCustomDimensions02=m.configureAvailableCustomDimensions02,m.methodMap.configureAvailableCustomDimensions03=m.configureAvailableCustomDimensions03,m.methodMap.configureAvailableResourceCurrencies=m.configureAvailableResourceCurrencies,m.methodMap.configureAvailableResourceItemTypes=m.configureAvailableResourceItemTypes,m.methodMap.configureBuild=m.configureBuild,m.methodMap.configureSdkGameEngineVersion=m.configureSdkGameEngineVersion,m.methodMap.configureGameEngineVersion=m.configureGameEngineVersion,m.methodMap.configureUserId=m.configureUserId,m.methodMap.initialize=m.initialize,m.methodMap.addBusinessEvent=m.addBusinessEvent,m.methodMap.addResourceEvent=m.addResourceEvent,m.methodMap.addProgressionEvent=m.addProgressionEvent,m.methodMap.addDesignEvent=m.addDesignEvent,m.methodMap.addErrorEvent=m.addErrorEvent,m.methodMap.addErrorEvent=m.addErrorEvent,m.methodMap.setEnabledInfoLog=m.setEnabledInfoLog,m.methodMap.setEnabledVerboseLog=m.setEnabledVerboseLog,m.methodMap.setEnabledManualSessionHandling=m.setEnabledManualSessionHandling,m.methodMap.setEnabledEventSubmission=m.setEnabledEventSubmission,m.methodMap.setCustomDimension01=m.setCustomDimension01,m.methodMap.setCustomDimension02=m.setCustomDimension02,m.methodMap.setCustomDimension03=m.setCustomDimension03,m.methodMap.setEventProcessInterval=m.setEventProcessInterval,m.methodMap.startSession=m.startSession,m.methodMap.endSession=m.endSession,m.methodMap.onStop=m.onStop,m.methodMap.onResume=m.onResume,m.methodMap.addRemoteConfigsListener=m.addRemoteConfigsListener,m.methodMap.removeRemoteConfigsListener=m.removeRemoteConfigsListener,m.methodMap.getRemoteConfigsValueAsString=m.getRemoteConfigsValueAsString,m.methodMap.isRemoteConfigsReady=m.isRemoteConfigsReady,m.methodMap.getRemoteConfigsContentAsString=m.getRemoteConfigsContentAsString,"undefined"!=typeof window&&void 0!==window.GameAnalytics&&void 0!==window.GameAnalytics.q){var s=window.GameAnalytics.q;for(var d in s)m.gaCommand.apply(null,s[d])}window.addEventListener("beforeunload",(function(){console.log("addEventListener unload"),o.endSessionAndStopQueue()}))},m.gaCommand=function(){for(var o=[],d=0;d<arguments.length;d++)o[d]=arguments[d];0<o.length&&o[0]in s.GameAnalytics.methodMap&&(1<o.length?s.GameAnalytics.methodMap[o[0]].apply(null,Array.prototype.slice.call(o,1)):s.GameAnalytics.methodMap[o[0]]())},m.configureAvailableCustomDimensions01=function(s){void 0===s&&(s=[]),o.performTaskOnGAThread((function(){m.isSdkReady(!0,!1)?d.w("Available custom dimensions must be set before SDK is initialized"):p.setAvailableCustomDimensions01(s)}))},m.configureAvailableCustomDimensions02=function(s){void 0===s&&(s=[]),o.performTaskOnGAThread((function(){m.isSdkReady(!0,!1)?d.w("Available custom dimensions must be set before SDK is initialized"):p.setAvailableCustomDimensions02(s)}))},m.configureAvailableCustomDimensions03=function(s){void 0===s&&(s=[]),o.performTaskOnGAThread((function(){m.isSdkReady(!0,!1)?d.w("Available custom dimensions must be set before SDK is initialized"):p.setAvailableCustomDimensions03(s)}))},m.configureAvailableResourceCurrencies=function(s){void 0===s&&(s=[]),o.performTaskOnGAThread((function(){m.isSdkReady(!0,!1)?d.w("Available resource currencies must be set before SDK is initialized"):p.setAvailableResourceCurrencies(s)}))},m.configureAvailableResourceItemTypes=function(s){void 0===s&&(s=[]),o.performTaskOnGAThread((function(){m.isSdkReady(!0,!1)?d.w("Available resource item types must be set before SDK is initialized"):p.setAvailableResourceItemTypes(s)}))},m.configureBuild=function(s){void 0===s&&(s=""),o.performTaskOnGAThread((function(){m.isSdkReady(!0,!1)?d.w("Build version must be set before SDK is initialized."):A.validateBuild(s)?p.setBuild(s):d.i("Validation fail - configure build: Cannot be null, empty or above 32 length. String: "+s)}))},m.configureSdkGameEngineVersion=function(s){void 0===s&&(s=""),o.performTaskOnGAThread((function(){m.isSdkReady(!0,!1)||(A.validateSdkWrapperVersion(s)?E.sdkGameEngineVersion=s:d.i("Validation fail - configure sdk version: Sdk version not supported. String: "+s))}))},m.configureGameEngineVersion=function(s){void 0===s&&(s=""),o.performTaskOnGAThread((function(){m.isSdkReady(!0,!1)||(A.validateEngineVersion(s)?E.gameEngineVersion=s:d.i("Validation fail - configure game engine version: Game engine version not supported. String: "+s))}))},m.configureUserId=function(s){void 0===s&&(s=""),o.performTaskOnGAThread((function(){m.isSdkReady(!0,!1)?d.w("A custom user id must be set before SDK is initialized."):A.validateUserId(s)?p.setUserId(s):d.i("Validation fail - configure user_id: Cannot be null, empty or above 64 length. Will use default user_id method. Used string: "+s)}))},m.initialize=function(s,h){void 0===s&&(s=""),void 0===h&&(h=""),E.updateConnectionType();var S=o.createTimedBlock();S.async=!0,m.initTimedBlockId=S.id,S.block=function(){m.isSdkReady(!0,!1)?d.w("SDK already initialized. Can only be called once."):A.validateKeys(s,h)?(p.setKeys(s,h),m.internalInitialize()):d.w("SDK failed initialize. Game key or secret key is invalid. Can only contain characters A-z 0-9, gameKey is 32 length, gameSecret is 40 length. Failed keys - gameKey: "+s+", secretKey: "+h)},o.performTimedBlockOnGAThread(S)},m.addBusinessEvent=function(s,d,h,p,S){void 0===s&&(s=""),void 0===d&&(d=0),void 0===h&&(h=""),void 0===p&&(p=""),void 0===S&&(S=""),E.updateConnectionType(),o.performTaskOnGAThread((function(){m.isSdkReady(!0,!0,"Could not add business event")&&I.addBusinessEvent(s,d,h,p,S,{})}))},m.addResourceEvent=function(d,h,p,S,A){void 0===d&&(d=s.EGAResourceFlowType.Undefined),void 0===h&&(h=""),void 0===p&&(p=0),void 0===S&&(S=""),void 0===A&&(A=""),E.updateConnectionType(),o.performTaskOnGAThread((function(){m.isSdkReady(!0,!0,"Could not add resource event")&&I.addResourceEvent(d,h,p,S,A,{})}))},m.addProgressionEvent=function(d,h,p,S,A){void 0===d&&(d=s.EGAProgressionStatus.Undefined),void 0===h&&(h=""),void 0===p&&(p=""),void 0===S&&(S=""),E.updateConnectionType(),o.performTaskOnGAThread((function(){if(m.isSdkReady(!0,!0,"Could not add progression event")){var s="number"==typeof A;I.addProgressionEvent(d,h,p,S,s?A:0,s,{})}}))},m.addDesignEvent=function(s,d){E.updateConnectionType(),o.performTaskOnGAThread((function(){if(m.isSdkReady(!0,!0,"Could not add design event")){var o="number"==typeof d;I.addDesignEvent(s,o?d:0,o,{})}}))},m.addErrorEvent=function(d,h){void 0===d&&(d=s.EGAErrorSeverity.Undefined),void 0===h&&(h=""),E.updateConnectionType(),o.performTaskOnGAThread((function(){m.isSdkReady(!0,!0,"Could not add error event")&&I.addErrorEvent(d,h,{})}))},m.addAdEventWithNoAdReason=function(d,h,p,S,A){void 0===d&&(d=s.EGAAdAction.Undefined),void 0===h&&(h=s.EGAAdType.Undefined),void 0===p&&(p=""),void 0===S&&(S=""),void 0===A&&(A=s.EGAAdError.Undefined),E.updateConnectionType(),o.performTaskOnGAThread((function(){m.isSdkReady(!0,!0,"Could not add ad event")&&I.addAdEvent(d,h,p,S,A,0,!1,{})}))},m.addAdEventWithDuration=function(d,h,p,S,A){void 0===d&&(d=s.EGAAdAction.Undefined),void 0===h&&(h=s.EGAAdType.Undefined),void 0===p&&(p=""),void 0===S&&(S=""),void 0===A&&(A=0),E.updateConnectionType(),o.performTaskOnGAThread((function(){m.isSdkReady(!0,!0,"Could not add ad event")&&I.addAdEvent(d,h,p,S,s.EGAAdError.Undefined,A,!0,{})}))},m.addAdEvent=function(d,h,p,S){void 0===d&&(d=s.EGAAdAction.Undefined),void 0===h&&(h=s.EGAAdType.Undefined),void 0===p&&(p=""),void 0===S&&(S=""),E.updateConnectionType(),o.performTaskOnGAThread((function(){m.isSdkReady(!0,!0,"Could not add ad event")&&I.addAdEvent(d,h,p,S,s.EGAAdError.Undefined,0,!1,{})}))},m.setEnabledInfoLog=function(s){void 0===s&&(s=!1),o.performTaskOnGAThread((function(){s?(d.setInfoLog(s),d.i("Info logging enabled")):(d.i("Info logging disabled"),d.setInfoLog(s))}))},m.setEnabledVerboseLog=function(s){void 0===s&&(s=!1),o.performTaskOnGAThread((function(){s?(d.setVerboseLog(s),d.i("Verbose logging enabled")):(d.i("Verbose logging disabled"),d.setVerboseLog(s))}))},m.setEnabledManualSessionHandling=function(s){void 0===s&&(s=!1),o.performTaskOnGAThread((function(){p.setManualSessionHandling(s)}))},m.setEnabledEventSubmission=function(s){void 0===s&&(s=!1),o.performTaskOnGAThread((function(){s?(p.setEnabledEventSubmission(s),d.i("Event submission enabled")):(d.i("Event submission disabled"),p.setEnabledEventSubmission(s))}))},m.setCustomDimension01=function(s){void 0===s&&(s=""),o.performTaskOnGAThread((function(){A.validateDimension01(s,p.getAvailableCustomDimensions01())?p.setCustomDimension01(s):d.w("Could not set custom01 dimension value to '"+s+"'. Value not found in available custom01 dimension values")}))},m.setCustomDimension02=function(s){void 0===s&&(s=""),o.performTaskOnGAThread((function(){A.validateDimension02(s,p.getAvailableCustomDimensions02())?p.setCustomDimension02(s):d.w("Could not set custom02 dimension value to '"+s+"'. Value not found in available custom02 dimension values")}))},m.setCustomDimension03=function(s){void 0===s&&(s=""),o.performTaskOnGAThread((function(){A.validateDimension03(s,p.getAvailableCustomDimensions03())?p.setCustomDimension03(s):d.w("Could not set custom03 dimension value to '"+s+"'. Value not found in available custom03 dimension values")}))},m.setEventProcessInterval=function(s){o.performTaskOnGAThread((function(){o.setEventProcessInterval(s)}))},m.startSession=function(){if(p.isInitialized()){var s=o.createTimedBlock();s.async=!0,m.initTimedBlockId=s.id,s.block=function(){p.isEnabled()&&p.sessionIsStarted()&&o.endSessionAndStopQueue(),m.resumeSessionAndStartQueue()},o.performTimedBlockOnGAThread(s)}},m.endSession=function(){m.onStop()},m.onStop=function(){o.performTaskOnGAThread((function(){try{o.endSessionAndStopQueue()}catch(s){}}))},m.onResume=function(){var s=o.createTimedBlock();s.async=!0,m.initTimedBlockId=s.id,s.block=function(){m.resumeSessionAndStartQueue()},o.performTimedBlockOnGAThread(s)},m.getRemoteConfigsValueAsString=function(s,o){return void 0===o&&(o=null),p.getConfigurationStringValue(s,o)},m.isRemoteConfigsReady=function(){return p.isRemoteConfigsReady()},m.addRemoteConfigsListener=function(s){p.addRemoteConfigsListener(s)},m.removeRemoteConfigsListener=function(s){p.removeRemoteConfigsListener(s)},m.getRemoteConfigsContentAsString=function(){return p.getRemoteConfigsContentAsString()},m.getABTestingId=function(){return p.getABTestingId()},m.getABTestingVariantId=function(){return p.getABTestingVariantId()},m.internalInitialize=function(){p.ensurePersistedStates(),h.setItem(p.getGameKey(),p.DefaultUserIdKey,p.getDefaultId()),p.setInitialized(!0),m.newSession(),p.isEnabled()&&o.ensureEventQueueIsRunning()},m.newSession=function(){d.i("Starting a new session."),p.validateAndFixCurrentDimensions(),S.instance.requestInit(p.instance.configsHash,m.startNewSessionCallback)},m.startNewSessionCallback=function(s,S){if(s!==b.Ok&&s!==b.Created||!S)s==b.Unauthorized?(d.w("Initialize SDK failed - Unauthorized"),p.instance.initAuthorized=!1):(s===b.NoResponse||s===b.RequestTimeout?d.i("Init call (session start) failed - no response. Could be offline or timeout."):s===b.BadResponse||s===b.JsonEncodeFailed||s===b.JsonDecodeFailed?d.i("Init call (session start) failed - bad response. Could be bad response from proxy or GA servers."):s!==b.BadRequest&&s!==b.UnknownResponseCode||d.i("Init call (session start) failed - bad request or unknown response."),null==p.instance.sdkConfig?null!=p.instance.sdkConfigCached?(d.i("Init call (session start) failed - using cached init values."),p.instance.sdkConfig=p.instance.sdkConfigCached):(d.i("Init call (session start) failed - using default init values."),p.instance.sdkConfig=p.instance.sdkConfigDefault):d.i("Init call (session start) failed - using cached init values."),p.instance.initAuthorized=!0);else{var E=0;if(S.server_ts){var A=S.server_ts;E=p.calculateServerTimeOffset(A)}if(S.time_offset=E,s!=b.Created){var _=p.getSdkConfig();_.configs&&(S.configs=_.configs),_.configs_hash&&(S.configs_hash=_.configs_hash),_.ab_id&&(S.ab_id=_.ab_id),_.ab_variant_id&&(S.ab_variant_id=_.ab_variant_id)}p.instance.configsHash=S.configs_hash?S.configs_hash:"",p.instance.abId=S.ab_id?S.ab_id:"",p.instance.abVariantId=S.ab_variant_id?S.ab_variant_id:"",h.setItem(p.getGameKey(),p.SdkConfigCachedKey,w.encode64(JSON.stringify(S))),p.instance.sdkConfigCached=S,p.instance.sdkConfig=S,p.instance.initAuthorized=!0}if(p.instance.clientServerTimeOffset=p.getSdkConfig().time_offset?p.getSdkConfig().time_offset:0,p.populateConfigurations(p.getSdkConfig()),!p.isEnabled())return d.w("Could not start session: SDK is disabled."),void o.stopEventQueue();o.ensureEventQueueIsRunning();var L=w.createGuid();p.instance.sessionId=L,p.instance.sessionStart=p.getClientTsAdjusted(),I.addSessionStartEvent();var T=o.getTimedBlockById(m.initTimedBlockId);null!=T&&(T.running=!1),m.initTimedBlockId=-1},m.resumeSessionAndStartQueue=function(){p.isInitialized()&&(d.i("Resuming session."),p.sessionIsStarted()||m.newSession())},m.isSdkReady=function(s,o,h){return void 0===o&&(o=!0),void 0===h&&(h=""),h&&(h+=": "),s&&!p.isInitialized()?(o&&d.w(h+"SDK is not initialized"),!1):s&&!p.isEnabled()?(o&&d.w(h+"SDK is disabled"),!1):!(s&&!p.sessionIsStarted()&&(o&&d.w(h+"Session has not started yet"),1))},m.initTimedBlockId=-1,m.methodMap={},m);function m(){}s.GameAnalytics=_}(p=p||{}),p.GameAnalytics.init();var b=p.GameAnalytics.gaCommand;s.gameanalytics=p,s.GameAnalytics=b}(F);let q=window.Lq=new class extends class{constructor(){this.gameName="bqgs",this.gameid=999,this.cdnUrl="",this.preNetSpeed=0,this.langType="en",this.langTypeDefault="en",this._assetI18nPrefix=null,this.appType="h5",this.naviAppList=[],this.view={},this.isDebug=!0,this.logLevel=3,this.userInfo={uid:""},this.time={startLoading:0},this.timer={lastTimerid:0,cache:{},tpl:{name:"",id:0,isOver:!1,overCallback:null},loading:null},this.ui={},this.language={},this.Scene={load:(s,o,d)=>{K.checkScene(s)&&Laya.Scene.load(s,o,d)},open:(s,o,d,h,p)=>{K.checkScene(s)&&Laya.Scene.open(s,o,d,h,p)}},this.Scene3D={load:(s,o)=>{s=K.cdnUrl+s,Laya.Scene3D.load(s,o)}},this.MeshSprite3D={load:(s,o)=>{s=K.cdnUrl+s,Laya.MeshSprite3D.load(s,o)}},this.loader={load:(s,o,d,h,p,S,E,A,b)=>{"string"==typeof s?s=K.cdnUrl+s:Array.isArray(s)&&s.forEach(s=>{s.url=K.cdnUrl+s.url}),Laya.loader.load(s,o,d,h,p,S,E,A,b)},getRes:s=>(s=K.cdnUrl+s,Laya.loader.getRes(s))},this.LocalStorage={setItem:(s,o)=>{s&&(s=this.prefix+s,Laya.LocalStorage.setItem(s,o))},getItem:s=>{if(s)return s=this.prefix+s,Laya.LocalStorage.getItem(s)},setJSON:(s,o)=>{s&&(s=this.prefix+s,Laya.LocalStorage.setJSON(s,o))},getJSON:s=>{if(s)return s=this.prefix+s,Laya.LocalStorage.getJSON(s)},removeItem:s=>{if(s)return s=this.prefix+s,Laya.LocalStorage.removeItem(s)},clear:()=>Laya.LocalStorage.clear()},this.addTimer=(s,o)=>{if(["cache","tpl","lastTimerid"].indexOf(s)>-1)return console.error(s+"为保留关键字，不能使用");this.timer.cache=this.timer.cache||{};let d=Object.assign({},this.timer.tpl);d.id=o,d.name=s,this.timer.cache[o]=d,this.timer[s]=o},K=this,this.util=M,this.language=D,this.initDebug(),this.initStorage(),this.initAnalytics()}get pfName(){return this._pfName}get prefix(){if(this._prefix)return this._prefix;let s="";return this._pfName&&(s=this._pfName+"_"),s+=this.gameName+"_",this._prefix=s,this._prefix}request(s){if((s=s||{}).api=s.api||"",s.url=s.url||"",""==s.api&&""==s.url)return console.log("apiName is need");let o=this.apiHost+"/"+s.api;""!=s.url&&(o=s.url);let d=s.data||{};d.gameid=d.gameid||this.gameid,d.pfName=this._pfName,d=this.parseParams(d);s.success=s.success||function(){},s.fail=s.fail||function(){},s.header=s.header||["Content-Type","application/x-www-form-urlencoded"],s.method=s.method||"post",s.responseType=s.responseType||"json",s.async=!1!==s.async;let h=new Laya.HttpRequest;h.send(o,d,s.method,s.responseType,s.header),h.once(Laya.Event.COMPLETE,this,s.success),h.once(Laya.Event.ERROR,this,s.fail)}init(){}onLaunch(){document.title=this.lang("游戏名称")}hideLoading(){let s=Laya.Browser.document.getElementById("loading-box");s&&(s.style.display="none")}getUIStatus(s,o){return!(!s||!o)&&(!!this.ui[s]&&("undefined"!==this.ui[s][o]&&this.ui[s][o]))}getUserData(){let s={},o=Laya.LocalStorage;return["usePeopleId","peopleData","totalGold","shipData","keyNum","useShipId"].forEach(d=>{s[d]=o.getItem(d)}),s}checkScene(s){let o=s.split("/").pop().split(".")[0];return K.ui[o]=K.ui[o]||{},!1!==K.ui[o].status}parseParams(s,o,d=!0){if(null==s)return"";let h="",p=typeof s;if("string"==p||"number"==p||"boolean"==p)h+="&"+o+"="+(null==d||d?encodeURIComponent(s):s);else for(let p in s){let S=null==o?p:o+(s instanceof Array?"["+p+"]":"."+p);h+=this.parseParams(s[p],S,d)}return h}createUid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(s){var o=16*Math.random()|0;return("x"==s?o:3&o|8).toString(16)}))}initDebug(){var s={log:1,debug:2,info:3,warn:4,error:5};if(!this.isDebug)for(let o in s){if(s[o]>this.logLevel)break;console[o]=()=>{}}}replaceStr(s,o){return s.replace(/\$\w+\$/gi,(function(s){var d=o[s.replace(/\$/g,"")];return d+""=="undefined"?"":d}))}lang(s,o,d){if(o&&!d&&"data"in o&&(d=o,o=null),d=d||{},!this.language[s])return s;let h=this.language[s][this.langType]||this.language[s][this.langTypeDefault];if(!h)return s;if(h=Object.assign({},h),d.data&&(h.value=this.replaceStr(h.value,d.data)),!o)return h.value;switch(!0){case o instanceof Laya.Label:case o instanceof Laya.Text:o.text=h.value;break;case o instanceof Laya.Button:o.label=h.value}}getAssetsI18nPrefix(){return null!==this._assetI18nPrefix||(this._assetI18nPrefix=this.langType!=this.langTypeDefault?"i18n/"+this.langType+"/":""),this._assetI18nPrefix}initStorage(){let s=this,o=Laya.LocalStorage,d=o.setItem;o.setItem=(o,h)=>{if(!o)return;if(void 0===h)return console.error("val is need!");let p=s.prefix;return o=-1==o.indexOf(p)?p+o:o,d(o,h)};let h=o.getItem;o.getItem=o=>{if(!o)return;let d=s.prefix;return o=-1==o.indexOf(d)?d+o:o,h(o)};let p=o.setJSON;o.setJSON=(o,d)=>{if(!o)return;let h=s.prefix;return o=-1==o.indexOf(h)?h+o:o,p(o,d)};let S=o.getJSON;o.getJSON=o=>{if(!o)return;let d=s.prefix;return o=-1==o.indexOf(d)?d+o:o,S(o)};let E=o.removeItem;o.removeItem=o=>{if(!o)return;let d=s.prefix;return o=-1==o.indexOf(d)?d+o:o,E(o)};let A=o.clear;o.clear=()=>A()}loadingStart(){this.time.startLoading=(new Date).getTime()}getPreLoadTime(s=200,o=3e3,d=1e3){if(!this.time.startLoading)return console.error("未调用Lq.loadingStart(),默认预估加载时间为"+d+"ms"),d;let h=(new Date).getTime()-this.time.startLoading,p=o/(this.preNetSpeed=Math.floor(s/h*1e3))*1e3;return p=p<d?d:p,p}loadingOver(s,o){if(s=s||this.timer.loading,!this.timer.cache[s])return console.warn("未找到对应的定时器");this.timer.cache[s].isOver||(this.timer.cache[s].isOver=!0,this.timer.cache[s].overCallback=o)}onLoading(s,o,d){d=d||{};let h=(d=Object.assign({loadSize:200,totalSize:3e3,interVal:16,float:2,preLoadTime:0,timerName:"loading"},d)).interVal,p=d.preLoadTime||this.getPreLoadTime(d.loadSize,d.totalSize),S=!d.preLoadTime,E=99/(p/h),A=0,b=0,w=++this.timer.lastTimerid,update=()=>{let s=this.timer.cache[w]||{},h=99;if(S){let o=!1;!0===s.isOver&&(o=!0,h=100),A+=!0===o?5:E}else A+=E,h=100;A=A>h?h:A;let p=Math.floor(A);d.float&&(p=A.toFixed(d.float)),p!=b&&(b=p,o&&o.call(this,b),100==p&&(Laya.timer.clear(this,update),s.overCallback&&s.overCallback(),this.timer[s.name]=null,delete this.timer.cache[w]))};return Laya.timer.loop(h,this,update),d.timerName&&this.addTimer(d.timerName,w),w}navitoApp(s,o){console.log(s,o)}initNaviAppList(s){this.request({url:"https://x.sogame.com/api/get-jump-to-game",data:{game_id:this.gameid},success:o=>{0==o.code&&(this.naviAppList=o.msg,s&&s(this.naviAppList))}})}showNaviAds(s,o,d){if(!(s instanceof Laya.Node))return void console.error("parent node is not a Node");let h=s.getChildByName("sogameNaviAdBox");if(h&&h.numChildren)for(let s=0;s<h.numChildren;s++)h.getChildAt(s).visible=!1,h.getChildAt(s).active=!1;if(!Array.isArray(o)||0==o.length)return;let p=1;d.attrList&&Array.isArray(d.attrList)&&(p=d.attrList.length),d=d||{};let S={maxNum:p,attrList:[],prefab:U.common.adItem};S=Object.assign(S,d),S.maxNum=Math.min(o.length,S.maxNum);let E={game_id:0,game_icon:null,game_name:null,game_url:"",fail_url:""};o.shuffle(),h||(h=new Laya.Box,h.name="sogameNaviAdBox",h.x=0,h.y=0,s.addChild(h)),this.util.getObjVal(this.view,"ads.naviBox",h,!0);let A=0,b=0;for(;A<S.maxNum;){let s=o[b]||E;if(!s.game_id||!s.game_name||!s.game_icon){b++;continue}let d=!0,p=h.getChildAt(A);p||(d=!1,p=new Laya.View,p.createView(S.prefab),p.name="sogameAdItem"+A);let w=S.attrList[A];if(w)for(let s in w)p[s]=w[s];p.icon.skin=s.game_icon,p.title.text=s.game_name,p.offAll(Laya.Event.CLICK),p.on(Laya.Event.CLICK,this,o=>{o.stopPropagation();let d={url:s.game_url||"",url_fail:s.fail_url||""};this.navitoApp(d.url,d.url_fail)}),p.btnClose.offAll(Laya.Event.CLICK),p.btnClose.on(Laya.Event.CLICK,this,s=>{s.stopPropagation(),s.target.parent.visible=!1}),d?(p.active=!0,p.visible=!0):h.addChild(p),b++,A++}}initBtnSound(s,o,d){if(!(s instanceof Laya.Node))return void console.error("parent node is not a Node");o=Object.assign({x:0,y:0,scaleX:1,scaleY:1},o),d=d||{};let h={prefab:U.common.btnSound};h=Object.assign(h,d);let p=new Laya.View;p.createView(h.prefab),p.name="sogameBtnSound";for(let s in o)p[s]=o[s];p.offAll(Laya.Event.CLICK),p.on(Laya.Event.CLICK,this,s=>{s.stopPropagation(),H.audioStatus=!H.audioStatus,p.soundOn.visible=H.audioStatus,p.soundOff.visible=!H.audioStatus}),s.addChild(p),this.util.getObjVal(this.view,"btn.sound",p)}showView(s,o=!0){console.log("status",o);let d=this.util.getObjVal(this.view,s);console.log(d),d&&!d.destroyed&&(d.visible=d.active=o)}initAnalytics(){this.ga=F,this.ga.GameAnalytics("initialize","07e3acf0a2ccaf3c110757028e54752a","b54797410e3c5320e68873b996d4b13303f15811")}on(s,o,d){d=d||this,Laya.stage.on(s,d,o)}emit(s,o){Laya.stage.event(s,o)}}{constructor(){super(),this._pfName="vigoo",this.appid="balltoball",this.langType="en",this.langTypeDefault="en",this.userInfo={image:"",name:"",openid:"",token:"",uid:""},this.postmsg={},this.emitMessage=(s,o,d)=>{s&&(this.postmsg[s]=d||null,window.parent!==window.self&&parent.window.postMessage({methon:s,data:o},"*"))},this.initVigoo(),window.addEventListener("message",s=>{let o=s.data.methon||"";if(!o||!this.postmsg[o])return;let d=s.data.data||null;this.postmsg[o](d)},!1)}hideLoading(){this.emitMessage("hideLoading")}initVigoo(){this.vigoo=this.vigoo||{},this.vigoo.ShowExcitationVideoAdv=s=>{this.emitMessage("ShowExcitationVideoAdv",null,s)},this.vigoo.ShowScreenVideo=(s,o)=>{this.emitMessage("ShowScreenVideo",{node:s},o)}}};var z;console.log("pfName:",q.pfName),function(s){function checkIsSameDay(s,o){return(s/864e5|0)==(o/864e5|0)}function getFormatStr(s){let o="";return o=s<10?"0"+s:s+"",o}function shareApp(s,o,d,h){if(!k.isWx())return;!function(){let s=checkIsSameDay(Laya.Utils.parseInt(Laya.LocalStorage.getItem("shareTime")),Date.now());R.isFirstShare=!s}();let p,S=P.shareImageData;p=S instanceof Array?S[Math.floor(Math.random()*S.length)]:S;let E=(new Date).getTime();wx.shareAppMessage({title:p.text,imageUrl:p.url}),k.aldSendEvent("分享统计","开始分享");let b=2350;k.getSystemPlatform()==A.IOS&&(b=2750),wx.onShow(()=>{if((new Date).getTime()-E>=b)if(R.isFirstShare||0!=R.lastShareState){let p=Math.random(),S=1;R.isFirstShare=!1,p<=S?(R.lastShareState=!0,5==h?showVideo(s,null,null,()=>{o&&o()}):(onShareWin(s),o&&o())):(R.lastShareState=!1,onShareFail(s,o,d,h))}else R.lastShareState=!0,5==h?showVideo(s,null,null,()=>{o&&o()}):(onShareWin(s),o&&o());else R.lastShareState=!1,onShareFail(s,o,d,h);Laya.LocalStorage.setItem("shareTime",E.toString()),wx.offShow()})}function showVideo(s,o,d,h,p){if(!k.isWx())return;let S;O.videoAd?(S=O.videoAd,O.showVideo()):S=O.init(),S.onError(()=>{shareApp(s,p,d)}),O.onClose(()=>{o&&o()},()=>{d&&d()},()=>{h&&h()})}function onShareWin(s){wx.showToast({title:"分享成功",icon:"",image:"",duration:1500,mask:!1,success:()=>{},fail:()=>{},complete:()=>{}})}function onShareFail(s,o,d,h){k.aldSendEvent("分享统计","分享失败"),wx.showModal({title:"",content:"分享失败，请试试其他的群或好友",showCancel:!0,cancelText:"关闭",cancelColor:"#000000",confirmText:"重新分享",confirmColor:"#3CC51F",success:p=>{p.confirm&&shareApp(s,o,d),p.cancel&&(5==h||4==h?showVideo(s,o,d):(d&&d(),wx.showToast({title:"取消分享",icon:"",image:"",duration:1500,mask:!0,success:()=>{},fail:()=>{},complete:()=>{}})))},fail:()=>{},complete:()=>{}})}function playSound(s,o){}function stopMusic(){if(Laya.Browser.window.qg){var s=Laya.Browser.window.qg.createInnerAudioContext();s.src="sound/bgm.mp3",s.stop()}}s.isFullScreen=function(){Laya.stage.width;let s=Laya.stage.height;return Laya.stage.designWidth,s>Laya.stage.designHeight+1},s.setResize=function(s){s.height=Laya.stage.height},s.checkIsSameDay=checkIsSameDay,s.getRandomIndex=function(s=[]){for(var o=s.length,d=[],h=0,p=0;p<o;p++)d.push(s[p].pro),h+=s[p].pro;var S=0;for(p=0;p<d.length;p++){if(Math.random()*h<d[p]){S=p;break}h-=d[p]}return S},s.getRandomArr=function(s=[]){for(let o=s.length-1;o>=0;o--){let d=Math.floor(Math.random()*(o+1)),h=s[o];s[o]=s[d],s[d]=h}return s},s.getFormatTimeStr=function(s){let o=(s=Math.floor(s/1e3))%60;return getFormatStr(Math.floor(s%3600/60))+":"+getFormatStr(o)},s.shareApp=shareApp,s.showVideo=showVideo,s.shareByMode=function(s,o,d,h,p){if(!k.isWx())return void(o&&o());let S=9;switch(s){case b.BtnShareMode:S=P.btnShareMode}if(console.log("分享类型shareMode",S),1==S)console.log("看视频"),showVideo(s,o,d,h,p);else if(2==S)console.log("分享"),shareApp(s,o,d);else if(3==S)0==R.shareBtnMode?(console.log("轮流看视频"),showVideo(s,o,d,h,p)):(console.log("轮流分享"),shareApp(s,o,d)),R.shareBtnMode++;else if(4==S)shareApp(s,o,d,S);else if(5==S)shareApp(s,o,d,S);else if(6==S){let S=Laya.Utils.parseInt(Laya.LocalStorage.getItem(s));Laya.LocalStorage.setItem(s,Date.now().toString()),checkIsSameDay(S,Date.now())?showVideo(s,o,d,h,p):shareApp(s,o,d)}else 9==S&&(console.log("无规则，直接领奖励"),o&&o())},s.showMessage=function(s){Laya.Scene.open("model/MessageModal.scene",!1,s)},s.checkHasEnoughMoney=function(s,o=!0){return!(Laya.Utils.parseInt(Laya.LocalStorage.getItem("totalMoney"))<s)||(o&&x.showTips(q.lang("金币不足")),!1)},s.updateMoney=function(s){let o=Laya.Utils.parseInt(Laya.LocalStorage.getItem("totalMoney"));o+=s,Laya.LocalStorage.setItem("totalMoney",o.toString()),E.event(w.UpdateMoney),s>0&&playSound("GetCoins.mp3")},s.checkTodayHasSignIn=function(){if(!Laya.LocalStorage.getItem("signIn")){let s=[];Laya.LocalStorage.setItem("signIn",JSON.stringify(s))}let s=JSON.parse(Laya.LocalStorage.getItem("signIn"));if(s.length>0){if(checkIsSameDay(s[s.length-1],Date.now()))return!0;s.length>=7&&Laya.LocalStorage.setItem("signIn",JSON.stringify([]))}return!1},s.playSound=playSound,s.stopSound=function(s){let o="sound/"+s;Laya.SoundManager.stopSound(o)},s.playMusic=function(){if(R.isMusicOn&&Laya.Browser.window.qg){var s=Laya.Browser.window.qg.createInnerAudioContext();s.src="sound/bgm.mp3",s.loop=!0,s.volume=1,s.play()}},s.stopMusic=stopMusic,s.transferColorToRgb=function(s){3===(s="#"===s.charAt(0)?s.substring(1):s).length&&(s=s.replace(/(\w)(\w)(\w)/,"$1$1$2$2$3$3"));for(var o=s.match(/\w{2}/g),d=0;d<o.length;d++)o[d]=parseInt(o[d],16)/255;return o},s.initLocalData=function(){if(0==Laya.Utils.parseInt(Laya.LocalStorage.getItem("gateId"))){let s=N.getInstance().getSystemConfig().initGold;Laya.LocalStorage.setItem("totalMoney",s.toString()),Laya.LocalStorage.setItem("gateId","1")}if(0==Laya.Utils.parseInt(Laya.LocalStorage.getItem("nowCapId"))&&Laya.LocalStorage.setItem("nowCapId","1"),!Laya.LocalStorage.getItem("hasOwnCaps")){let s=[];s.push(1),Laya.LocalStorage.setItem("hasOwnCaps",JSON.stringify(s))}if(0==Laya.Utils.parseInt(Laya.LocalStorage.getItem("nowBallId"))&&Laya.LocalStorage.setItem("nowBallId","1"),!Laya.LocalStorage.getItem("hasOwnBalls")){let s=[];s.push(1,2,3),Laya.LocalStorage.setItem("hasOwnBalls",JSON.stringify(s))}if(!Laya.LocalStorage.getItem("signIn")){let s=[];Laya.LocalStorage.setItem("signIn",JSON.stringify(s))}},s.createRoad=function(s,o){let d=s+".lh";Laya.Sprite3D.load("res/unity/ways/Conventional/"+d,Laya.Handler.create(this,s=>{o&&o(s.clone())}))},s.createScene=function(s,o){let d=N.getInstance().getGateById(s);Laya.Sprite3D.load("res/unity/scenes/Conventional/"+d.scene,Laya.Handler.create(this,s=>{o&&o(s.clone())}))},s.createBall=function(s,o){let d=N.getInstance().getBallById(s);Laya.Sprite3D.load("res/unity/balls/Conventional/"+d.model,Laya.Handler.create(this,s=>{o&&o(s.clone())}))},s.createCap=function(s,o){let d=N.getInstance().getCapById(s);Laya.Sprite3D.load("res/unity/caps/Conventional/"+d.model,Laya.Handler.create(this,s=>{o&&o(s.clone())}))},s.addOfflineEvent=function(){k.isWx()&&wx.onHide(()=>{stopMusic(),wx.onShow(()=>{wx.offShow()})})},s.navigateToMiniProgram=function(s,o,d=null){if(!s||!k.isWx())return;let h=function(s){let o=JSON.parse(Laya.LocalStorage.getItem("skipGameArr"));if(console.log("game",o),0==o.length)return s;for(let d=0;d<o.length;d++){let h=o[d];if(h&&h.appid&&h.skipArr&&s.appid==h.appid){if(0==h.skipArr.length)return s;let o=[];for(let s=0;s<R.gameDataArr.length;s++)h.skipArr.indexOf(R.gameDataArr[d].appid)<0&&o.push(R.gameDataArr[d]);0==o.length&&(o=R.gameDataArr),console.log("randomArr",o);let p=Math.floor(Math.random()*o.length);return o[p]}}return s}(s);console.log("本次点击的小游戏的数据",s,"实际跳转的小游戏数据",h),s.appid&&wx.navigateToMiniProgram({appId:s.appid,path:s.path,extraData:null,envVersion:"",success:d=>{k.aldSendEvent("游戏试玩-总跳转-成功跳转","游戏名",s.title),k.aldSendEvent("游戏试玩-总跳转-成功跳转","游戏名",s.title,!0),k.aldSendEvent(o,"游戏名",s.title)},fail:()=>{console.log("跳转游戏失败"),d()},complete:()=>{}})},s.makeRandomArr=function(s,o){if(o>=s.length)return s;for(var d=s.slice(0),h=[],p=0;p<o;p++){var S=Math.floor(Math.random()*(d.length-1));s=d[S];d.splice(S,1),h.push(s)}return h}}(z||(z={}));class $ extends Laya.Script3D{constructor(){super()}onCollisionEnter(s){"role"==s.other.owner.name&&E.event(w.HitPlane)}}class J extends Laya.Script3D{constructor(){super()}onCollisionEnter(s){"role"!=s.other.owner.name||R.hasGameOver||(console.log("小人落地，碰到终点",this.owner.name),R.endPercent=+this.owner.name.slice(4,this.owner.name.length)/100,E.event(w.HitOverPlane))}}class j extends s.game.GameUI{constructor(){super(),this._loadNum=0,this._roadNums=0,this._isFirstRoll=!0,this._frame=0,this._offset=8,this._maxHeight=5,this._duration=204,this._rotation=138,this._shortTimes=0,z.setResize(this)}onDisable(){this._gameScene&&this._gameScene.destroy(!0),Laya.timer.clearAll(this),E.off(w.HitPlane,this,this.onHitPlane),E.off(w.BumpIntoBall,this,this.onBumpIntoBall),E.off(w.StartGame,this,this.onStartGame),E.off(w.HitBall,this,this.onHitBall),E.off(w.StopMove,this,this.stopMove),E.off(w.HitOverPlane,this,this.onHitOverPlane),E.off(w.HitFinishRoad,this,this.onHitFinishRoad)}onEnable(){this.visible=!1,R.endPercent=0,R.hasGameOver=!1,R.state=!1,R.gateGold=0;let s=Laya.Utils.parseInt(Laya.LocalStorage.getItem("gateId"));this._gateId=s;let o=N.getInstance().getGates();R.gateId=s,s%o.length==0?this._gateConf=N.getInstance().getGateById(o.length):this._gateConf=N.getInstance().getGateById(s%o.length),Laya.Scene3D.load("res/unity/LayaScene_mainScene/Conventional/mainScene.ls",Laya.Handler.create(this,s=>{this._gameScene=s,this.onCloseLoading()}))}onCloseLoading(){this.scene.addChild(this._gameScene),this.onLoadBack()}onLoadBack(){this._camera=this._gameScene.getChildByName("camera"),this._endCamera=this._gameScene.getChildByName("endCamera"),this._role=this._gameScene.getChildByName("role"),this._road=this._gameScene.getChildByName("road"),this._scene=this._gameScene.getChildByName("scene"),this._endCamera.active=!1,this._animator=this._role.getComponent(Laya.Animator),this._animator.play("daiji"),this._gameScene.getChildByName("Plane").addComponent(T),this.createScene()}createScene(){z.createScene(this._gateConf.id,s=>{this._scene.addChild(s),this.createRoad()})}createRoad(){let s=Laya.loader.getRes("res/config/gate/"+this._gateConf.road);s&&(this._roadNums=s.gates.length-1,this.loadRoad())}loadRoad(){let s=Laya.loader.getRes("res/config/gate/"+this._gateConf.road);if(s){if(this._loadNum>=this._roadNums)return void this.loadRoadBack();let o=s.gates[this._loadNum];z.createRoad(o.name,s=>{this._loadNum++,this._road.addChild(s);let d=o.pos;s.transform.localPosition=new Laya.Vector3(d.x,d.y,d.z),this._loadNum>=this._roadNums?this.loadRoadBack():this.loadRoad()})}}loadRoadBack(){this._winEffect=this._road.getChildByName("over").getChildByName("win"),this._winEffect.active=!1,this.initRoads(),this.initOver(),this.updateCap(),this.getEndPos(),this.visible=!0,E.on(w.StartGame,this,this.onStartGame),E.on(w.BumpIntoBall,this,this.onBumpIntoBall),E.on(w.HitPlane,this,this.onHitPlane),E.on(w.HitBall,this,this.onHitBall),E.on(w.StopMove,this,this.stopMove),E.on(w.HitOverPlane,this,this.onHitOverPlane),E.on(w.HitFinishRoad,this,this.onHitFinishRoad),Laya.Scene.open("model/Home.scene",!1,null,Laya.Handler.create(this,()=>{switch(E.event(w.LoadSceneBack),H.playMusic("play","sound/bgm"),q.pfName){case"hago":q.hago.loadComplete()}}))}initRoads(){let s=JSON.parse(Laya.LocalStorage.getItem("hasOwnBalls"));for(let o=0;o<this._road.numChildren;o++){let d=this._road.getChildAt(o);for(let o=0;o<d.numChildren;o++){let h=d.getChildAt(o);if(R.gateId>=84&&(h.name.indexOf("jump")>=0||h.name.indexOf("Guide")>=0)&&(h.active=!1),h.name.indexOf("ballpoint")>=0){let o=s[Math.floor(Math.random()*s.length)];z.createBall(o,s=>{this._gameScene.addChild(s),s.transform.localPosition=h.transform.position,s.addComponent(L)})}else if(h.numChildren>0){if(h.name.indexOf("Platform")>=0)continue;let s=h.getChildAt(1);if(!s)continue;s.addComponent($)}}}}initOver(){let s=this._road.getChildByName("over");for(let o=0;o<s.numChildren;o++){let d=s.getChildAt(o);d.name.indexOf("box")>=0&&d.addComponent(J)}}updateCap(s){let o=this._role.getChildByName("Bip001").getChildByName("Bip001_Pelvis").getChildByName("Bip001_Spine").getChildByName("Bip001_Spine1").getChildByName("Bip001_Neck").getChildByName("Bip001_Head"),d=Laya.Utils.parseInt(Laya.LocalStorage.getItem("nowCapId"));for(let s=0;s<o.numChildren;s++){let d=o.getChildAt(s);if(d&&d.numChildren>0){let s=d.getChildAt(0);s&&s.destroy()}}let h=o.getChildByName("c_"+d);z.createCap(d,o=>{h.addChild(o),s&&s()})}onStartGame(){k.aldStage(1,R.gateId),R.canOpenRoad=!1,Laya.timer.clearAll(this),this.onStartRoll(),Laya.Scene.open("game/GameInfo.scene",!1),Laya.timer.frameLoop(1,this,this.updateProgress)}onClickStage(){this._shortTimes=0,this.vibrateShort(),this.onStartRoll()}onStartRoll(s=!0,o=!1,d=!1){this.stopMove(),this._frame=0;let h=new Laya.Vector3(this._role.transform.position.x,this._role.transform.position.y,this._role.transform.position.z),p=this.getRollEndPos();p=this._isFirstRoll?new Laya.Vector3(0,2,5):new Laya.Vector3(this._role.transform.position.x,p.y,this._role.transform.position.z+this._offset),Laya.timer.once(500,this,()=>{this._role.getComponent(Laya.Rigidbody3D).enabled=!0});let S,E=this._offset;o?(E=2,p=new Laya.Vector3(this._role.transform.position.x,p.y,this._role.transform.position.z+E),S=new Laya.Vector3(h.x,h.y+7,h.z+(p.z-h.z)/2)):S=d?new Laya.Vector3(h.x,h.y+3,h.z+(p.z-h.z)/2):new Laya.Vector3(h.x,h.y+this._maxHeight,h.z+(p.z-h.z)/2);let A=[h,S,p];this._bezierPoints=_.createBezierPoints(A,10),this._bezierPoints.shift(),this._bezierPoints.push(p),s&&this._animator.play("zhuan",0,0);let b=this._camera.transform.localPositionZ,w=this._endCamera.transform.localPositionZ;this._isFirstRoll?(Laya.Tween.to(this._camera.transform,{localPositionZ:b+5},1100),Laya.Tween.to(this._endCamera.transform,{localPositionZ:w+5},1100),this._isFirstRoll=!1):(Laya.Tween.to(this._camera.transform,{localPositionZ:b+E},1100),Laya.Tween.to(this._endCamera.transform,{localPositionZ:w+E},1100)),this.startMoveAction()}startMoveAction(){this._frame>=10||Laya.Tween.to(this._role.transform,{localPositionX:this._bezierPoints[this._frame].x,localPositionY:this._bezierPoints[this._frame].y,localPositionZ:this._bezierPoints[this._frame].z,localRotationEulerX:0,localRotationEulerY:0,localRotationEulerZ:0},100,null,Laya.Handler.create(this,()=>{this._frame++,this.startMoveAction()}))}getRollEndPos(){let s=new Laya.Vector3(0,0,0);s.z=this._role.transform.localRotationZ+this._offset;let o=!1;for(let d=0;d<this._road.numChildren;d++){let h=this._road.getChildAt(d);for(let d=0;d<h.numChildren;d++){let p=h.getChildAt(d);if(p.numChildren>0){let d=p.getChildAt(p.numChildren-2),h=p.getChildAt(p.numChildren-1);if(d.transform.position.z<=s.z&&s.z<=h.transform.position.z){s.y=h.transform.position.y,o=!0;break}}}if(o)break}return s}startMove(){let s=this.getNextRoad();if(!s)return this.onHitFinishRoad(),void Laya.stage.off(Laya.Event.CLICK,this,this.onClickStage);this.stopMove();let o=s.getChildAt(s.numChildren-1),d=s.getChildAt(s.numChildren-2),h=d.transform.position.y-this._role.transform.position.y+1.5;if(h>=.5)return void(h>=1.5?this.onStartRoll(!1,!0):this.onStartRoll(!1,!1,!0));this._animator.play("walk");let p=o.transform.position,S=new Laya.Vector3(this._role.transform.position.x,this._role.transform.position.y-2,this._role.transform.position.z),E=Laya.Vector3.distance(S,p),A=p.z-this._role.transform.position.z,b=E*this._duration,w=E*this._rotation,I=1;if(this._role.transform.position.y-2>d.transform.position.y+.5){I=1/Math.pow(this._role.transform.position.y-2-d.transform.position.y+1,.6)}Laya.Tween.to(this._role.transform,{localPositionZ:p.z},b,null,Laya.Handler.create(this,()=>{this.startMove()})),Laya.Tween.to(this._role.transform,{localPositionY:p.y+2},b*I,null,Laya.Handler.create(this,()=>{this.startMove()}));let _=this._ball.transform.localRotationEulerX;Laya.Tween.to(this._ball.transform,{localPositionZ:p.z,localRotationEulerX:_+w},b),Laya.Tween.to(this._ball.transform,{localPositionY:p.y+1},b*I),Laya.stage.once(Laya.Event.CLICK,this,this.onClickStage);let L=this._camera.transform.localPositionZ;Laya.Tween.to(this._camera.transform,{localPositionZ:L+A},b);let T=this._endCamera.transform.localPositionZ;Laya.Tween.to(this._endCamera.transform,{localPositionZ:T+A},b)}getNextRoad(){for(let s=0;s<this._road.numChildren;s++){let o=this._road.getChildAt(s);if((o.name.indexOf("1")>=0||o.name.indexOf("2")>=0||o.name.indexOf("3")>=0)&&o.name.indexOf("ball")<0)for(let s=0;s<o.numChildren;s++){let d=o.getChildAt(s);if(d.numChildren>0){if(d.getChildAt(d.numChildren-2).transform.position.z>=this._role.transform.position.z)return d}}}return null}stopMove(){Laya.Tween.clearAll(this._role.transform),this._ball&&Laya.Tween.clearAll(this._ball.transform),Laya.Tween.clearAll(this._camera.transform),Laya.Tween.clearAll(this._endCamera.transform)}onBumpIntoBall(s){if(R.hasGameOver)return;this._shortTimes=0,this.vibrateShort(),this.stopMove();let o=s.transform.position;this._ball=s;let d=new Laya.Vector3(this._role.transform.position.x,this._role.transform.position.y,this._role.transform.position.z),h=100*Laya.Vector3.distance(d,o);Laya.Tween.to(this._role.transform,{localPositionX:o.x,localPositionY:o.y+1,localPositionZ:o.z},h,null,Laya.Handler.create(this,()=>{this._role.transform.localRotationEulerX=0,this.startMove()}))}onHitPlane(){if(R.hasGameOver)return;this.stopMove(),this._animator.play("daiji"),R.hasGameOver=!0,console.log("游戏结束"),R.state=!1,k.aldStage(2,R.gateId),this._shortTimes=0,this.vibrateShort(3),Laya.stage.off(Laya.Event.CLICK,this,this.onClickStage);let s=this._role.transform.localPositionZ/this._endPosZ,o=N.getInstance().getSystemConfig().gateGold;R.gateGold=Math.floor(o*s),Laya.Scene.open("game/GameResult.scene",!1)}onHitFinishRoad(){if(R.hasGameOver)return;this.stopMove(),this._role.getComponent(Laya.Rigidbody3D).enabled=!1,this.onStartRoll(!1)}onHitBall(){R.hasGameOver||(this.stopMove(),this.onStartRoll(!1,!1,!0))}onHitOverPlane(){if(R.hasGameOver)return;R.hasGameOver=!0;let s=this._role.getComponent(Laya.Rigidbody3D);s.clearForces(),s.linearFactor=new Laya.Vector3(0,0,0),this._role.transform.localRotationEuler=new Laya.Vector3(0,0,0);let o=Math.floor(2*Math.random()+1);this._animator.play("win_"+o,0,0),this.stopMove(),this._shortTimes=0,this.vibrateShort(3),console.log("游戏结束"),R.state=!0,Laya.stage.off(Laya.Event.CLICK,this,this.onClickStage);let d=N.getInstance().getSystemConfig().gateGold;R.gateGold=Math.floor(d*(1+R.endPercent));let h=Laya.Utils.parseInt(Laya.LocalStorage.getItem("boxProgress"))+20;h>100&&(h=100),Laya.LocalStorage.setItem("boxProgress",h.toString());let p=this._endCamera.transform;Laya.Tween.to(this._camera.transform,{localPositionX:p.localPositionX,localPositionY:p.localPositionY,localPositionZ:p.localPositionZ+2,localRotationEulerX:p.localRotationEulerX,localRotationEulerY:p.localRotationEulerY,localRotationEulerZ:p.localRotationEulerZ},1e3,null,Laya.Handler.create(this,()=>{this.playWinEffect(),k.aldStage(3,R.gateId),Laya.Scene.open("game/GameResult.scene",!1)}))}playWinEffect(){this._winEffect.active=!0,this._winEffect.getChildAt(0).particleSystem.play(),this._winEffect.getChildAt(1).particleSystem.play()}getEndPos(){for(let s=this._road.numChildren-1;s>=0;s--){let o=this._road.getChildAt(s);if((o.name.indexOf("1")>=0||o.name.indexOf("2")>=0||o.name.indexOf("3")>=0)&&o.name.indexOf("ball")<0){let s=o.getChildAt(o.numChildren-1),d=s.getChildAt(s.numChildren-1);this._endPosZ=d.transform.position.z;break}}}updateProgress(){E.event(w.UpdateProgress,this._role.transform.localPositionZ/this._endPosZ)}vibrateShort(s=1){k.isWx()&&wx.vibrateShort({success:()=>{this._shortTimes++,this._shortTimes<s&&this.vibrateShort()},fail:()=>{},complete:()=>{}})}}class W extends s.game.GameInfoUI{constructor(){super(),z.setResize(this)}onDisable(){E.off(w.UpdateProgress,this,this.updateProgress)}onEnable(){this.lblGate.text=R.gateId+"",this.lblNextGate.text=R.gateId+1+"",E.on(w.UpdateProgress,this,this.updateProgress)}updateProgress(s=0){0==s?this.imgBar.visible=!1:(this.imgBar.visible=!0,this.imgBar.scrollRect=new Laya.Rectangle(0,0,this.imgBar.width*s,this.imgBar.height))}}class X extends s.unit.MoneyUI{constructor(){super()}onDisable(){E.off(w.UpdateMoney,this,this.updateMoney)}onEnable(){this.updateMoney(),E.on(w.UpdateMoney,this,this.updateMoney)}updateMoney(){let s=Laya.Utils.parseInt(Laya.LocalStorage.getItem("totalMoney"));this.lblMoney.text=s+""}}const Q="1",Z="2",Y="3",ee="5",te="11",ne={REWARD_REQUEST:`${q.pfName}:${q.gameName}:reward:request`,REWARD_SUCC:`${q.pfName}:${q.gameName}:reward:succ`,REWARD_FAIL:`${q.pfName}:${q.gameName}:reward:fail`,REWARD_SKIP:`${q.pfName}:${q.gameName}:reward:skip`,REWARD_VIGOO_REWARD_FAST:`${q.pfName}:${q.gameName}:reward:vigooRewardFast`,REWARD_REQUEST_FAST:`${q.pfName}:${q.gameName}:reward:requestFast`,REWARD_REQUEST_TIMEOUT:`${q.pfName}:${q.gameName}:reward:requestTimeout`,REWARD_UNDEFINED:`${q.pfName}:${q.gameName}:reward:undefined`,SCREEN_REQUEST:`${q.pfName}:${q.gameName}:interstitial:request`,SCREEN_SUCC:`${q.pfName}:${q.gameName}:interstitial:succ`,SCREEN_FAIL:`${q.pfName}:${q.gameName}:interstitial:fail`,SCREEN_SKIP:`${q.pfName}:${q.gameName}:interstitial:skip`,SCREEN_REQUEST_FAST:`${q.pfName}:${q.gameName}:interstitial:requestFast`,SCREEN_REQUEST_TIMEOUT:`${q.pfName}:${q.gameName}:interstitial:requestTimeout`,SCREEN_UNDEFINED:`${q.pfName}:${q.gameName}:interstitial:undefined`,BANNER_REQUEST:`${q.pfName}:${q.gameName}:banner:request`,BANNER_SUCC:`${q.pfName}:${q.gameName}:banner:succ`};let ae={request:{lastTime:0,nextTime:0,interval:0},screenAd:{lastTime:0,nextTime:0,interval:30,timeout:30},rewardAd:{lastTime:0,nextTime:0,interval:0,timeout:30,skipReward:!1},status:{reward:!1,screen:!1},uploadEvent:{}};switch(q.pfName){case"shareit":ae.rewardAd.interval=30;break;case"vigoo":ae.screenAd.interval=0;break;case"cy":ae.request.interval=0,ae.rewardAd.interval=10,ae.screenAd.interval=90;break;case"admobapp":ae.screenAd.interval=60;break;case"oppo":ae.request.interval=5,ae.rewardAd.interval=10,ae.screenAd.interval=60,ae.rewardAd.skipReward=!1,ae.screenAd.nextTime=(new Date).getTime()+864e5;break;case"hago":ae.rewardAd.interval=5;break;case"jr":ae.request.interval=5,ae.rewardAd.interval=5,ae.screenAd.interval=60,ae.rewardAd.skipReward=!0;break;case"oprpk":ae.rewardAd.interval=5}let ie=[],checkIsCanLoad=s=>{let o=(new Date).getTime();ae[s]=ae[s]||{};let d=ae[s];return!(o<d.nextTime)&&(!(o<ae.request.nextTime)&&(ae.request.lastTime=o,ae.request.nextTime=o+1e3*ae.request.interval,d.lastTime=o,d.nextTime=o+1e3*d.interval,!0))},checkIsTimeout=s=>{let o=(new Date).getTime();ae[s]=ae[s]||{};let d=ae[s];return o>d.lastTime+1e3*d.timeout},resetNextTime=(s,o=0,d=10)=>{ae[s]=ae[s]||{};let h=ae[s];h.interval&&(o=o||h.lastTime,h.nextTime=o+1e3*d)},uploadAdsEvent=(s,o)=>{if(ae.uploadEvent[q.pfName],q.ga.GameAnalytics)if(q.ga.gameanalytics.state.GAState.isEnabled()){for(;ie.length>0;){let s=ie.shift();q.ga.GameAnalytics("addDesignEvent",s)}q.ga.GameAnalytics("addDesignEvent",s)}else ie.push(s)};const se={showRewardedAd(s,o,d,h){h=h||{};if(h=Object.assign({checkStatus:!0},h),console.log("=====showRewardedAd=====",h),h.checkStatus&&ae.status.reward&&!checkIsTimeout("rewardAd"))return x.showTips(q.lang("广告加载中")),void console.warn("等待上一次请求响应，本次点击不生效");ae.status.reward&&uploadAdsEvent(ne.REWARD_REQUEST_TIMEOUT),ae.status.reward=!0,H.muted=!0;let succCb=()=>{s&&s()},failCb=(s=!0)=>{s&&x.showTips(q.lang("广告加载失败")),o&&o()},adsResultCallback=s=>{console.log("=====广告回调结果=====","h5"==q.appType?s:JSON.stringify(s)),setTimeout(()=>{switch(ae.status.reward=!1,H.muted=!1,s.type){case Q:switch(uploadAdsEvent(ne.REWARD_FAIL),q.pfName){case"oprpk":resetNextTime("rewardAd",(new Date).getTime(),0);break;default:resetNextTime("rewardAd")}failCb();break;case Z:resetNextTime("request",(new Date).getTime()),ae.rewardAd.skipReward?(uploadAdsEvent(ne.REWARD_SUCC),succCb()):(uploadAdsEvent(ne.REWARD_SKIP),x.showTips(q.lang("广告跳过")),d&&d());break;case Y:uploadAdsEvent(ne.REWARD_SUCC),resetNextTime("request",(new Date).getTime()),succCb();break;case ee:uploadAdsEvent(ne.REWARD_VIGOO_REWARD_FAST),failCb(!1);break;case te:failCb();break;default:uploadAdsEvent(ne.REWARD_UNDEFINED)}},10)};if(!checkIsCanLoad("rewardAd"))return adsResultCallback({type:te,desc:"adsManager:广告冷却时间未到"});switch(uploadAdsEvent(ne.REWARD_REQUEST),q.pfName){case"vigoo":q.vigoo.ShowExcitationVideoAdv(adsResultCallback);break;case"oppo":q.oppo.ShowExcitationVideoAdv(adsResultCallback);break;case"shareit":q.shareit.ShowExcitationVideoAdv(adsResultCallback);break;case"admobapp":var p=h.scene||"",S=h.subPortal||"";q.admobapp.showRewardAdResult=adsResultCallback,q.admobapp.callJsbMethod("showRewardAds",{scene:p,subPortal:S});break;case"hwapp":if(!window.jsb)return;q.hw.showRewardAdResult=adsResultCallback,q.hw.callJsbMethod("showRewardAds");break;case"stapp":q.stapp.showRewardAdResult=adsResultCallback;p=h.scene||"",S=h.subPortal||"";q.stapp.callJsbMethod("showRewardAds",{scene:p,subPortal:S});break;case"miapp":succCb=()=>{q.miapp.uploadEvent("adSuccReward"),s&&s()},q.miapp.uploadEvent("adShowReward"),q.miapp.showRewardAdResult=adsResultCallback;p=h.scene||"",S=h.subPortal||"";q.miapp.callJsbMethod("showRewardAds",{scene:p,subPortal:S});break;case"hago":q.hago.showRewardedAd(adsResultCallback);break;case"cy":q.cy.showAd(3,adsResultCallback);break;case"stcpk":q.stcpk.ShowExcitationVideoAdv(adsResultCallback);break;case"tapapp":p=h.scene||"";q.tapapp.showRewardAdResult=adsResultCallback,q.tapapp.callJsbMethod("showRewardAds",{scene:p});break;case"jr":q.jr.showRewardedAd(adsResultCallback);break;case"oprpk":q.oprpk.showRewardedAd(adsResultCallback);break;default:var E={type:Y},A=3e3,b=Math.random();b<.2?(E.type=Z,A=0):b>=.2&&b<.3?(E.type=Q,A=0):x.showTips(q.lang("加载激励成功回调",{data:{num:A/1e3}})),setTimeout(()=>{adsResultCallback(E)},A)}},showScreenAd(s,o,d,h){s=s||{};if(s=Object.assign({checkStatus:!0},s),console.log("=====showScreenAd=====",s),s.checkStatus&&ae.status.screen&&!checkIsTimeout("screenAd"))return console.warn("等待上一次请求响应，本次点击不生效");ae.status.screen&&uploadAdsEvent(ne.SCREEN_REQUEST_TIMEOUT),ae.status.screen=!0,H.muted=!0;let succCb=()=>{o&&o()},failCb=()=>{d&&d()},adsResultCallback=s=>{console.log("=====广告回调结果=====","h5"==q.appType?s:JSON.stringify(s)),setTimeout(()=>{switch(ae.status.screen=!1,H.muted=!1,s.type){case Q:uploadAdsEvent(ne.SCREEN_FAIL),resetNextTime("screenAd"),failCb();break;case Z:uploadAdsEvent(ne.SCREEN_SKIP),resetNextTime("request",(new Date).getTime()),h&&h();break;case Y:uploadAdsEvent(ne.SCREEN_SUCC),resetNextTime("request",(new Date).getTime()),succCb();break;case te:failCb();break;default:uploadAdsEvent(ne.SCREEN_UNDEFINED)}},10)};if(!checkIsCanLoad("screenAd"))return adsResultCallback({type:te,desc:"adsManager:广告冷却时间未到"});uploadAdsEvent(ne.SCREEN_REQUEST);let p=s.node||"";switch(q.pfName){case"vigoo":q.vigoo.ShowScreenVideo(p,adsResultCallback);break;case"oppo":q.oppo.ShowScreenVideo(p,adsResultCallback);break;case"shareit":q.shareit.ShowScreenVideo(p,adsResultCallback);break;case"admobapp":q.admobapp.showScreenAdResult=adsResultCallback;var S=s.scene||"";q.admobapp.callJsbMethod("showScreenAds",{scene:S});break;case"stcpk":q.stcpk.ShowScreenVideo(adsResultCallback);break;case"stapp":q.stapp.showScreenAdResult=adsResultCallback;S=s.scene||"";q.stapp.callJsbMethod("showScreenAds",{scene:S});break;case"miapp":succCb=()=>{q.miapp.uploadEvent("adSuccScreen"),o&&o()},q.miapp.uploadEvent("adShowScreen"),q.miapp.showScreenAdResult=adsResultCallback;S=s.scene||"";q.miapp.callJsbMethod("showScreenAds",{scene:S});break;case"hago":case"oprpk":adsResultCallback({type:Q,desc:"暂未开放"});break;case"cy":q.cy.showAd(2,adsResultCallback);break;case"tapapp":q.tapapp.showScreenAdResult=adsResultCallback;S=s.scene||"";q.tapapp.callJsbMethod("showScreenAds",{scene:S});break;case"jr":q.jr.showScreenAd(p,adsResultCallback);break;default:var E={type:Y},A=3e3,b=Math.random();b<.2?(E.type=Z,A=0):b>=.2&&b<.3?(E.type=Q,A=0):x.showTips(q.lang("加载插屏成功回调",{data:{num:A/1e3}})),setTimeout(()=>{adsResultCallback(E)},A)}},showBannerAd(s){s=s||{},console.log("=====showBannerAd=====",s);switch(q.pfName){case"admobapp":case"tapapp":var o=s.position||"";q[q.pfName].callJsbMethod("showBanner",{position:o});break;case"stapp":if(!(o=s.position||""))return;q.stapp.callJsbMethod("showBanner",{position:o});break;case"miapp":o=s.position||"";q.miapp.callJsbMethod("showBanner",{position:o});break;case"oppo":case"jr":break;case"oprpk":q.oprpk.showBannerAd()}},hiddenBannerAd(){switch(console.log("=====hiddenBannerAd=====",s),q.pfName){case"admobapp":case"stapp":case"miapp":case"tapapp":var s={scene:""};q[q.pfName].callJsbMethod("hiddenBanner",s);break;case"oppo":case"jr":break;case"oprpk":q.oprpk.hiddenBannerAd()}},uploadRewardScene(s,...o){if(s&&0!=o.length)switch(q.pfName){case"stapp":q.stapp.callJsbMethod("showRewardedBadgeView",{scene:s,subPortal:o})}}};setTimeout(()=>{q.on("showAds",s=>{let o={reward:"showRewardedAd",screen:"showScreenAd"}[s.type];o&&se[o]()},void 0)},0);class oe extends s.game.GameResultUI{constructor(){super(),this._isThree=!1,this._isWin=!1,z.setResize(this)}onDisable(){Laya.timer.clearAll(this)}onEnable(){switch(Lq.pfName){case"cy":se.showScreenAd()}let s=Lq.getAssetsI18nPrefix(),o=Laya.Utils.parseInt(Laya.LocalStorage.getItem("boxProgress"));if(R.state){this._isWin=!0,this.imgTitle.skin=o<100?s+"ui/icon_font_gongxiguoguan.png":s+"ui/icon_font_bukesiyi.png";let d=N.getInstance().getNextRoad(R.gateId);Laya.LocalStorage.setItem("gateId",(R.gateId+1).toString()),d&&d.gate-1==R.gateId&&(R.canOpenRoad=!0)}else this.imgTitle.skin=s+"ui/icon_font_zaijiezaili.png";o<100?(this.btnTreasure.visible=!1,this.btnThree.visible=this.btnClose.visible=!0):(this.btnTreasure.visible=!0,this.btnThree.visible=this.btnClose.visible=!1),this.lblMoney.text=R.gateGold+"",this.imgProgress.scrollRect=new Laya.Rectangle(0,0,this.imgProgress.width*o/100,this.imgProgress.height),this.lblProgress.text=o+"%",this.btnThree.on(Laya.Event.CLICK,this,this.onClickThree),this.btnTreasure.on(Laya.Event.CLICK,this,this.onClickTreasure),this.btnClose.on(Laya.Event.MOUSE_UP,this,this.onClickExit)}onClickThree(){se.showRewardedAd(()=>{this._isThree=!0,this.onGetReward(!0)})}onGetReward(s=!1){s?z.updateMoney(3*R.gateGold):z.updateMoney(R.gateGold),this.onBackToMain()}onClickExit(){switch(this.onGetReward(),Lq.pfName){case"vigoo":let s=this._isWin?"成功":"失败";se.showScreenAd({node:s});break;case"cy":se.showScreenAd()}}onBackToMain(){this.close(),Laya.Scene.closeAll(),Laya.Scene.open("game/Game.scene",!0)}onClickTreasure(){this.close(),Laya.Scene.closeAll(),Laya.LocalStorage.setItem("boxProgress","0"),this.checkOpenTreasure()}checkOpenTreasure(){let s=JSON.parse(Laya.LocalStorage.getItem("hasOwnBalls")),o=[],d=N.getInstance().getBalls();for(let h=1;h<d.length;h++)s.indexOf(d[h].id)>=0||o.push(d[h]);let h=-1;o.length>0&&(h=o[Math.floor(Math.random()*o.length)].id),console.log("奖励宝箱宝箱id",h),Laya.Scene.open("model/Treasure.scene",!1,{capId:h,callBack:()=>{0==P.auditState?Laya.Scene.open("advert/FullScreen.scene",!1,()=>{Laya.Scene.open("game/Game.scene",!0)}):Laya.Scene.open("game/Game.scene",!0)}})}}class re extends Laya.Script{constructor(){super()}onAwake(){this.initI18n()}initI18n(){let s=q.getAssetsI18nPrefix();s&&Object.getOwnPropertyNames(this).forEach(o=>{switch(!0){case this[o]instanceof Laya.Image:case this[o]instanceof Laya.Button:if(!this[o].skin)return;this[o].skin=s+this[o].skin}})}}class le extends Laya.Button{constructor(s=null,o=""){super(s,o),this.scaleTime=100}onDisable(){Laya.Tween.clearAll(this)}onEnable(){this._scaleX=this.scaleX,this._scaleY=this.scaleY,this.on(Laya.Event.CLICK,this,this.onBtnClick),this.on(Laya.Event.MOUSE_DOWN,this,this.scaleSmall),this.on(Laya.Event.MOUSE_UP,this,this.scaleBig),this.on(Laya.Event.MOUSE_OUT,this,this.scaleBig)}onBtnClick(){}scaleSmall(){this.parent&&(Laya.Tween.clearAll(this),Laya.Tween.to(this,{scaleX:.8*this._scaleX,scaleY:.8*this._scaleY},this.scaleTime))}scaleBig(){this.parent&&(Laya.Tween.clearAll(this),Laya.Tween.to(this,{scaleX:this._scaleX,scaleY:this._scaleY},this.scaleTime))}}class de extends s.model.HomeUI{constructor(){super(),z.setResize(this)}onDisable(){this.ani1.stop(),this.ani2.stop()}onEnable(){this.lblGate.text=R.gateId+"",this.lblNextGate.text=R.gateId+1+"",this.initRoad(),this.checkOpenRoad(),q.pfName,this.soundOn.visible=H.audioStatus,this.soundOff.visible=!H.audioStatus,this.btnStart.on(Laya.Event.CLICK,this,this.onClickStart),this.btnSkin.on(Laya.Event.CLICK,this,this.onClickSkin),this.btnSound.on(Laya.Event.CLICK,this,this.onClickSound)}onClickStart(){switch(this.close(),E.event(w.StartGame),q.pfName){case"oppo":q.oppo.uploadEvent("clickGame");break;case"miapp":q.miapp.uploadEvent("gameClick")}}onClickSkin(){this.close(),Laya.Scene.open("model/Show.scene",!1)}onClickSound(){H.audioStatus=!H.audioStatus,this.soundOn.visible=H.audioStatus,this.soundOff.visible=!H.audioStatus,R.isMusicOn=H.audioStatus}onClickShortCut(){q.pfName}initRoad(){let s=N.getInstance().getLastRoad(R.gateId),o=N.getInstance().getNextRoad(R.gateId);if(o){let d=1;s&&(d=s.gate),this.boxProgress.visible=!0;let h=(R.gateId-d)/(o.gate-d);this.lblProgress.text=Math.floor(100*h)+"%",this.imgProgress.scrollRect=new Laya.Rectangle(0,0,this.imgProgress.width*h,this.imgProgress.height),this.icon.skin=o.icon,this.unlock_tips.text=q.lang("解锁地形提示",null,{data:{num:o.gate-R.gateId}})}else this.boxProgress.visible=!1}checkOpenRoad(){let s=N.getInstance().getNextRoad(R.gateId);R.canOpenRoad&&s&&Laya.Scene.open("model/Unlock.scene",!1)}}class ce extends Laya.Script{constructor(){super()}onAwake(){this.initI18n()}initI18n(){let s=q.getAssetsI18nPrefix();s&&Object.getOwnPropertyNames(this).forEach(o=>{switch(!0){case this[o]instanceof Laya.Image:case this[o]instanceof Laya.Button:if(!this[o].skin)return;this[o].skin=s+this[o].skin}})}}class ue extends s.model.LoadingUI{constructor(){super(),z.setResize(this)}onAwake(){q.hideLoading();let s=q.getPreLoadTime();this.prog_loading.value=.01,Laya.Tween.to(this.prog_loading,{value:1},s,null),this.loadSubpackage()}onDisable(){E.off(w.LoadSceneBack,this,this.loadingOver)}onEnable(){E.once(w.LoadSceneBack,this,this.loadingOver)}loadSubpackage(){switch(q.pfName){case"wx":wx.loadSubpackage({name:"res",success:s=>{this.loadConfig(),this.loadResource()},fail:function(s){}});break;default:this.loadConfig()}}loadConfig(){Laya.loader.load(["res/config/config.json","res/config/gate/road01.json","res/config/gate/road02.json","res/config/gate/road03.json","res/config/gate/road04.json","res/config/gate/road05.json","res/config/gate/road06.json","res/config/gate/road07.json","res/config/gate/road08.json","res/config/gate/road09.json","res/config/gate/road10.json","res/config/gate/road11.json","res/config/gate/road12.json","res/config/gate/road13.json","res/config/gate/road14.json","res/config/gate/road15.json","res/config/gate/road16.json","res/config/gate/road17.json","res/config/gate/road18.json","res/config/gate/road19.json","res/config/gate/road20.json","res/config/gate/road21.json","res/config/gate/road22.json","res/config/gate/road23.json","res/config/gate/road24.json"],Laya.Handler.create(this,()=>{this.loadResource()}))}loadResource(){let s=[{url:"res/atlas/ui.json",type:Laya.Loader.ATLAS},{url:"sound/bgm.mp3",type:Laya.Loader.SOUND}];Laya.loader.load(s,Laya.Handler.create(this,()=>{this.preloadResource()}))}preloadResource(){console.log("预加载皮肤资源以及动画",Date.now());let s=[{url:"res/atlas/balls.json",type:Laya.Loader.ATLAS},{url:"res/atlas/caps.json",type:Laya.Loader.ATLAS},{url:"res/atlas/roads.json",type:Laya.Loader.ATLAS}];Laya.loader.load(s,Laya.Handler.create(this,()=>{console.log("预加载皮肤资源以及动画完成 ",Date.now()),this.onConfigLoaded()}))}onConfigLoaded(){z.initLocalData(),k.initSDK(),window.ald&&(window.ald.default.Init(),console.log("阿拉丁初始化完成")),Laya.Scene.open("game/Game.scene",!1),console.log("进入主界面")}loadingOver(){Laya.Tween.to(this.prog_loading,{value:1},200,null,Laya.Handler.create(this,()=>{Laya.Tween.to(this,{alpha:.2},300,null,Laya.Handler.create(this,()=>{this.close()}))}),0,!0)}}class he extends Laya.Script{constructor(){super()}onAwake(){this.initI18n()}initI18n(){let s=q.getAssetsI18nPrefix();s&&Object.getOwnPropertyNames(this).forEach(o=>{switch(!0){case this[o]instanceof Laya.Image:case this[o]instanceof Laya.Button:if(!this[o].skin)return;this[o].skin=s+this[o].skin}})}}class ge extends s.model.MessageModalUI{constructor(){super(),this.isPopupCenter=!1,this.isShowEffect=!1}onDisable(){this._timeLine&&this._timeLine.destroy()}onOpened(s){this.showMessage(s)}showMessage(s){this.lblMsg.text=s,this._timeLine=new Laya.TimeLine,this._timeLine.to(this.box,{centerY:-70},300).to(this.box,{alpha:0},200,null,100),this._timeLine.once(Laya.Event.COMPLETE,this,()=>{this._timeLine.destroy(),this._timeLine=null,this.close()}),this._timeLine.play()}}class me extends s.model.nativeAdDialogUI{constructor(){super(),this.height=Laya.stage.height,this.y=0}onOpened(){this.initNativeAd(),this.touchArea.on(Laya.Event.CLICK,this,this.onTouchAd),this.btn_install.on(Laya.Event.CLICK,this,this.onTouchAd),this.btn_close.on(Laya.Event.CLICK,this,this.onTouchClose)}initNativeAd(){Laya.Browser.window.qg&&G.nativieAdList&&(this.nativeBg.skin=G.nativieAdList.imgUrlList[0],this.nativeDesc.text=G.nativieAdList.desc,this.nativeTitle.text=G.nativieAdList.title,G.nativeAd.reportAdShow({adId:G.nativieAdList.adId}))}onTouchAd(){G.nativieAdList&&G.nativeAd.reportAdClick({adId:G.nativieAdList.adId}),this.onCloseAd()}onTouchClose(){let s=Math.random(),o=Laya.LocalStorage.getItem("errorCount");if(parseInt(o)>=P.adErrorMaxCount||s>=P.adErrorRate)this.onCloseAd();else if(s<P.adErrorRate&&G.nativieAdList){let s=parseInt(o);s+=1,Laya.LocalStorage.setItem("errorCount",s.toString()),this.onTouchAd()}else this.onCloseAd()}onCloseAd(){this.close(),G.nativieAdList&&G.createNativeAd()}}class ve extends s.model.PopupWindowUI{constructor(){super(),this._isCloseConfirm=!1}onOpened(s){this._callBack=s.callBack,null==s.times&&(s.times=3),null==s.isCloseConfirm&&(this._isCloseConfirm=!1),this._isCloseConfirm?(this.lblTitle.text=Lq.lang("提示"),this.btnConfirm.label=Lq.lang("确认"),this.lblDesc.text=Lq.lang("免费宝箱")):(this.lblTitle.text=Lq.lang("提示"),this.btnConfirm.label=Lq.lang("看视频"),this.lblDesc.text=Lq.lang("看视频加抽奖",null,{data:{num:s.times}})),this.btnCancel.on(Laya.Event.CLICK,this,this.onClickCancel),this.btnConfirm.on(Laya.Event.CLICK,this,this.onClickConfitm)}onClickCancel(){this.close()}onClickConfitm(){if(this._isCloseConfirm)this.close(),this._callBack&&this._callBack();else{let succ=()=>{this.close(),this._callBack&&this._callBack()};se.showRewardedAd(succ)}}}class fe extends Laya.Script{constructor(){super()}onAwake(){q.lang("取消",this.btn_cancel),this.initI18n()}initI18n(){let s=q.getAssetsI18nPrefix();s&&Object.getOwnPropertyNames(this).forEach(o=>{switch(!0){case this[o]instanceof Laya.Image:case this[o]instanceof Laya.Button:if(!this[o].skin)return;this[o].skin=s+this[o].skin}})}}class pe extends s.model.ShowUI{constructor(){super(),z.setResize(this)}onDisable(){this._ball&&this._ball.destroy(),console.log("销毁展示界面"),E.off(w.ChangeSkinTab,this,this.onChangeTab),E.off(w.ChangeCapSkin,this,this.updateCapSkin),E.off(w.ChangeBallSkin,this,this.updateBall)}onOpened(){Laya.Scene3D.load("res/unity/LayaScene_show/Conventional/show.ls",Laya.Handler.create(this,s=>{s&&(this._showScene=s),this.onLoadComplete()})),E.on(w.ChangeSkinTab,this,this.onChangeTab),E.on(w.ChangeCapSkin,this,this.updateCapSkin),E.on(w.ChangeBallSkin,this,this.updateBall)}onLoadComplete(){this.scene.addChild(this._showScene),this._showScene.getChildByName("Main Camera").clearFlag=2,this._role=this._showScene.getChildByName("role"),this.updateCapSkin(),Laya.Scene.open("model/Skin.scene",!1)}updateCapSkin(){this._ball&&this._ball.destroy(),this._role.active=!0,this._role.getComponent(Laya.Animator).play("daiji");let s=this._role.getChildByName("Bip001").getChildByName("Bip001_Pelvis").getChildByName("Bip001_Spine").getChildByName("Bip001_Spine1").getChildByName("Bip001_Neck").getChildByName("Bip001_Head"),o=Laya.Utils.parseInt(Laya.LocalStorage.getItem("nowCapId"));for(let o=0;o<s.numChildren;o++){let d=s.getChildAt(o);if(d&&d.numChildren>0){let s=d.getChildAt(0);s&&s.destroy()}}let d=s.getChildByName("c_"+o);z.createCap(o,s=>{d.addChild(s)})}updateBall(){this._ball&&this._ball.destroy(),this._role.active=!1;let s=Laya.Utils.parseInt(Laya.LocalStorage.getItem("nowBallId"));z.createBall(s,s=>{this._ball=s,this._ball.getComponent(Laya.Rigidbody3D).enabled=!1,this._showScene.addChild(this._ball),s.transform.localPositionY=4})}onChangeTab(s){0==s?this.updateCapSkin():this.updateBall()}}class ye extends s.unit.SkinItemUI{constructor(){super()}setInfo(s){if(this.imgUnknow.visible=!1,s){if(0==s.skinBtnIndex){let o=N.getInstance().getCapById(s.id);this.icon.skin=o.icon}else{let o=N.getInstance().getBallById(s.id);o&&(this.icon.skin=o.icon)}s.hasOwn?(this.icon.visible=!0,this.imgUnknow.visible=!1):(this.icon.visible=!1,this.imgUnknow.visible=!0)}this.setSelect()}setSelect(s=!1){this.imgSelect.visible=s}setHasOwn(s,o=0){let d=new Laya.TimeLine;d.to(this.imgSelect,{alpha:0},200).to(this.imgSelect,{alpha:1},100).to(this.imgSelect,{alpha:0},200).to(this.imgSelect,{alpha:1},100).to(this.imgSelect,{alpha:0},200).to(this.imgSelect,{alpha:1},100),d.once(Laya.Event.COMPLETE,this,()=>{if(this.dataSource.hasOwn=!0,d.destroy(),this.imgUnknow.visible=!1,this.icon.visible=!0,0==o){let s=JSON.parse(Laya.LocalStorage.getItem("hasOwnCaps"));s.indexOf(this.dataSource.id)<0&&s.push(this.dataSource.id),Laya.LocalStorage.setItem("hasOwnCaps",JSON.stringify(s)),E.event(w.ChangeCapSkin)}else{let s=JSON.parse(Laya.LocalStorage.getItem("hasOwnBalls"));s.indexOf(this.dataSource.id)<0&&s.push(this.dataSource.id),Laya.LocalStorage.setItem("hasOwnBalls",JSON.stringify(s)),E.event(w.ChangeBallSkin)}}),d.play()}}class Se extends s.model.SkinUI{constructor(){super(),this._btnIndex=0,this._lastBtnIndex=0,this._isRandom=!1,this._rewardIndex=0,this._cellIndex=0,this._times=3,this._randomCells=[],this._pageIndex=1,z.setResize(this)}onDisable(){Laya.Scene.close("model/Show.scene"),Laya.timer.clearAll(this)}onEnable(){let s=N.getInstance().getSystemConfig();this.lblMoney.text=s.skinCostGold+"",this.lblAddMoney.text="+"+s.videoAddGold,this.initList(),this.setPageState(),this.btnHome.on(Laya.Event.CLICK,this,this.onClickMain),this.btnRandom.on(Laya.Event.CLICK,this,this.onClickRandom),this.btnVideo.on(Laya.Event.CLICK,this,this.onClickVideo);for(let s=0;s<this.boxGroups.numChildren;s++){let o=this.boxGroups.getChildAt(s);o.selected=0==s,o.on(Laya.Event.CLICK,this,this.onClick,[o])}this.list.scrollBar.on(Laya.Event.CHANGE,this,this.onScrollChange),this.list.scrollBar.on(Laya.Event.END,this,this.onScrollEnd)}onClickMain(){this.close(),Laya.Scene.open("game/Game.scene",!0)}onClickVideo(){let s=N.getInstance().getSystemConfig().videoAddGold;se.showRewardedAd(()=>{z.updateMoney(s),x.showTips(Lq.lang("加金币",{data:{num:s}}))})}initList(){let s=[],o=[],d=N.getInstance(),h=[],p="";0==this._btnIndex?(s=d.getCaps(),h=JSON.parse(Laya.LocalStorage.getItem("hasOwnCaps")),p="nowCapId"):(s=d.getBalls(),h=JSON.parse(Laya.LocalStorage.getItem("hasOwnBalls")),p="nowBallId");let S=Laya.Utils.parseInt(Laya.LocalStorage.getItem(p));if(h.length>0&&!h.inArray(S)){S=h.rand(1)[0],Laya.LocalStorage.setItem(p,String(S))}for(let d=0;d<s.length;d++){let p=!1;h.indexOf(s[d].id)>=0&&(p=!0);let S={id:s[d].id,skinBtnIndex:this._btnIndex,hasOwn:p};o.push(S)}if(this.list.renderHandler=new Laya.Handler(this,this.onRenderList),o.length>6){let s=o.splice(0,6);for(;o.length<6;)o.push(null);let d=[s,o];this.list.array=d,this.boxPages.visible=!0}else{let s=[o];this.list.array=s,this.boxPages.visible=!1}}onRenderList(s){s.renderHandler=new Laya.Handler(this,this.onRenderHandler),s.mouseHandler=new Laya.Handler(this,(s,o)=>{this.onMouseHandler(s,o)}),s.array=s.dataSource}onRenderHandler(s){s.setInfo(s.dataSource);let o=0;o=0==this._btnIndex?Laya.Utils.parseInt(Laya.LocalStorage.getItem("nowCapId")):Laya.Utils.parseInt(Laya.LocalStorage.getItem("nowBallId")),s.dataSource&&s.dataSource.id==o&&s.setSelect(!0)}onMouseHandler(s,o){if(s.type==Laya.Event.CLICK){let d=this.list.cells[0],h=d.array[o];if(!h.hasOwn)return void x.showTips(Lq.lang("暂未开放"));for(let s=0;s<d.cells.length;s++){let o=d.cells[s];o instanceof ye&&o.setSelect(!1)}s.target instanceof ye&&s.target.setSelect(!0),0==this._btnIndex?(Laya.LocalStorage.setItem("nowCapId",h.id.toString()),E.event(w.ChangeCapSkin)):(Laya.LocalStorage.setItem("nowBallId",h.id.toString()),E.event(w.ChangeBallSkin))}}onClickRandom(){if(this._isRandom)return;this._isRandom=!0,this._cellIndex=0,this._randomCells=[];let s=this.list.cells[0];for(let o=0;o<s.cells.length;o++){let d=s.cells[o],h=d.dataSource;h&&(h.hasOwn||this._randomCells.push(d))}let o=N.getInstance().getSystemConfig();if(this._randomCells.length>0){let s=o.skinCostGold;if(!z.checkHasEnoughMoney(s,!0))return void(this._isRandom=!1);z.updateMoney(-s),this._rewardIndex=Math.floor(Math.random()*this._randomCells.length),Laya.timer.loop(100,this,this.onRandom)}else this._isRandom=!1,x.showTips(Lq.lang("皮肤全解锁"))}onRandom(){let s=this.list.cells[0];if(this._cellIndex==this._randomCells.length*this._times+this._rewardIndex){for(let o=0;o<s.cells.length;o++){let d=s.cells[o];d instanceof ye&&d.setSelect(!1)}Laya.timer.clear(this,this.onRandom),console.log("抽中了");let o=this._randomCells[this._rewardIndex],d=o.dataSource;o instanceof ye&&o.setHasOwn(!0,this._btnIndex),0==this._btnIndex?Laya.LocalStorage.setItem("nowCapId",d.id.toString()):Laya.LocalStorage.setItem("nowBallId",d.id.toString()),setTimeout(()=>{this._isRandom=!1},1e3)}if(this._cellIndex>0){let s=this._randomCells[(this._cellIndex-1)%this._randomCells.length];s instanceof ye&&s.setSelect(!1)}let o=this._randomCells[this._cellIndex%this._randomCells.length];o instanceof ye&&o.setSelect(!0),this._cellIndex++}onClick(s){for(let o=0;o<this.boxGroups.numChildren;o++){let d=this.boxGroups.getChildAt(o);s==d?(d.selected=!0,this._btnIndex=o,this.initList()):d.selected=!1}this.onChangeTab()}onChangeTab(){this._lastBtnIndex!=this._btnIndex&&(this._lastBtnIndex=this._btnIndex,this.initList(),this._pageIndex=1,this.list.scrollBar.value=0,E.event(w.ChangeSkinTab,this._btnIndex),this.setPageState())}onScrollChange(){this.list.scrollBar.value<=(this._pageIndex-1.5)*(this.list.width+this.list.spaceX)?(this._pageIndex--,this.setPageState()):this.list.scrollBar.value>=(this._pageIndex-.5)*(this.list.width+this.list.spaceX)&&(this._pageIndex++,this.setPageState())}setPageState(){for(let s=0;s<2;s++){let o=this.boxPages.getChildAt(s);this._pageIndex==s+1?o.selected=!0:o.selected=!1}}onScrollEnd(){console.log("onScrollEnd");let s=Math.abs(this.list.scrollBar.value-(this._pageIndex-1)*(this.list.width+this.list.spaceX))/((this.list.width+this.list.spaceX)/2)*200;Laya.Tween.to(this.list.scrollBar,{value:(this._pageIndex-1)*(this.list.width+this.list.spaceX)},s,Laya.Ease.sineInOut)}}class Ee extends Laya.Script{constructor(){super()}onAwake(){this.initI18n()}initI18n(){let s=q.getAssetsI18nPrefix();s&&Object.getOwnPropertyNames(this).forEach(o=>{switch(!0){case this[o]instanceof Laya.Image:case this[o]instanceof Laya.Button:if(!this[o].skin)return;this[o].skin=s+this[o].skin}})}}class Ae extends s.unit.TreasureItemUI{constructor(){super()}onDisable(){Laya.timer.clearAll(this)}onEnable(){this.boxGold.visible=this.imgBest.visible=this.imgVideo.visible=!1}setVideo(){this.imgVideo.visible=!0}setInfo(s){let o=N.getInstance().getTreasureById(s.id).reward.split("_");if(this._type=+o[0],0==+o[0])this.boxGold.visible=!0,this.icon.visible=!1,this.lblGold.text=o[1];else{this.boxGold.visible=!1,this.icon.visible=!0;let o=N.getInstance().getBallById(s.ballId);this.icon.skin=o.icon}this.setStatus(s.status)}setStatus(s){s?(0==this._type?(this.boxGold.visible=!0,this.icon.visible=!1):(this.boxGold.visible=!1,this.icon.visible=!0),this.imgVideo.visible=!1,this.imgBox.visible=!1):(this.icon.visible=this.boxGold.visible=this.imgBest.visible=!1,this.imgBox.visible=!0)}playOpenBoxAction(){this.setStatus(!0)}}class be extends s.model.TreasureUI{constructor(){super(),this._keysNum=3,this._isFirstTreasure=!1,this._touchFlag=!1,this._rewardKeyTimes=0,this._getSkin=!1,z.setResize(this)}onEnable(){}onDisable(){Laya.timer.clearAll(this),this.ani1&&this.ani1.stop(),this._callBack&&this._callBack()}onOpened(s){this._callBack=s.callBack;let o=Laya.Utils.parseInt(Laya.LocalStorage.getItem("treasureTimes"));0==o&&(this._isFirstTreasure=!0),Laya.LocalStorage.setItem("treasureTimes",(o+1).toString()),this._getSkin=!1,this.updateTreasureTimes(),this.initList(s.capId),this.btnVideo.on(Laya.Event.CLICK,this,this.onClickVideo),this.btnHome.once(Laya.Event.CLICK,this,this.close)}onClickVideo(){se.showRewardedAd(()=>{this._rewardKeyTimes++,this._keysNum=3,this.updateTreasureTimes()})}updateTreasureTimes(){this.imgTips.visible=!1,this.btnVideo.visible=!1,this._keysNum>0?this.imgTips.visible=!0:0==this._rewardKeyTimes&&(this.btnVideo.visible=!0)}initList(s=-1){this.initBestInfo(s);let o=N.getInstance().getTreasures(),d=Object.assign([],o),h=-1==s?8:9;d.splice(h,1),d.shuffle();let p=[],S=[];for(let o=0,h=d.length;o<h;o++)p.push(d[o].id),S.push({id:d[o].id,ballId:s,status:!1});this.videoIndex=p.rand(3),this.list.renderHandler=new Laya.Handler(this,this.onRenderHandler),this.list.mouseHandler=new Laya.Handler(this,(s,o)=>{this.onMouseHandler(s,o)}),this.list.array=S}initBestInfo(s=-1){if(-1!=s){this.boxGold.visible=!1,this.icon.visible=!0;let o=N.getInstance().getBallById(s);this.icon.skin=o.icon}else{let s=N.getInstance().getTreasures(),o=s[s.length-1];this.boxGold.visible=!0,this.icon.visible=!1;let d=o.reward.split("_");this.lblGold.text=d[1]}}onRenderHandler(s){this.videoIndex.inArray(s.dataSource.id)&&s.setVideo(),s.setInfo(s.dataSource)}onMouseHandler(s,o){if(s.type!=Laya.Event.CLICK)return;let d=this.list.cells[o].dataSource;if(d.status)return;let h=this,clickFun=(o=0)=>{let p=s.target;if(h._isFirstTreasure&&!this._getSkin){let s=0;for(let o=0;o<h.list.cells.length;o++){h.list.cells[o].dataSource.status&&s++}if(1!=+N.getInstance().getTreasureById(d.id).reward.split("_")[0]&&2==s)for(let s=0;s<h.list.cells.length;s++){let o=h.list.cells[s],d=o.dataSource;if(1!=+N.getInstance().getTreasureById(d.id).reward.split("_")[0]);else{let s=p.dataSource;p.dataSource=d,p.setInfo(d),o instanceof Ae&&(o.dataSource=s,o.setInfo(s)),console.log("将当前打开的格子跟皮肤格子数据换一下")}}}switch(o){case 0:if(h._keysNum<1){if(this._rewardKeyTimes>0)return;return void Laya.Scene.open("model/PopupWindow.scene",!1,{callBack:()=>{this._rewardKeyTimes++,p instanceof Ae&&h.onGetItem(p,o),h._keysNum=2,h.updateTreasureTimes()},times:3})}h.onGetItem(p,o),h._keysNum--,h.updateTreasureTimes();break;case 1:p instanceof Ae&&h.onGetItem(p,o)}};if(this.videoIndex.inArray(d.id)){let succ=()=>{clickFun(1)};se.showRewardedAd(succ)}else clickFun(0)}onGetItem(s,o=0){s.playOpenBoxAction(),s.dataSource.status=!0;let d=N.getInstance().getTreasureById(s.dataSource.id).reward.split("_"),h=Number(d[0]),p=Number(d[1])||0;switch(h){case 0:1==o?(z.updateMoney(2*p),x.showTips(Lq.lang("双倍奖励"))):z.updateMoney(p);break;default:this._getSkin=!0;let d=JSON.parse(Laya.LocalStorage.getItem("hasOwnBalls"));d.inArray(s.dataSource.capId)||(d.push(s.dataSource.ballId),Laya.LocalStorage.setItem("hasOwnBalls",JSON.stringify(d))),o&&(z.updateMoney(100),x.showTips(Lq.lang("额外奖励")))}}checkHasGetSkin(){for(let s=0;s<this.list.cells.length;s++){let o=this.list.cells[s].dataSource;if(o.status){if(1==+N.getInstance().getTreasureById(o.id).reward.split("_")[0])return!0}}return!1}}class Ce extends Laya.Script{constructor(){super()}onAwake(){q.lang("广告",this.Text),this.initI18n()}initI18n(){let s=q.getAssetsI18nPrefix();s&&Object.getOwnPropertyNames(this).forEach(o=>{switch(!0){case this[o]instanceof Laya.Image:case this[o]instanceof Laya.Button:if(!this[o].skin)return;this[o].skin=s+this[o].skin}})}}class we extends s.model.UnlockUI{constructor(){super()}onEnable(){let s=N.getInstance().getNextRoad(R.gateId-1);s&&(this.icon.skin=s.icon),this.btnClose.on(Laya.Event.CLICK,this,this.close)}}class Ie extends Laya.Script{constructor(){super()}onAwake(){this.initI18n()}initI18n(){let s=q.getAssetsI18nPrefix();s&&Object.getOwnPropertyNames(this).forEach(o=>{switch(!0){case this[o]instanceof Laya.Image:case this[o]instanceof Laya.Button:if(!this[o].skin)return;this[o].skin=s+this[o].skin}})}}class _e{constructor(){}static init(){var s=Laya.ClassUtils.regClass;s("game/GameView.ts",j),s("game/GameInfoView.ts",W),s("unit/MoneyView.ts",X),s("game/GameResultView.ts",oe),s("i18n/game/i18n_GameResult.ts",re),s("component/ScaleButton.ts",le),s("model/HomeView.ts",de),s("i18n/model/i18n_Home.ts",ce),s("model/LoadingView.ts",ue),s("i18n/model/i18n_Loading.ts",he),s("model/MessageModalView.ts",ge),s("model/NativeAd.ts",me),s("model/PopupWindowView.ts",ve),s("i18n/model/i18n_PopupWindow.ts",fe),s("model/ShowView.ts",pe),s("model/SkinView.ts",Se),s("i18n/model/i18n_Skin.ts",Ee),s("unit/SkinItem.ts",ye),s("model/TreasureView.ts",be),s("i18n/model/i18n_Treasure.ts",Ce),s("unit/TreasureItem.ts",Ae),s("model/UnlockView.ts",we),s("i18n/model/i18n_Unlock.ts",Ie)}}_e.width=576,_e.height=1024,_e.scaleMode="fixedwidth",_e.screenMode="vertical",_e.alignV="middle",_e.alignH="center",_e.startScene="game/Game.scene",_e.sceneRoot="",_e.debug=!1,_e.stat=!1,_e.physicsDebug=!1,_e.exportSceneToJson=!0,_e.init();new class{constructor(){q.init(),Config.isAntialias=!0,Config.useRetinalCanvas=!0,UIConfig.closeDialogOnSide=!1,window.Laya3D?Laya3D.init(_e.width,_e.height):Laya.init(_e.width,_e.height,Laya.WebGL),Laya.Physics&&Laya.Physics.enable(),Laya.DebugPanel&&Laya.DebugPanel.enable(),Laya.stage.scaleMode=_e.scaleMode,Laya.stage.screenMode=_e.screenMode,Laya.stage.alignV=_e.alignV,Laya.stage.alignH=_e.alignH,Laya.URL.exportSceneToJson=_e.exportSceneToJson,(_e.debug||"true"==Laya.Utils.getQueryString("debug"))&&Laya.enableDebugPanel(),_e.physicsDebug&&Laya.PhysicsDebugDraw&&Laya.PhysicsDebugDraw.enable(),_e.stat&&Laya.Stat.show(),Laya.alertGlobalError(!0),q.onLaunch(),this.showLoadingUI()}showLoadingUI(){let s=[{url:"loading/bg_loading.png",type:Laya.Loader.IMAGE},{url:"res/atlas/loading.json",type:Laya.Loader.ATLAS}];q.getAssetsI18nPrefix()&&(s.push({url:"res/atlas/i18n/"+q.langType+"/loading.json",type:Laya.Loader.ATLAS}),s.push({url:"res/atlas/i18n/"+q.langType+"/ui.json",type:Laya.Loader.ATLAS})),q.time.startLoading=(new Date).getTime(),Laya.loader.load(s,Laya.Handler.create(this,()=>{Laya.Scene.open("model/Loading.scene")}))}}}();